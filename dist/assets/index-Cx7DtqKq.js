const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboardApi-DxH4pNKS.js","assets/ui-Bopd8g-C.js","assets/vendor-CRDlltRq.js","assets/utils--BulIq_u.js","assets/router-DF9ahorg.js"])))=>i.map(i=>d[i]);
var am=Object.defineProperty;var Mi=a=>{throw TypeError(a)};var rm=(a,t,s)=>t in a?am(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var bs=(a,t,s)=>rm(a,typeof t!="symbol"?t+"":t,s),so=(a,t,s)=>t.has(a)||Mi("Cannot "+s);var J=(a,t,s)=>(so(a,t,"read from private field"),s?s.call(a):t.get(a)),Qe=(a,t,s)=>t.has(a)?Mi("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,s),Fe=(a,t,s,r)=>(so(a,t,"write to private field"),r?r.call(a,s):t.set(a,s),s),Dt=(a,t,s)=>(so(a,t,"access private method"),s);var tn=(a,t,s,r)=>({set _(n){Fe(a,t,n,s)},get _(){return J(a,t,r)}});import{j as e,V as Zl,R as Kl,A as Ql,C as Jl,T as Xl,D as ec,P as nm,c as Rs,a as ur,u as rt,b as Pn,d as De,e as Oe,f as Ts,g as qo,h as Wo,i as om,k as Yo,l as tc,m as as,n as Ia,o as Go,S as im,p as $s,q as ns,r as sc,s as ac,t as lm,v as rc,I as nc,w as oc,x as ic,y as lc,L as cc,z as dc,B as cm,E as dm,F as uc,G as um,H as hc,J as mc,K as pc,M as fc,N as hm,O as An,Q as xc,U as gc,W as En,X as Rn,Y as Zo,Z as Ko,_ as Qo,$ as Jo,a0 as Xo,a1 as Tn,a2 as vc,a3 as yc,a4 as bc,a5 as mm,a6 as pm,a7 as _r}from"./ui-Bopd8g-C.js";import{b as ei,r as l,a as le,v as fm,g as xm}from"./vendor-CRDlltRq.js";import{t as gm,c as vm,a as zr}from"./utils--BulIq_u.js";import{u as Dn,a as Kt,N as wc,O as ym,L as ss,b as bm,B as wm,R as jm,c as nt}from"./router-DF9ahorg.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=s(n);fetch(n.href,o)}})();var jc,Fi=ei;jc=Fi.createRoot,Fi.hydrateRoot;const Nm=1,_m=1e6;let ao=0;function Sm(){return ao=(ao+1)%Number.MAX_SAFE_INTEGER,ao.toString()}const ro=new Map,$i=a=>{if(ro.has(a))return;const t=setTimeout(()=>{ro.delete(a),yr({type:"REMOVE_TOAST",toastId:a})},_m);ro.set(a,t)},km=(a,t)=>{switch(t.type){case"ADD_TOAST":return{...a,toasts:[t.toast,...a.toasts].slice(0,Nm)};case"UPDATE_TOAST":return{...a,toasts:a.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?$i(s):a.toasts.forEach(r=>{$i(r.id)}),{...a,toasts:a.toasts.map(r=>r.id===s||s===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...a,toasts:[]}:{...a,toasts:a.toasts.filter(s=>s.id!==t.toastId)}}},on=[];let ln={toasts:[]};function yr(a){ln=km(ln,a),on.forEach(t=>{t(ln)})}function Cm({...a}){const t=Sm(),s=n=>yr({type:"UPDATE_TOAST",toast:{...n,id:t}}),r=()=>yr({type:"DISMISS_TOAST",toastId:t});return yr({type:"ADD_TOAST",toast:{...a,id:t,open:!0,onOpenChange:n=>{n||r()}}}),{id:t,dismiss:r,update:s}}function Tt(){const[a,t]=l.useState(ln);return l.useEffect(()=>(on.push(t),()=>{const s=on.indexOf(t);s>-1&&on.splice(s,1)}),[a]),{...a,toast:Cm,dismiss:s=>yr({type:"DISMISS_TOAST",toastId:s})}}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Nc=(...a)=>a.filter((t,s,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Am={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Em=l.forwardRef(({color:a="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:n="",children:o,iconNode:i,...c},d)=>l.createElement("svg",{ref:d,...Am,width:t,height:t,stroke:a,strokeWidth:r?Number(s)*24/Number(t):s,className:Nc("lucide",n),...c},[...i.map(([u,h])=>l.createElement(u,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=(a,t)=>{const s=l.forwardRef(({className:r,...n},o)=>l.createElement(Em,{ref:o,iconNode:t,className:Nc(`lucide-${Pm(a)}`,r),...n}));return s.displayName=`${a}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=ke("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=ke("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=ke("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=ke("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=ke("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=ke("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rm=ke("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=ke("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=ke("CalendarPlus",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 13V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"3spt84"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M19 16v6",key:"tddt3s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=ke("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=ke("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=ke("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=ke("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=ke("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=ke("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ti=ke("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=ke("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=ke("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=ke("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=ke("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=ke("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=ke("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=ke("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=ke("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=ke("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vi=ke("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ui=ke("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const si=ke("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=ke("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=ke("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=ke("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=ke("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=ke("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=ke("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lm=ke("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kc=ke("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=ke("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=ke("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=ke("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=ke("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=ke("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=ke("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=ke("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=ke("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=ke("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=ke("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=ke("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const no=ke("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=ke("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=ke("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=ke("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=ke("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=ke("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=ke("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=ke("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=ke("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function ce(...a){return gm(vm(a))}const Um=nm,Cc=l.forwardRef(({className:a,...t},s)=>e.jsx(Zl,{ref:s,className:ce("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...t}));Cc.displayName=Zl.displayName;const zm=zr("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Pc=l.forwardRef(({className:a,variant:t,...s},r)=>e.jsx(Kl,{ref:r,className:ce(zm({variant:t}),a),...s}));Pc.displayName=Kl.displayName;const Bm=l.forwardRef(({className:a,...t},s)=>e.jsx(Ql,{ref:s,className:ce("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",a),...t}));Bm.displayName=Ql.displayName;const Ac=l.forwardRef(({className:a,...t},s)=>e.jsx(Jl,{ref:s,className:ce("absolute right-2 top-2 rounded-md p-1 text-foreground/70 opacity-100 transition-opacity group-[.destructive]:text-red-300 hover:text-foreground hover:bg-background/10 group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...t,children:e.jsx(Ds,{className:"h-4 w-4"})}));Ac.displayName=Jl.displayName;const Ec=l.forwardRef(({className:a,...t},s)=>e.jsx(Xl,{ref:s,className:ce("text-sm font-semibold",a),...t}));Ec.displayName=Xl.displayName;const Rc=l.forwardRef(({className:a,...t},s)=>e.jsx(ec,{ref:s,className:ce("text-sm opacity-90",a),...t}));Rc.displayName=ec.displayName;function Tc(){const{toasts:a}=Tt();return e.jsxs(Um,{children:[a.map(function({id:t,title:s,description:r,action:n,...o}){return e.jsxs(Pc,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(Ec,{children:s}),r&&e.jsx(Rc,{children:r})]}),n,e.jsx(Ac,{})]},t)}),e.jsx(Cc,{})]})}var Bi=["light","dark"],Hm="(prefers-color-scheme: dark)",qm=l.createContext(void 0),Wm={setTheme:a=>{},themes:[]},Ym=()=>{var a;return(a=l.useContext(qm))!=null?a:Wm};l.memo(({forcedTheme:a,storageKey:t,attribute:s,enableSystem:r,enableColorScheme:n,defaultTheme:o,value:i,attrs:c,nonce:d})=>{let u=o==="system",h=s==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${s}',s='setAttribute';`,m=n?Bi.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(v,y=!1,w=!0)=>{let N=i?i[v]:v,g=y?v+"|| ''":`'${N}'`,b="";return n&&w&&!y&&Bi.includes(v)&&(b+=`d.style.colorScheme = '${v}';`),s==="class"?y||N?b+=`c.add(${g})`:b+="null":N&&(b+=`d[s](n,${g})`),b},f=a?`!function(){${h}${p(a)}}()`:r?`!function(){try{${h}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${Hm}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}${u?"":"else{"+p(o,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${h}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}else{${p(o,!1,!1)};}${m}}catch(t){}}();`;return l.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:f}})});var Gm=a=>{switch(a){case"success":return Qm;case"info":return Xm;case"warning":return Jm;case"error":return ep;default:return null}},Zm=Array(12).fill(0),Km=({visible:a,className:t})=>le.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":a},le.createElement("div",{className:"sonner-spinner"},Zm.map((s,r)=>le.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),Qm=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Jm=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Xm=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ep=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},le.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),tp=le.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},le.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),le.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),sp=()=>{let[a,t]=le.useState(document.hidden);return le.useEffect(()=>{let s=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",s),()=>window.removeEventListener("visibilitychange",s)},[]),a},jo=1,ap=class{constructor(){this.subscribe=a=>(this.subscribers.push(a),()=>{let t=this.subscribers.indexOf(a);this.subscribers.splice(t,1)}),this.publish=a=>{this.subscribers.forEach(t=>t(a))},this.addToast=a=>{this.publish(a),this.toasts=[...this.toasts,a]},this.create=a=>{var t;let{message:s,...r}=a,n=typeof a?.id=="number"||((t=a.id)==null?void 0:t.length)>0?a.id:jo++,o=this.toasts.find(c=>c.id===n),i=a.dismissible===void 0?!0:a.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),o?this.toasts=this.toasts.map(c=>c.id===n?(this.publish({...c,...a,id:n,title:s}),{...c,...a,id:n,dismissible:i,title:s}):c):this.addToast({title:s,...r,dismissible:i,id:n}),n},this.dismiss=a=>(this.dismissedToasts.add(a),a||this.toasts.forEach(t=>{this.subscribers.forEach(s=>s({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:a,dismiss:!0})),a),this.message=(a,t)=>this.create({...t,message:a}),this.error=(a,t)=>this.create({...t,message:a,type:"error"}),this.success=(a,t)=>this.create({...t,type:"success",message:a}),this.info=(a,t)=>this.create({...t,type:"info",message:a}),this.warning=(a,t)=>this.create({...t,type:"warning",message:a}),this.loading=(a,t)=>this.create({...t,type:"loading",message:a}),this.promise=(a,t)=>{if(!t)return;let s;t.loading!==void 0&&(s=this.create({...t,promise:a,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=a instanceof Promise?a:a(),n=s!==void 0,o,i=r.then(async d=>{if(o=["resolve",d],le.isValidElement(d))n=!1,this.create({id:s,type:"default",message:d});else if(np(d)&&!d.ok){n=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${d.status}`):t.error,h=typeof t.description=="function"?await t.description(`HTTP error! status: ${d.status}`):t.description;this.create({id:s,type:"error",message:u,description:h})}else if(t.success!==void 0){n=!1;let u=typeof t.success=="function"?await t.success(d):t.success,h=typeof t.description=="function"?await t.description(d):t.description;this.create({id:s,type:"success",message:u,description:h})}}).catch(async d=>{if(o=["reject",d],t.error!==void 0){n=!1;let u=typeof t.error=="function"?await t.error(d):t.error,h=typeof t.description=="function"?await t.description(d):t.description;this.create({id:s,type:"error",message:u,description:h})}}).finally(()=>{var d;n&&(this.dismiss(s),s=void 0),(d=t.finally)==null||d.call(t)}),c=()=>new Promise((d,u)=>i.then(()=>o[0]==="reject"?u(o[1]):d(o[1])).catch(u));return typeof s!="string"&&typeof s!="number"?{unwrap:c}:Object.assign(s,{unwrap:c})},this.custom=(a,t)=>{let s=t?.id||jo++;return this.create({jsx:a(s),id:s,...t}),s},this.getActiveToasts=()=>this.toasts.filter(a=>!this.dismissedToasts.has(a.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},qt=new ap,rp=(a,t)=>{let s=t?.id||jo++;return qt.addToast({title:a,...t,id:s}),s},np=a=>a&&typeof a=="object"&&"ok"in a&&typeof a.ok=="boolean"&&"status"in a&&typeof a.status=="number",op=rp,ip=()=>qt.toasts,lp=()=>qt.getActiveToasts();Object.assign(op,{success:qt.success,info:qt.info,warning:qt.warning,error:qt.error,custom:qt.custom,message:qt.message,promise:qt.promise,dismiss:qt.dismiss,loading:qt.loading},{getHistory:ip,getToasts:lp});function cp(a,{insertAt:t}={}){if(typeof document>"u")return;let s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&s.firstChild?s.insertBefore(r,s.firstChild):s.appendChild(r),r.styleSheet?r.styleSheet.cssText=a:r.appendChild(document.createTextNode(a))}cp(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function an(a){return a.label!==void 0}var dp=3,up="32px",hp="16px",Hi=4e3,mp=356,pp=14,fp=20,xp=200;function cs(...a){return a.filter(Boolean).join(" ")}function gp(a){let[t,s]=a.split("-"),r=[];return t&&r.push(t),s&&r.push(s),r}var vp=a=>{var t,s,r,n,o,i,c,d,u,h,m;let{invert:p,toast:f,unstyled:v,interacting:y,setHeights:w,visibleToasts:N,heights:g,index:b,toasts:A,expanded:P,removeToast:E,defaultRichColors:V,closeButton:M,style:O,cancelButtonStyle:I,actionButtonStyle:ee,className:G="",descriptionClassName:ae="",duration:$,position:Y,gap:Z,loadingIcon:_,expandByDefault:L,classNames:C,icons:T,closeButtonAriaLabel:H="Close toast",pauseWhenPageIsHidden:x}=a,[S,q]=le.useState(null),[U,de]=le.useState(null),[Q,z]=le.useState(!1),[D,X]=le.useState(!1),[B,oe]=le.useState(!1),[Ae,Ce]=le.useState(!1),[Ie,K]=le.useState(!1),[Ne,Ve]=le.useState(0),[Ge,j]=le.useState(0),R=le.useRef(f.duration||$||Hi),W=le.useRef(null),me=le.useRef(null),se=b===0,re=b+1<=N,ve=f.type,Te=f.dismissible!==!1,Ze=f.className||"",ct=f.descriptionClassName||"",ne=le.useMemo(()=>g.findIndex(ie=>ie.toastId===f.id)||0,[g,f.id]),fe=le.useMemo(()=>{var ie;return(ie=f.closeButton)!=null?ie:M},[f.closeButton,M]),xe=le.useMemo(()=>f.duration||$||Hi,[f.duration,$]),Re=le.useRef(0),qe=le.useRef(0),Ue=le.useRef(0),xt=le.useRef(null),[Qt,ys]=Y.split("-"),Va=le.useMemo(()=>g.reduce((ie,ue,We)=>We>=ne?ie:ie+ue.height,0),[g,ne]),Ua=sp(),za=f.invert||p,Os=ve==="loading";qe.current=le.useMemo(()=>ne*Z+Va,[ne,Va]),le.useEffect(()=>{R.current=xe},[xe]),le.useEffect(()=>{z(!0)},[]),le.useEffect(()=>{let ie=me.current;if(ie){let ue=ie.getBoundingClientRect().height;return j(ue),w(We=>[{toastId:f.id,height:ue,position:f.position},...We]),()=>w(We=>We.filter(it=>it.toastId!==f.id))}},[w,f.id]),le.useLayoutEffect(()=>{if(!Q)return;let ie=me.current,ue=ie.style.height;ie.style.height="auto";let We=ie.getBoundingClientRect().height;ie.style.height=ue,j(We),w(it=>it.find(dt=>dt.toastId===f.id)?it.map(dt=>dt.toastId===f.id?{...dt,height:We}:dt):[{toastId:f.id,height:We,position:f.position},...it])},[Q,f.title,f.description,w,f.id]);let k=le.useCallback(()=>{X(!0),Ve(qe.current),w(ie=>ie.filter(ue=>ue.toastId!==f.id)),setTimeout(()=>{E(f)},xp)},[f,E,w,qe]);le.useEffect(()=>{if(f.promise&&ve==="loading"||f.duration===1/0||f.type==="loading")return;let ie;return P||y||x&&Ua?(()=>{if(Ue.current<Re.current){let ue=new Date().getTime()-Re.current;R.current=R.current-ue}Ue.current=new Date().getTime()})():R.current!==1/0&&(Re.current=new Date().getTime(),ie=setTimeout(()=>{var ue;(ue=f.onAutoClose)==null||ue.call(f,f),k()},R.current)),()=>clearTimeout(ie)},[P,y,f,ve,x,Ua,k]),le.useEffect(()=>{f.delete&&k()},[k,f.delete]);function be(){var ie,ue,We;return T!=null&&T.loading?le.createElement("div",{className:cs(C?.loader,(ie=f?.classNames)==null?void 0:ie.loader,"sonner-loader"),"data-visible":ve==="loading"},T.loading):_?le.createElement("div",{className:cs(C?.loader,(ue=f?.classNames)==null?void 0:ue.loader,"sonner-loader"),"data-visible":ve==="loading"},_):le.createElement(Km,{className:cs(C?.loader,(We=f?.classNames)==null?void 0:We.loader),visible:ve==="loading"})}return le.createElement("li",{tabIndex:0,ref:me,className:cs(G,Ze,C?.toast,(t=f?.classNames)==null?void 0:t.toast,C?.default,C?.[ve],(s=f?.classNames)==null?void 0:s[ve]),"data-sonner-toast":"","data-rich-colors":(r=f.richColors)!=null?r:V,"data-styled":!(f.jsx||f.unstyled||v),"data-mounted":Q,"data-promise":!!f.promise,"data-swiped":Ie,"data-removed":D,"data-visible":re,"data-y-position":Qt,"data-x-position":ys,"data-index":b,"data-front":se,"data-swiping":B,"data-dismissible":Te,"data-type":ve,"data-invert":za,"data-swipe-out":Ae,"data-swipe-direction":U,"data-expanded":!!(P||L&&Q),style:{"--index":b,"--toasts-before":b,"--z-index":A.length-b,"--offset":`${D?Ne:qe.current}px`,"--initial-height":L?"auto":`${Ge}px`,...O,...f.style},onDragEnd:()=>{oe(!1),q(null),xt.current=null},onPointerDown:ie=>{Os||!Te||(W.current=new Date,Ve(qe.current),ie.target.setPointerCapture(ie.pointerId),ie.target.tagName!=="BUTTON"&&(oe(!0),xt.current={x:ie.clientX,y:ie.clientY}))},onPointerUp:()=>{var ie,ue,We,it;if(Ae||!Te)return;xt.current=null;let dt=Number(((ie=me.current)==null?void 0:ie.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ft=Number(((ue=me.current)==null?void 0:ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Nt=new Date().getTime()-((We=W.current)==null?void 0:We.getTime()),_t=S==="x"?dt:Ft,Jt=Math.abs(_t)/Nt;if(Math.abs(_t)>=fp||Jt>.11){Ve(qe.current),(it=f.onDismiss)==null||it.call(f,f),de(S==="x"?dt>0?"right":"left":Ft>0?"down":"up"),k(),Ce(!0),K(!1);return}oe(!1),q(null)},onPointerMove:ie=>{var ue,We,it,dt;if(!xt.current||!Te||((ue=window.getSelection())==null?void 0:ue.toString().length)>0)return;let Ft=ie.clientY-xt.current.y,Nt=ie.clientX-xt.current.x,_t=(We=a.swipeDirections)!=null?We:gp(Y);!S&&(Math.abs(Nt)>1||Math.abs(Ft)>1)&&q(Math.abs(Nt)>Math.abs(Ft)?"x":"y");let Jt={x:0,y:0};S==="y"?(_t.includes("top")||_t.includes("bottom"))&&(_t.includes("top")&&Ft<0||_t.includes("bottom")&&Ft>0)&&(Jt.y=Ft):S==="x"&&(_t.includes("left")||_t.includes("right"))&&(_t.includes("left")&&Nt<0||_t.includes("right")&&Nt>0)&&(Jt.x=Nt),(Math.abs(Jt.x)>0||Math.abs(Jt.y)>0)&&K(!0),(it=me.current)==null||it.style.setProperty("--swipe-amount-x",`${Jt.x}px`),(dt=me.current)==null||dt.style.setProperty("--swipe-amount-y",`${Jt.y}px`)}},fe&&!f.jsx?le.createElement("button",{"aria-label":H,"data-disabled":Os,"data-close-button":!0,onClick:Os||!Te?()=>{}:()=>{var ie;k(),(ie=f.onDismiss)==null||ie.call(f,f)},className:cs(C?.closeButton,(n=f?.classNames)==null?void 0:n.closeButton)},(o=T?.close)!=null?o:tp):null,f.jsx||l.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:le.createElement(le.Fragment,null,ve||f.icon||f.promise?le.createElement("div",{"data-icon":"",className:cs(C?.icon,(i=f?.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||be():null,f.type!=="loading"?f.icon||T?.[ve]||Gm(ve):null):null,le.createElement("div",{"data-content":"",className:cs(C?.content,(c=f?.classNames)==null?void 0:c.content)},le.createElement("div",{"data-title":"",className:cs(C?.title,(d=f?.classNames)==null?void 0:d.title)},typeof f.title=="function"?f.title():f.title),f.description?le.createElement("div",{"data-description":"",className:cs(ae,ct,C?.description,(u=f?.classNames)==null?void 0:u.description)},typeof f.description=="function"?f.description():f.description):null),l.isValidElement(f.cancel)?f.cancel:f.cancel&&an(f.cancel)?le.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||I,onClick:ie=>{var ue,We;an(f.cancel)&&Te&&((We=(ue=f.cancel).onClick)==null||We.call(ue,ie),k())},className:cs(C?.cancelButton,(h=f?.classNames)==null?void 0:h.cancelButton)},f.cancel.label):null,l.isValidElement(f.action)?f.action:f.action&&an(f.action)?le.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||ee,onClick:ie=>{var ue,We;an(f.action)&&((We=(ue=f.action).onClick)==null||We.call(ue,ie),!ie.defaultPrevented&&k())},className:cs(C?.actionButton,(m=f?.classNames)==null?void 0:m.actionButton)},f.action.label):null))};function qi(){if(typeof window>"u"||typeof document>"u")return"ltr";let a=document.documentElement.getAttribute("dir");return a==="auto"||!a?window.getComputedStyle(document.documentElement).direction:a}function yp(a,t){let s={};return[a,t].forEach((r,n)=>{let o=n===1,i=o?"--mobile-offset":"--offset",c=o?hp:up;function d(u){["top","right","bottom","left"].forEach(h=>{s[`${i}-${h}`]=typeof u=="number"?`${u}px`:u})}typeof r=="number"||typeof r=="string"?d(r):typeof r=="object"?["top","right","bottom","left"].forEach(u=>{r[u]===void 0?s[`${i}-${u}`]=c:s[`${i}-${u}`]=typeof r[u]=="number"?`${r[u]}px`:r[u]}):d(c)}),s}var bp=l.forwardRef(function(a,t){let{invert:s,position:r="bottom-right",hotkey:n=["altKey","KeyT"],expand:o,closeButton:i,className:c,offset:d,mobileOffset:u,theme:h="light",richColors:m,duration:p,style:f,visibleToasts:v=dp,toastOptions:y,dir:w=qi(),gap:N=pp,loadingIcon:g,icons:b,containerAriaLabel:A="Notifications",pauseWhenPageIsHidden:P}=a,[E,V]=le.useState([]),M=le.useMemo(()=>Array.from(new Set([r].concat(E.filter(x=>x.position).map(x=>x.position)))),[E,r]),[O,I]=le.useState([]),[ee,G]=le.useState(!1),[ae,$]=le.useState(!1),[Y,Z]=le.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),_=le.useRef(null),L=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),C=le.useRef(null),T=le.useRef(!1),H=le.useCallback(x=>{V(S=>{var q;return(q=S.find(U=>U.id===x.id))!=null&&q.delete||qt.dismiss(x.id),S.filter(({id:U})=>U!==x.id)})},[]);return le.useEffect(()=>qt.subscribe(x=>{if(x.dismiss){V(S=>S.map(q=>q.id===x.id?{...q,delete:!0}:q));return}setTimeout(()=>{fm.flushSync(()=>{V(S=>{let q=S.findIndex(U=>U.id===x.id);return q!==-1?[...S.slice(0,q),{...S[q],...x},...S.slice(q+1)]:[x,...S]})})})}),[]),le.useEffect(()=>{if(h!=="system"){Z(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window>"u")return;let x=window.matchMedia("(prefers-color-scheme: dark)");try{x.addEventListener("change",({matches:S})=>{Z(S?"dark":"light")})}catch{x.addListener(({matches:q})=>{try{Z(q?"dark":"light")}catch(U){console.error(U)}})}},[h]),le.useEffect(()=>{E.length<=1&&G(!1)},[E]),le.useEffect(()=>{let x=S=>{var q,U;n.every(de=>S[de]||S.code===de)&&(G(!0),(q=_.current)==null||q.focus()),S.code==="Escape"&&(document.activeElement===_.current||(U=_.current)!=null&&U.contains(document.activeElement))&&G(!1)};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),le.useEffect(()=>{if(_.current)return()=>{C.current&&(C.current.focus({preventScroll:!0}),C.current=null,T.current=!1)}},[_.current]),le.createElement("section",{ref:t,"aria-label":`${A} ${L}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},M.map((x,S)=>{var q;let[U,de]=x.split("-");return E.length?le.createElement("ol",{key:x,dir:w==="auto"?qi():w,tabIndex:-1,ref:_,className:c,"data-sonner-toaster":!0,"data-theme":Y,"data-y-position":U,"data-lifted":ee&&E.length>1&&!o,"data-x-position":de,style:{"--front-toast-height":`${((q=O[0])==null?void 0:q.height)||0}px`,"--width":`${mp}px`,"--gap":`${N}px`,...f,...yp(d,u)},onBlur:Q=>{T.current&&!Q.currentTarget.contains(Q.relatedTarget)&&(T.current=!1,C.current&&(C.current.focus({preventScroll:!0}),C.current=null))},onFocus:Q=>{Q.target instanceof HTMLElement&&Q.target.dataset.dismissible==="false"||T.current||(T.current=!0,C.current=Q.relatedTarget)},onMouseEnter:()=>G(!0),onMouseMove:()=>G(!0),onMouseLeave:()=>{ae||G(!1)},onDragEnd:()=>G(!1),onPointerDown:Q=>{Q.target instanceof HTMLElement&&Q.target.dataset.dismissible==="false"||$(!0)},onPointerUp:()=>$(!1)},E.filter(Q=>!Q.position&&S===0||Q.position===x).map((Q,z)=>{var D,X;return le.createElement(vp,{key:Q.id,icons:b,index:z,toast:Q,defaultRichColors:m,duration:(D=y?.duration)!=null?D:p,className:y?.className,descriptionClassName:y?.descriptionClassName,invert:s,visibleToasts:v,closeButton:(X=y?.closeButton)!=null?X:i,interacting:ae,position:x,style:y?.style,unstyled:y?.unstyled,classNames:y?.classNames,cancelButtonStyle:y?.cancelButtonStyle,actionButtonStyle:y?.actionButtonStyle,removeToast:H,toasts:E.filter(B=>B.position==Q.position),heights:O.filter(B=>B.position==Q.position),setHeights:I,expandByDefault:o,gap:N,loadingIcon:g,expanded:ee,pauseWhenPageIsHidden:P,swipeDirections:a.swipeDirections})})):null}))});const wp=({...a})=>{const{theme:t="system"}=Ym();return e.jsx(bp,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...a})};var[Ln,wb]=Rs("Tooltip",[ur]),Mn=ur(),Dc="TooltipProvider",jp=700,No="tooltip.open",[Np,oi]=Ln(Dc),Ic=a=>{const{__scopeTooltip:t,delayDuration:s=jp,skipDelayDuration:r=300,disableHoverableContent:n=!1,children:o}=a,i=l.useRef(!0),c=l.useRef(!1),d=l.useRef(0);return l.useEffect(()=>{const u=d.current;return()=>window.clearTimeout(u)},[]),e.jsx(Np,{scope:t,isOpenDelayedRef:i,delayDuration:s,onOpen:l.useCallback(()=>{window.clearTimeout(d.current),i.current=!1},[]),onClose:l.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>i.current=!0,r)},[r]),isPointerInTransitRef:c,onPointerInTransitChange:l.useCallback(u=>{c.current=u},[]),disableHoverableContent:n,children:o})};Ic.displayName=Dc;var kr="Tooltip",[_p,Fn]=Ln(kr),Oc=a=>{const{__scopeTooltip:t,children:s,open:r,defaultOpen:n,onOpenChange:o,disableHoverableContent:i,delayDuration:c}=a,d=oi(kr,a.__scopeTooltip),u=Mn(t),[h,m]=l.useState(null),p=as(),f=l.useRef(0),v=i??d.disableHoverableContent,y=c??d.delayDuration,w=l.useRef(!1),[N,g]=Ia({prop:r,defaultProp:n??!1,onChange:V=>{V?(d.onOpen(),document.dispatchEvent(new CustomEvent(No))):d.onClose(),o?.(V)},caller:kr}),b=l.useMemo(()=>N?w.current?"delayed-open":"instant-open":"closed",[N]),A=l.useCallback(()=>{window.clearTimeout(f.current),f.current=0,w.current=!1,g(!0)},[g]),P=l.useCallback(()=>{window.clearTimeout(f.current),f.current=0,g(!1)},[g]),E=l.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{w.current=!0,g(!0),f.current=0},y)},[y,g]);return l.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),e.jsx(Go,{...u,children:e.jsx(_p,{scope:t,contentId:p,open:N,stateAttribute:b,trigger:h,onTriggerChange:m,onTriggerEnter:l.useCallback(()=>{d.isOpenDelayedRef.current?E():A()},[d.isOpenDelayedRef,E,A]),onTriggerLeave:l.useCallback(()=>{v?P():(window.clearTimeout(f.current),f.current=0)},[P,v]),onOpen:A,onClose:P,disableHoverableContent:v,children:s})})};Oc.displayName=kr;var _o="TooltipTrigger",Lc=l.forwardRef((a,t)=>{const{__scopeTooltip:s,...r}=a,n=Fn(_o,s),o=oi(_o,s),i=Mn(s),c=l.useRef(null),d=rt(t,c,n.onTriggerChange),u=l.useRef(!1),h=l.useRef(!1),m=l.useCallback(()=>u.current=!1,[]);return l.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),e.jsx(Pn,{asChild:!0,...i,children:e.jsx(De.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...r,ref:d,onPointerMove:Oe(a.onPointerMove,p=>{p.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(n.onTriggerEnter(),h.current=!0)}),onPointerLeave:Oe(a.onPointerLeave,()=>{n.onTriggerLeave(),h.current=!1}),onPointerDown:Oe(a.onPointerDown,()=>{n.open&&n.onClose(),u.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:Oe(a.onFocus,()=>{u.current||n.onOpen()}),onBlur:Oe(a.onBlur,n.onClose),onClick:Oe(a.onClick,n.onClose)})})});Lc.displayName=_o;var Sp="TooltipPortal",[jb,kp]=Ln(Sp,{forceMount:void 0}),sr="TooltipContent",Mc=l.forwardRef((a,t)=>{const s=kp(sr,a.__scopeTooltip),{forceMount:r=s.forceMount,side:n="top",...o}=a,i=Fn(sr,a.__scopeTooltip);return e.jsx(Ts,{present:r||i.open,children:i.disableHoverableContent?e.jsx(Fc,{side:n,...o,ref:t}):e.jsx(Cp,{side:n,...o,ref:t})})}),Cp=l.forwardRef((a,t)=>{const s=Fn(sr,a.__scopeTooltip),r=oi(sr,a.__scopeTooltip),n=l.useRef(null),o=rt(t,n),[i,c]=l.useState(null),{trigger:d,onClose:u}=s,h=n.current,{onPointerInTransitChange:m}=r,p=l.useCallback(()=>{c(null),m(!1)},[m]),f=l.useCallback((v,y)=>{const w=v.currentTarget,N={x:v.clientX,y:v.clientY},g=Tp(N,w.getBoundingClientRect()),b=Dp(N,g),A=Ip(y.getBoundingClientRect()),P=Lp([...b,...A]);c(P),m(!0)},[m]);return l.useEffect(()=>()=>p(),[p]),l.useEffect(()=>{if(d&&h){const v=w=>f(w,h),y=w=>f(w,d);return d.addEventListener("pointerleave",v),h.addEventListener("pointerleave",y),()=>{d.removeEventListener("pointerleave",v),h.removeEventListener("pointerleave",y)}}},[d,h,f,p]),l.useEffect(()=>{if(i){const v=y=>{const w=y.target,N={x:y.clientX,y:y.clientY},g=d?.contains(w)||h?.contains(w),b=!Op(N,i);g?p():b&&(p(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[d,h,i,u,p]),e.jsx(Fc,{...a,ref:o})}),[Pp,Ap]=Ln(kr,{isInside:!1}),Ep=tc("TooltipContent"),Fc=l.forwardRef((a,t)=>{const{__scopeTooltip:s,children:r,"aria-label":n,onEscapeKeyDown:o,onPointerDownOutside:i,...c}=a,d=Fn(sr,s),u=Mn(s),{onClose:h}=d;return l.useEffect(()=>(document.addEventListener(No,h),()=>document.removeEventListener(No,h)),[h]),l.useEffect(()=>{if(d.trigger){const m=p=>{p.target?.contains(d.trigger)&&h()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[d.trigger,h]),e.jsx(qo,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:m=>m.preventDefault(),onDismiss:h,children:e.jsxs(Wo,{"data-state":d.stateAttribute,...u,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(Ep,{children:r}),e.jsx(Pp,{scope:s,isInside:!0,children:e.jsx(om,{id:d.contentId,role:"tooltip",children:n||r})})]})})});Mc.displayName=sr;var $c="TooltipArrow",Rp=l.forwardRef((a,t)=>{const{__scopeTooltip:s,...r}=a,n=Mn(s);return Ap($c,s).isInside?null:e.jsx(Yo,{...n,...r,ref:t})});Rp.displayName=$c;function Tp(a,t){const s=Math.abs(t.top-a.y),r=Math.abs(t.bottom-a.y),n=Math.abs(t.right-a.x),o=Math.abs(t.left-a.x);switch(Math.min(s,r,n,o)){case o:return"left";case n:return"right";case s:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Dp(a,t,s=5){const r=[];switch(t){case"top":r.push({x:a.x-s,y:a.y+s},{x:a.x+s,y:a.y+s});break;case"bottom":r.push({x:a.x-s,y:a.y-s},{x:a.x+s,y:a.y-s});break;case"left":r.push({x:a.x+s,y:a.y-s},{x:a.x+s,y:a.y+s});break;case"right":r.push({x:a.x-s,y:a.y-s},{x:a.x-s,y:a.y+s});break}return r}function Ip(a){const{top:t,right:s,bottom:r,left:n}=a;return[{x:n,y:t},{x:s,y:t},{x:s,y:r},{x:n,y:r}]}function Op(a,t){const{x:s,y:r}=a;let n=!1;for(let o=0,i=t.length-1;o<t.length;i=o++){const c=t[o],d=t[i],u=c.x,h=c.y,m=d.x,p=d.y;h>r!=p>r&&s<(m-u)*(r-h)/(p-h)+u&&(n=!n)}return n}function Lp(a){const t=a.slice();return t.sort((s,r)=>s.x<r.x?-1:s.x>r.x?1:s.y<r.y?-1:s.y>r.y?1:0),Mp(t)}function Mp(a){if(a.length<=1)return a.slice();const t=[];for(let r=0;r<a.length;r++){const n=a[r];for(;t.length>=2;){const o=t[t.length-1],i=t[t.length-2];if((o.x-i.x)*(n.y-i.y)>=(o.y-i.y)*(n.x-i.x))t.pop();else break}t.push(n)}t.pop();const s=[];for(let r=a.length-1;r>=0;r--){const n=a[r];for(;s.length>=2;){const o=s[s.length-1],i=s[s.length-2];if((o.x-i.x)*(n.y-i.y)>=(o.y-i.y)*(n.x-i.x))s.pop();else break}s.push(n)}return s.pop(),t.length===1&&s.length===1&&t[0].x===s[0].x&&t[0].y===s[0].y?t:t.concat(s)}var Fp=Ic,$p=Oc,Vp=Lc,Vc=Mc;const Uc=Fp,Up=$p,zp=Vp,zc=l.forwardRef(({className:a,sideOffset:t=4,...s},r)=>e.jsx(Vc,{ref:r,sideOffset:t,className:ce("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s}));zc.displayName=Vc.displayName;var $n=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(a){return this.listeners.add(a),this.onSubscribe(),()=>{this.listeners.delete(a),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Vn=typeof window>"u"||"Deno"in globalThis;function us(){}function Bp(a,t){return typeof a=="function"?a(t):a}function Hp(a){return typeof a=="number"&&a>=0&&a!==1/0}function qp(a,t){return Math.max(a+(t||0)-Date.now(),0)}function So(a,t){return typeof a=="function"?a(t):a}function Wp(a,t){return typeof a=="function"?a(t):a}function Wi(a,t){const{type:s="all",exact:r,fetchStatus:n,predicate:o,queryKey:i,stale:c}=a;if(i){if(r){if(t.queryHash!==ii(i,t.options))return!1}else if(!Pr(t.queryKey,i))return!1}if(s!=="all"){const d=t.isActive();if(s==="active"&&!d||s==="inactive"&&d)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||n&&n!==t.state.fetchStatus||o&&!o(t))}function Yi(a,t){const{exact:s,status:r,predicate:n,mutationKey:o}=a;if(o){if(!t.options.mutationKey)return!1;if(s){if(Cr(t.options.mutationKey)!==Cr(o))return!1}else if(!Pr(t.options.mutationKey,o))return!1}return!(r&&t.state.status!==r||n&&!n(t))}function ii(a,t){return(t?.queryKeyHashFn||Cr)(a)}function Cr(a){return JSON.stringify(a,(t,s)=>ko(s)?Object.keys(s).sort().reduce((r,n)=>(r[n]=s[n],r),{}):s)}function Pr(a,t){return a===t?!0:typeof a!=typeof t?!1:a&&t&&typeof a=="object"&&typeof t=="object"?Object.keys(t).every(s=>Pr(a[s],t[s])):!1}function Bc(a,t){if(a===t)return a;const s=Gi(a)&&Gi(t);if(s||ko(a)&&ko(t)){const r=s?a:Object.keys(a),n=r.length,o=s?t:Object.keys(t),i=o.length,c=s?[]:{},d=new Set(r);let u=0;for(let h=0;h<i;h++){const m=s?h:o[h];(!s&&d.has(m)||s)&&a[m]===void 0&&t[m]===void 0?(c[m]=void 0,u++):(c[m]=Bc(a[m],t[m]),c[m]===a[m]&&a[m]!==void 0&&u++)}return n===i&&u===n?a:c}return t}function Gi(a){return Array.isArray(a)&&a.length===Object.keys(a).length}function ko(a){if(!Zi(a))return!1;const t=a.constructor;if(t===void 0)return!0;const s=t.prototype;return!(!Zi(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(a)!==Object.prototype)}function Zi(a){return Object.prototype.toString.call(a)==="[object Object]"}function Yp(a){return new Promise(t=>{setTimeout(t,a)})}function Gp(a,t,s){return typeof s.structuralSharing=="function"?s.structuralSharing(a,t):s.structuralSharing!==!1?Bc(a,t):t}function Zp(a,t,s=0){const r=[...a,t];return s&&r.length>s?r.slice(1):r}function Kp(a,t,s=0){const r=[t,...a];return s&&r.length>s?r.slice(0,-1):r}var li=Symbol();function Hc(a,t){return!a.queryFn&&t?.initialPromise?()=>t.initialPromise:!a.queryFn||a.queryFn===li?()=>Promise.reject(new Error(`Missing queryFn: '${a.queryHash}'`)):a.queryFn}var Sa,Ks,Ga,Ul,Qp=(Ul=class extends $n{constructor(){super();Qe(this,Sa);Qe(this,Ks);Qe(this,Ga);Fe(this,Ga,t=>{if(!Vn&&window.addEventListener){const s=()=>t();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){J(this,Ks)||this.setEventListener(J(this,Ga))}onUnsubscribe(){var t;this.hasListeners()||((t=J(this,Ks))==null||t.call(this),Fe(this,Ks,void 0))}setEventListener(t){var s;Fe(this,Ga,t),(s=J(this,Ks))==null||s.call(this),Fe(this,Ks,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){J(this,Sa)!==t&&(Fe(this,Sa,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(s=>{s(t)})}isFocused(){return typeof J(this,Sa)=="boolean"?J(this,Sa):globalThis.document?.visibilityState!=="hidden"}},Sa=new WeakMap,Ks=new WeakMap,Ga=new WeakMap,Ul),qc=new Qp,Za,Qs,Ka,zl,Jp=(zl=class extends $n{constructor(){super();Qe(this,Za,!0);Qe(this,Qs);Qe(this,Ka);Fe(this,Ka,t=>{if(!Vn&&window.addEventListener){const s=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",r)}}})}onSubscribe(){J(this,Qs)||this.setEventListener(J(this,Ka))}onUnsubscribe(){var t;this.hasListeners()||((t=J(this,Qs))==null||t.call(this),Fe(this,Qs,void 0))}setEventListener(t){var s;Fe(this,Ka,t),(s=J(this,Qs))==null||s.call(this),Fe(this,Qs,t(this.setOnline.bind(this)))}setOnline(t){J(this,Za)!==t&&(Fe(this,Za,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return J(this,Za)}},Za=new WeakMap,Qs=new WeakMap,Ka=new WeakMap,zl),hn=new Jp;function Xp(){let a,t;const s=new Promise((n,o)=>{a=n,t=o});s.status="pending",s.catch(()=>{});function r(n){Object.assign(s,n),delete s.resolve,delete s.reject}return s.resolve=n=>{r({status:"fulfilled",value:n}),a(n)},s.reject=n=>{r({status:"rejected",reason:n}),t(n)},s}function ef(a){return Math.min(1e3*2**a,3e4)}function Wc(a){return(a??"online")==="online"?hn.isOnline():!0}var Yc=class extends Error{constructor(a){super("CancelledError"),this.revert=a?.revert,this.silent=a?.silent}};function oo(a){return a instanceof Yc}function Gc(a){let t=!1,s=0,r=!1,n;const o=Xp(),i=y=>{r||(p(new Yc(y)),a.abort?.())},c=()=>{t=!0},d=()=>{t=!1},u=()=>qc.isFocused()&&(a.networkMode==="always"||hn.isOnline())&&a.canRun(),h=()=>Wc(a.networkMode)&&a.canRun(),m=y=>{r||(r=!0,a.onSuccess?.(y),n?.(),o.resolve(y))},p=y=>{r||(r=!0,a.onError?.(y),n?.(),o.reject(y))},f=()=>new Promise(y=>{n=w=>{(r||u())&&y(w)},a.onPause?.()}).then(()=>{n=void 0,r||a.onContinue?.()}),v=()=>{if(r)return;let y;const w=s===0?a.initialPromise:void 0;try{y=w??a.fn()}catch(N){y=Promise.reject(N)}Promise.resolve(y).then(m).catch(N=>{if(r)return;const g=a.retry??(Vn?0:3),b=a.retryDelay??ef,A=typeof b=="function"?b(s,N):b,P=g===!0||typeof g=="number"&&s<g||typeof g=="function"&&g(s,N);if(t||!P){p(N);return}s++,a.onFail?.(s,N),Yp(A).then(()=>u()?void 0:f()).then(()=>{t?p(N):v()})})};return{promise:o,cancel:i,continue:()=>(n?.(),o),cancelRetry:c,continueRetry:d,canStart:h,start:()=>(h()?v():f().then(v),o)}}var tf=a=>setTimeout(a,0);function sf(){let a=[],t=0,s=c=>{c()},r=c=>{c()},n=tf;const o=c=>{t?a.push(c):n(()=>{s(c)})},i=()=>{const c=a;a=[],c.length&&n(()=>{r(()=>{c.forEach(d=>{s(d)})})})};return{batch:c=>{let d;t++;try{d=c()}finally{t--,t||i()}return d},batchCalls:c=>(...d)=>{o(()=>{c(...d)})},schedule:o,setNotifyFunction:c=>{s=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{n=c}}}var Ut=sf(),ka,Bl,Zc=(Bl=class{constructor(){Qe(this,ka)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hp(this.gcTime)&&Fe(this,ka,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(a){this.gcTime=Math.max(this.gcTime||0,a??(Vn?1/0:5*60*1e3))}clearGcTimeout(){J(this,ka)&&(clearTimeout(J(this,ka)),Fe(this,ka,void 0))}},ka=new WeakMap,Bl),Qa,Ca,Xt,Pa,It,Vr,Aa,hs,Ms,Hl,af=(Hl=class extends Zc{constructor(t){super();Qe(this,hs);Qe(this,Qa);Qe(this,Ca);Qe(this,Xt);Qe(this,Pa);Qe(this,It);Qe(this,Vr);Qe(this,Aa);Fe(this,Aa,!1),Fe(this,Vr,t.defaultOptions),this.setOptions(t.options),this.observers=[],Fe(this,Pa,t.client),Fe(this,Xt,J(this,Pa).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Fe(this,Qa,nf(this.options)),this.state=t.state??J(this,Qa),this.scheduleGc()}get meta(){return this.options.meta}get promise(){return J(this,It)?.promise}setOptions(t){this.options={...J(this,Vr),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&J(this,Xt).remove(this)}setData(t,s){const r=Gp(this.state.data,t,this.options);return Dt(this,hs,Ms).call(this,{data:r,type:"success",dataUpdatedAt:s?.updatedAt,manual:s?.manual}),r}setState(t,s){Dt(this,hs,Ms).call(this,{type:"setState",state:t,setStateOptions:s})}cancel(t){const s=J(this,It)?.promise;return J(this,It)?.cancel(t),s?s.then(us).catch(us):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(J(this,Qa))}isActive(){return this.observers.some(t=>Wp(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===li||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>So(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!qp(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(s=>s.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),J(this,It)?.continue()}onOnline(){this.observers.find(s=>s.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),J(this,It)?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),J(this,Xt).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(s=>s!==t),this.observers.length||(J(this,It)&&(J(this,Aa)?J(this,It).cancel({revert:!0}):J(this,It).cancelRetry()),this.scheduleGc()),J(this,Xt).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Dt(this,hs,Ms).call(this,{type:"invalidate"})}fetch(t,s){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&s?.cancelRefetch)this.cancel({silent:!0});else if(J(this,It))return J(this,It).continueRetry(),J(this,It).promise}if(t&&this.setOptions(t),!this.options.queryFn){const u=this.observers.find(h=>h.options.queryFn);u&&this.setOptions(u.options)}const r=new AbortController,n=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(Fe(this,Aa,!0),r.signal)})},o=()=>{const u=Hc(this.options,s),m=(()=>{const p={client:J(this,Pa),queryKey:this.queryKey,meta:this.meta};return n(p),p})();return Fe(this,Aa,!1),this.options.persister?this.options.persister(u,m,this):u(m)},c=(()=>{const u={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:J(this,Pa),state:this.state,fetchFn:o};return n(u),u})();this.options.behavior?.onFetch(c,this),Fe(this,Ca,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&Dt(this,hs,Ms).call(this,{type:"fetch",meta:c.fetchOptions?.meta});const d=u=>{oo(u)&&u.silent||Dt(this,hs,Ms).call(this,{type:"error",error:u}),oo(u)||(J(this,Xt).config.onError?.(u,this),J(this,Xt).config.onSettled?.(this.state.data,u,this)),this.scheduleGc()};return Fe(this,It,Gc({initialPromise:s?.initialPromise,fn:c.fetchFn,abort:r.abort.bind(r),onSuccess:u=>{if(u===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(u)}catch(h){d(h);return}J(this,Xt).config.onSuccess?.(u,this),J(this,Xt).config.onSettled?.(u,this.state.error,this),this.scheduleGc()},onError:d,onFail:(u,h)=>{Dt(this,hs,Ms).call(this,{type:"failed",failureCount:u,error:h})},onPause:()=>{Dt(this,hs,Ms).call(this,{type:"pause"})},onContinue:()=>{Dt(this,hs,Ms).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),J(this,It).start()}},Qa=new WeakMap,Ca=new WeakMap,Xt=new WeakMap,Pa=new WeakMap,It=new WeakMap,Vr=new WeakMap,Aa=new WeakMap,hs=new WeakSet,Ms=function(t){const s=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...rf(r.data,this.options),fetchMeta:t.meta??null};case"success":return Fe(this,Ca,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=t.error;return oo(n)&&n.revert&&J(this,Ca)?{...J(this,Ca),fetchStatus:"idle"}:{...r,error:n,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=s(this.state),Ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),J(this,Xt).notify({query:this,type:"updated",action:t})})},Hl);function rf(a,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Wc(t.networkMode)?"fetching":"paused",...a===void 0&&{error:null,status:"pending"}}}function nf(a){const t=typeof a.initialData=="function"?a.initialData():a.initialData,s=t!==void 0,r=s?typeof a.initialDataUpdatedAt=="function"?a.initialDataUpdatedAt():a.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:s?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}var _s,ql,of=(ql=class extends $n{constructor(t={}){super();Qe(this,_s);this.config=t,Fe(this,_s,new Map)}build(t,s,r){const n=s.queryKey,o=s.queryHash??ii(n,s);let i=this.get(o);return i||(i=new af({client:t,queryKey:n,queryHash:o,options:t.defaultQueryOptions(s),state:r,defaultOptions:t.getQueryDefaults(n)}),this.add(i)),i}add(t){J(this,_s).has(t.queryHash)||(J(this,_s).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const s=J(this,_s).get(t.queryHash);s&&(t.destroy(),s===t&&J(this,_s).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return J(this,_s).get(t)}getAll(){return[...J(this,_s).values()]}find(t){const s={exact:!0,...t};return this.getAll().find(r=>Wi(s,r))}findAll(t={}){const s=this.getAll();return Object.keys(t).length>0?s.filter(r=>Wi(t,r)):s}notify(t){Ut.batch(()=>{this.listeners.forEach(s=>{s(t)})})}onFocus(){Ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_s=new WeakMap,ql),Ss,$t,Ea,ks,Ys,Wl,lf=(Wl=class extends Zc{constructor(t){super();Qe(this,ks);Qe(this,Ss);Qe(this,$t);Qe(this,Ea);this.mutationId=t.mutationId,Fe(this,$t,t.mutationCache),Fe(this,Ss,[]),this.state=t.state||cf(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){J(this,Ss).includes(t)||(J(this,Ss).push(t),this.clearGcTimeout(),J(this,$t).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Fe(this,Ss,J(this,Ss).filter(s=>s!==t)),this.scheduleGc(),J(this,$t).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){J(this,Ss).length||(this.state.status==="pending"?this.scheduleGc():J(this,$t).remove(this))}continue(){return J(this,Ea)?.continue()??this.execute(this.state.variables)}async execute(t){const s=()=>{Dt(this,ks,Ys).call(this,{type:"continue"})};Fe(this,Ea,Gc({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(o,i)=>{Dt(this,ks,Ys).call(this,{type:"failed",failureCount:o,error:i})},onPause:()=>{Dt(this,ks,Ys).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>J(this,$t).canRun(this)}));const r=this.state.status==="pending",n=!J(this,Ea).canStart();try{if(r)s();else{Dt(this,ks,Ys).call(this,{type:"pending",variables:t,isPaused:n}),await J(this,$t).config.onMutate?.(t,this);const i=await this.options.onMutate?.(t);i!==this.state.context&&Dt(this,ks,Ys).call(this,{type:"pending",context:i,variables:t,isPaused:n})}const o=await J(this,Ea).start();return await J(this,$t).config.onSuccess?.(o,t,this.state.context,this),await this.options.onSuccess?.(o,t,this.state.context),await J(this,$t).config.onSettled?.(o,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(o,null,t,this.state.context),Dt(this,ks,Ys).call(this,{type:"success",data:o}),o}catch(o){try{throw await J(this,$t).config.onError?.(o,t,this.state.context,this),await this.options.onError?.(o,t,this.state.context),await J(this,$t).config.onSettled?.(void 0,o,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,o,t,this.state.context),o}finally{Dt(this,ks,Ys).call(this,{type:"error",error:o})}}finally{J(this,$t).runNext(this)}}},Ss=new WeakMap,$t=new WeakMap,Ea=new WeakMap,ks=new WeakSet,Ys=function(t){const s=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=s(this.state),Ut.batch(()=>{J(this,Ss).forEach(r=>{r.onMutationUpdate(t)}),J(this,$t).notify({mutation:this,type:"updated",action:t})})},Wl);function cf(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Fs,ms,Ur,Yl,df=(Yl=class extends $n{constructor(t={}){super();Qe(this,Fs);Qe(this,ms);Qe(this,Ur);this.config=t,Fe(this,Fs,new Set),Fe(this,ms,new Map),Fe(this,Ur,0)}build(t,s,r){const n=new lf({mutationCache:this,mutationId:++tn(this,Ur)._,options:t.defaultMutationOptions(s),state:r});return this.add(n),n}add(t){J(this,Fs).add(t);const s=rn(t);if(typeof s=="string"){const r=J(this,ms).get(s);r?r.push(t):J(this,ms).set(s,[t])}this.notify({type:"added",mutation:t})}remove(t){if(J(this,Fs).delete(t)){const s=rn(t);if(typeof s=="string"){const r=J(this,ms).get(s);if(r)if(r.length>1){const n=r.indexOf(t);n!==-1&&r.splice(n,1)}else r[0]===t&&J(this,ms).delete(s)}}this.notify({type:"removed",mutation:t})}canRun(t){const s=rn(t);if(typeof s=="string"){const n=J(this,ms).get(s)?.find(o=>o.state.status==="pending");return!n||n===t}else return!0}runNext(t){const s=rn(t);return typeof s=="string"?J(this,ms).get(s)?.find(n=>n!==t&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ut.batch(()=>{J(this,Fs).forEach(t=>{this.notify({type:"removed",mutation:t})}),J(this,Fs).clear(),J(this,ms).clear()})}getAll(){return Array.from(J(this,Fs))}find(t){const s={exact:!0,...t};return this.getAll().find(r=>Yi(s,r))}findAll(t={}){return this.getAll().filter(s=>Yi(t,s))}notify(t){Ut.batch(()=>{this.listeners.forEach(s=>{s(t)})})}resumePausedMutations(){const t=this.getAll().filter(s=>s.state.isPaused);return Ut.batch(()=>Promise.all(t.map(s=>s.continue().catch(us))))}},Fs=new WeakMap,ms=new WeakMap,Ur=new WeakMap,Yl);function rn(a){return a.options.scope?.id}function Ki(a){return{onFetch:(t,s)=>{const r=t.options,n=t.fetchOptions?.meta?.fetchMore?.direction,o=t.state.data?.pages||[],i=t.state.data?.pageParams||[];let c={pages:[],pageParams:[]},d=0;const u=async()=>{let h=!1;const m=v=>{Object.defineProperty(v,"signal",{enumerable:!0,get:()=>(t.signal.aborted?h=!0:t.signal.addEventListener("abort",()=>{h=!0}),t.signal)})},p=Hc(t.options,t.fetchOptions),f=async(v,y,w)=>{if(h)return Promise.reject();if(y==null&&v.pages.length)return Promise.resolve(v);const g=(()=>{const E={client:t.client,queryKey:t.queryKey,pageParam:y,direction:w?"backward":"forward",meta:t.options.meta};return m(E),E})(),b=await p(g),{maxPages:A}=t.options,P=w?Kp:Zp;return{pages:P(v.pages,b,A),pageParams:P(v.pageParams,y,A)}};if(n&&o.length){const v=n==="backward",y=v?uf:Qi,w={pages:o,pageParams:i},N=y(r,w);c=await f(w,N,v)}else{const v=a??o.length;do{const y=d===0?i[0]??r.initialPageParam:Qi(r,c);if(d>0&&y==null)break;c=await f(c,y),d++}while(d<v)}return c};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},s):t.fetchFn=u}}}function Qi(a,{pages:t,pageParams:s}){const r=t.length-1;return t.length>0?a.getNextPageParam(t[r],t,s[r],s):void 0}function uf(a,{pages:t,pageParams:s}){return t.length>0?a.getPreviousPageParam?.(t[0],t,s[0],s):void 0}var ut,Js,Xs,Ja,Xa,ea,er,tr,Gl,hf=(Gl=class{constructor(a={}){Qe(this,ut);Qe(this,Js);Qe(this,Xs);Qe(this,Ja);Qe(this,Xa);Qe(this,ea);Qe(this,er);Qe(this,tr);Fe(this,ut,a.queryCache||new of),Fe(this,Js,a.mutationCache||new df),Fe(this,Xs,a.defaultOptions||{}),Fe(this,Ja,new Map),Fe(this,Xa,new Map),Fe(this,ea,0)}mount(){tn(this,ea)._++,J(this,ea)===1&&(Fe(this,er,qc.subscribe(async a=>{a&&(await this.resumePausedMutations(),J(this,ut).onFocus())})),Fe(this,tr,hn.subscribe(async a=>{a&&(await this.resumePausedMutations(),J(this,ut).onOnline())})))}unmount(){var a,t;tn(this,ea)._--,J(this,ea)===0&&((a=J(this,er))==null||a.call(this),Fe(this,er,void 0),(t=J(this,tr))==null||t.call(this),Fe(this,tr,void 0))}isFetching(a){return J(this,ut).findAll({...a,fetchStatus:"fetching"}).length}isMutating(a){return J(this,Js).findAll({...a,status:"pending"}).length}getQueryData(a){const t=this.defaultQueryOptions({queryKey:a});return J(this,ut).get(t.queryHash)?.state.data}ensureQueryData(a){const t=this.defaultQueryOptions(a),s=J(this,ut).build(this,t),r=s.state.data;return r===void 0?this.fetchQuery(a):(a.revalidateIfStale&&s.isStaleByTime(So(t.staleTime,s))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(a){return J(this,ut).findAll(a).map(({queryKey:t,state:s})=>{const r=s.data;return[t,r]})}setQueryData(a,t,s){const r=this.defaultQueryOptions({queryKey:a}),o=J(this,ut).get(r.queryHash)?.state.data,i=Bp(t,o);if(i!==void 0)return J(this,ut).build(this,r).setData(i,{...s,manual:!0})}setQueriesData(a,t,s){return Ut.batch(()=>J(this,ut).findAll(a).map(({queryKey:r})=>[r,this.setQueryData(r,t,s)]))}getQueryState(a){const t=this.defaultQueryOptions({queryKey:a});return J(this,ut).get(t.queryHash)?.state}removeQueries(a){const t=J(this,ut);Ut.batch(()=>{t.findAll(a).forEach(s=>{t.remove(s)})})}resetQueries(a,t){const s=J(this,ut);return Ut.batch(()=>(s.findAll(a).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...a},t)))}cancelQueries(a,t={}){const s={revert:!0,...t},r=Ut.batch(()=>J(this,ut).findAll(a).map(n=>n.cancel(s)));return Promise.all(r).then(us).catch(us)}invalidateQueries(a,t={}){return Ut.batch(()=>(J(this,ut).findAll(a).forEach(s=>{s.invalidate()}),a?.refetchType==="none"?Promise.resolve():this.refetchQueries({...a,type:a?.refetchType??a?.type??"active"},t)))}refetchQueries(a,t={}){const s={...t,cancelRefetch:t.cancelRefetch??!0},r=Ut.batch(()=>J(this,ut).findAll(a).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let o=n.fetch(void 0,s);return s.throwOnError||(o=o.catch(us)),n.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(r).then(us)}fetchQuery(a){const t=this.defaultQueryOptions(a);t.retry===void 0&&(t.retry=!1);const s=J(this,ut).build(this,t);return s.isStaleByTime(So(t.staleTime,s))?s.fetch(t):Promise.resolve(s.state.data)}prefetchQuery(a){return this.fetchQuery(a).then(us).catch(us)}fetchInfiniteQuery(a){return a.behavior=Ki(a.pages),this.fetchQuery(a)}prefetchInfiniteQuery(a){return this.fetchInfiniteQuery(a).then(us).catch(us)}ensureInfiniteQueryData(a){return a.behavior=Ki(a.pages),this.ensureQueryData(a)}resumePausedMutations(){return hn.isOnline()?J(this,Js).resumePausedMutations():Promise.resolve()}getQueryCache(){return J(this,ut)}getMutationCache(){return J(this,Js)}getDefaultOptions(){return J(this,Xs)}setDefaultOptions(a){Fe(this,Xs,a)}setQueryDefaults(a,t){J(this,Ja).set(Cr(a),{queryKey:a,defaultOptions:t})}getQueryDefaults(a){const t=[...J(this,Ja).values()],s={};return t.forEach(r=>{Pr(a,r.queryKey)&&Object.assign(s,r.defaultOptions)}),s}setMutationDefaults(a,t){J(this,Xa).set(Cr(a),{mutationKey:a,defaultOptions:t})}getMutationDefaults(a){const t=[...J(this,Xa).values()],s={};return t.forEach(r=>{Pr(a,r.mutationKey)&&Object.assign(s,r.defaultOptions)}),s}defaultQueryOptions(a){if(a._defaulted)return a;const t={...J(this,Xs).queries,...this.getQueryDefaults(a.queryKey),...a,_defaulted:!0};return t.queryHash||(t.queryHash=ii(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===li&&(t.enabled=!1),t}defaultMutationOptions(a){return a?._defaulted?a:{...J(this,Xs).mutations,...a?.mutationKey&&this.getMutationDefaults(a.mutationKey),...a,_defaulted:!0}}clear(){J(this,ut).clear(),J(this,Js).clear()}},ut=new WeakMap,Js=new WeakMap,Xs=new WeakMap,Ja=new WeakMap,Xa=new WeakMap,ea=new WeakMap,er=new WeakMap,tr=new WeakMap,Gl),mf=l.createContext(void 0),pf=({client:a,children:t})=>(l.useEffect(()=>(a.mount(),()=>{a.unmount()}),[a]),e.jsx(mf.Provider,{value:a,children:t}));const ff="modulepreload",xf=function(a){return"/"+a},Ji={},Ye=function(t,s,r){let n=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),c=i?.nonce||i?.getAttribute("nonce");n=Promise.allSettled(s.map(d=>{if(d=xf(d),d in Ji)return;Ji[d]=!0;const u=d.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":ff,u||(m.as="script"),m.crossOrigin="",m.href=d,c&&m.setAttribute("nonce",c),document.head.appendChild(m),u)return new Promise((p,f)=>{m.addEventListener("load",p),m.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return n.then(i=>{for(const c of i||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})},gf="https://parking-vercel22.vercel.app/";class vf{constructor(t=gf){bs(this,"baseURL");const s=t.trim().replace(/\/+$/,"");(s.includes("localhost")||s.includes("127.0.0.1"))&&!s.includes("/apitest")?this.baseURL=s.endsWith("/api")?s:`${s}/api`:this.baseURL=s}getAuthToken(){try{return localStorage.getItem("auth_token")}catch(t){return console.error("Error getting auth token:",t),null}}buildQueryString(t){const s=new URLSearchParams;Object.entries(t).forEach(([n,o])=>{o!=null&&o!==""&&s.append(n,String(o))});const r=s.toString();return r?`?${r}`:""}async request(t,s={}){const r=this.getAuthToken(),n={"Content-Type":"application/json",...s.headers};r&&(n.Authorization=`Bearer ${r}`);const o=`${this.baseURL}${t}`;try{const i=await fetch(o,{...s,headers:n}),c=await i.json();if(!i.ok)throw{success:!1,statusCode:i.status,message:c.message||"Request failed",error:c.error,timestamp:c.timestamp||new Date().toISOString(),path:c.path};return c.success!==void 0?c:{success:!0,statusCode:i.status,message:"Success",data:c,timestamp:new Date().toISOString()}}catch(i){throw i instanceof Error&&"statusCode"in i?i:{success:!1,statusCode:0,message:i instanceof Error?i.message:"Network error",timestamp:new Date().toISOString()}}}async get(t,s){const r=s?this.buildQueryString(s):"";return this.request(`${t}${r}`,{method:"GET"})}async post(t,s){return this.request(t,{method:"POST",body:s?JSON.stringify(s):void 0})}async put(t,s){return this.request(t,{method:"PUT",body:s?JSON.stringify(s):void 0})}async patch(t,s){return this.request(t,{method:"PATCH",body:s?JSON.stringify(s):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}}const pe=new vf,ci=Object.freeze(Object.defineProperty({__proto__:null,apiClient:pe},Symbol.toStringTag,{value:"Module"}));class lt{static setToken(t){localStorage.setItem(this.TOKEN_KEY,t)}static getToken(){return localStorage.getItem(this.TOKEN_KEY)}static removeToken(){try{localStorage.removeItem(this.TOKEN_KEY),localStorage.removeItem(this.USER_KEY),localStorage.removeItem(this.PROFILE_KEY),localStorage.removeItem(this.CONTRACTOR_KEY),localStorage.removeItem(this.ATTENDANT_KEY),console.log("All authentication data cleared from localStorage")}catch(t){console.error("Error clearing localStorage:",t);try{localStorage.clear()}catch(s){console.error("Error clearing all localStorage:",s)}}}static clearAllAuthData(){this.removeToken()}static setUser(t){localStorage.setItem(this.USER_KEY,JSON.stringify(t))}static getUser(){const t=localStorage.getItem(this.USER_KEY);return t?JSON.parse(t):null}static setProfile(t){localStorage.setItem(this.PROFILE_KEY,JSON.stringify(t))}static getProfile(){const t=localStorage.getItem(this.PROFILE_KEY);return t?JSON.parse(t):null}static setContractor(t){localStorage.setItem(this.CONTRACTOR_KEY,JSON.stringify(t))}static getContractor(){const t=localStorage.getItem(this.CONTRACTOR_KEY);return t?JSON.parse(t):null}static setAttendant(t){localStorage.setItem(this.ATTENDANT_KEY,JSON.stringify(t))}static getAttendant(){const t=localStorage.getItem(this.ATTENDANT_KEY);return t?JSON.parse(t):null}static async login(t,s){const n=await fetch("https://parking-vercel22.vercel.app//auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:s})}),o=await n.json();if(!n.ok)throw new Error(o.message||"Login failed");const i=o.data||o;if(!i.access_token||!i.user)throw new Error("Invalid login response format");return this.setToken(i.access_token),this.setUser(i.user),i}static async fetchProfile(){return(await pe.get("/auth/profile")).data}static async getProfileById(t){return(await pe.get(`/profiles/getOne/${t}`)).data}static isAuthenticated(){return this.getToken()!==null}}bs(lt,"TOKEN_KEY","auth_token"),bs(lt,"USER_KEY","auth_user"),bs(lt,"PROFILE_KEY","auth_profile"),bs(lt,"CONTRACTOR_KEY","auth_contractor"),bs(lt,"ATTENDANT_KEY","auth_attendant");const Bt=Object.freeze(Object.defineProperty({__proto__:null,AuthAPI:lt},Symbol.toStringTag,{value:"Module"})),Kc=l.createContext(void 0),ft=()=>{const a=l.useContext(Kc);if(a===void 0)throw new Error("useAuth must be used within an AuthProvider");return a},yf=({children:a})=>{const[t,s]=l.useState(null),[r,n]=l.useState(null),[o,i]=l.useState(null),[c,d]=l.useState(!0),{toast:u}=Tt(),h=async g=>{try{const b=await lt.getProfileById(g);if(b){if(lt.setProfile(b),b.role==="contractor"){const A=new Date,P=b,E=P.subscription_end_date?new Date(P.subscription_end_date):null,V=E&&E<A,M=P.subscription_status==="expired"||P.subscription_status==="suspended";if(V||M){const O=E?Math.ceil((E.getTime()-A.getTime())/864e5):0,I=V?"Your subscription has expired. Please recharge to continue using the service.":`Your subscription will expire in ${Math.max(0,O)} days. Please recharge to avoid service interruption.`;u({variant:"destructive",title:"Subscription Expired",description:I})}try{const{ContractorAPI:O}=await Ye(async()=>{const{ContractorAPI:ee}=await Promise.resolve().then(()=>Er);return{ContractorAPI:ee}},void 0),I=await O.getContractorByUserId(g);I&&lt.setContractor(I)}catch(O){console.error("Failed to fetch contractor data:",O)}}else if(b.role==="attendant")try{const{AttendantAPI:A}=await Ye(async()=>{const{AttendantAPI:E}=await Promise.resolve().then(()=>wr);return{AttendantAPI:E}},void 0),P=await A.getAttendantByUserId(g);P&&lt.setAttendant(P)}catch(A){console.error("Failed to fetch attendant data:",A)}return n(b),b.is_first_login&&console.log("First-time login detected, user will be redirected to onboarding"),{data:b,error:null}}return{data:null,error:{code:"PROFILE_NOT_FOUND",message:"Profile not found"}}}catch(b){throw console.error("Fetch profile error:",b),b}};l.useEffect(()=>{let g=!0;console.log("AuthProvider: Initializing authentication..."),(async()=>{try{const P=lt.getToken(),E=lt.getUser();if(P&&E){console.log("AuthProvider: Found existing session for user:",E.id),i({access_token:P}),s(E);const V=lt.getProfile();V&&(console.log("AuthProvider: Found stored profile"),n(V),V.role==="contractor"?lt.getContractor()&&console.log("AuthProvider: Found stored contractor data"):V.role==="attendant"&&lt.getAttendant()&&console.log("AuthProvider: Found stored attendant data"));try{await h(E.id)}catch(M){if(console.error("AuthProvider: Failed to fetch profile, using stored data",M),V)n(V);else{const O={id:E.id,user_name:E.user_name||E.email||"User",email:E.email||"",role:E.role,status:"active",is_first_login:!1};n(O),lt.setProfile(O)}}}else console.log("AuthProvider: No existing session found"),i(null),s(null),n(null)}catch(P){console.error("AuthProvider: Error checking auth:",P),i(null),s(null),n(null)}finally{g&&d(!1)}})();const A=setTimeout(()=>{g&&(console.log("Auth loading timeout - setting loading to false"),d(!1))},2e3);return()=>{g=!1,clearTimeout(A)}},[]);const m=async(g,b,A)=>{try{console.log("SignIn: Starting sign in process for:",g,"with role:",A);const P=await lt.login(g,b);console.log("SignIn: NestJS auth response:",{userId:P.user?.id}),s(P.user),i({access_token:P.access_token});let E=null;try{console.log("SignIn: Fetching profile");const V=await h(P.user.id);console.log("SignIn: Profile fetched successfully"),V.data&&(E=V.data,n(E))}catch{console.log("SignIn: Profile fetch failed, using user data");const M={id:P.user.id,user_name:P.user.user_name,email:P.user.email,role:P.user.role,status:"active",is_first_login:!1};E=M,n(M),lt.setProfile(M)}if(A&&E){const V=E.role?.toLowerCase()?.trim(),M=A.toLowerCase().trim(),O=E.user_name?.toLowerCase()||P.user.user_name?.toLowerCase()||"",I=E.email?.toLowerCase()||P.user.email?.toLowerCase()||"";console.log("SignIn: Checking role match",{userRole:V,expectedRole:M,profileRole:E.role,loginUserRole:P.user.role,userName:O,userEmail:I});let ee=V===M;if(!ee&&M==="super_admin"){const G=O.includes("super admin")||O.includes("admin"),ae=I.includes("admin@")||I.includes("@admin");(G||ae)&&(console.log("SignIn: Role mismatch but user appears to be super admin based on name/email, allowing access"),ee=!0,E.role="super_admin",n(E),lt.setProfile(E))}if(!ee)return console.log("SignIn: Role mismatch detected",{userRole:V,expectedRole:M,hasRole:!!V,userName:O,userEmail:I}),lt.removeToken(),s(null),i(null),n(null),u({variant:"destructive",title:"Access Denied",description:"You don't have permission to access this area"}),{error:{message:"Invalid role"},success:!1};console.log("SignIn: Role check passed")}return P.user.role==="attendant"&&(console.log("SignIn: Checking device restriction for attendant"),setTimeout(async()=>{try{const V=p(),{AttendantAPI:M}=await Ye(async()=>{const{AttendantAPI:ee}=await Promise.resolve().then(()=>wr);return{AttendantAPI:ee}},void 0),O=await M.isAttendantLoggedIn(P.user.id);!await M.checkDeviceRestriction(P.user.id,V)&&O?(console.log("Device restriction: Different device detected, allowing login with warning"),await M.updateDeviceFingerprint(P.user.id,V),u({variant:"default",title:"Device Switch Detected",description:"You were logged in on another device. This device is now active."})):(await M.updateDeviceFingerprint(P.user.id,V),console.log("Device restriction: Login allowed, device fingerprint updated"))}catch(V){console.error("Device restriction check failed:",V)}},100)),d(!1),u({title:"Welcome back!",description:`Signed in as ${P.user.user_name}`}),console.log("SignIn: Sign in process completed successfully"),{error:null,success:!0}}catch(P){console.error("SignIn: Unexpected error:",P);const E=P?.message||"An unexpected error occurred";return u({variant:"destructive",title:"Sign In Error",description:E}),{error:{message:E},success:!1}}},p=()=>{const g=document.createElement("canvas"),b=g.getContext("2d");b&&(b.textBaseline="top",b.font="14px Arial",b.fillText("Device fingerprint",2,2));const A=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),g.toDataURL()].join("|");let P=0;for(let E=0;E<A.length;E++){const V=A.charCodeAt(E);P=(P<<5)-P+V,P=P&P}return P.toString()},N={user:t,profile:r,session:o,loading:c,signIn:m,signUp:async(g,b,A)=>(u({variant:"destructive",title:"Sign Up Not Available",description:"User registration is managed by administrators. Please contact your administrator to create an account."}),{success:!1,error:{code:"SIGNUP_NOT_AVAILABLE",message:"User registration is managed by administrators",details:"Please contact your administrator to create an account"}}),signOut:async()=>{try{if(console.log("SignOut: Starting logout process..."),r?.role==="attendant"&&t)try{const{AttendantAPI:g}=await Ye(async()=>{const{AttendantAPI:b}=await Promise.resolve().then(()=>wr);return{AttendantAPI:b}},void 0);await g.updateDeviceFingerprint(t.id,""),console.log("SignOut: Device fingerprint cleared on logout")}catch(g){console.error("SignOut: Failed to clear device fingerprint:",g)}console.log("SignOut: Clearing all localStorage data..."),lt.clearAllAuthData(),s(null),n(null),i(null),console.log("SignOut: All data cleared successfully"),u({title:"Signed Out",description:"You have been signed out successfully"}),setTimeout(()=>{window.location.href="/"},100)}catch(g){console.error("SignOut error:",g);try{lt.clearAllAuthData()}catch(b){console.error("SignOut: Error clearing localStorage:",b);try{localStorage.clear()}catch(A){console.error("SignOut: Failed to clear localStorage completely:",A)}}s(null),n(null),i(null),u({title:"Signed Out",description:"You have been signed out successfully"}),window.location.href="/"}},updateProfile:async g=>{if(!t)return{error:{code:"NO_USER",message:"No user logged in"},success:!1};try{const{apiClient:b}=await Ye(async()=>{const{apiClient:P}=await Promise.resolve().then(()=>ci);return{apiClient:P}},void 0),A=await b.post(`/profiles/update/${t.id}`,g);if(A.data)return n(A.data),lt.setProfile(A.data),u({title:"Profile Updated",description:"Your profile has been updated successfully"}),{error:void 0,success:!0};throw new Error("Failed to update profile")}catch(b){const A=b?.message||"Failed to update profile";return u({variant:"destructive",title:"Update Error",description:A}),{error:{code:b?.statusCode||"UPDATE_ERROR",message:A,details:b?.message},success:!1}}},resetPassword:async g=>{try{return u({variant:"destructive",title:"Password Reset",description:"Password reset functionality will be available soon. Please contact administrator."}),{success:!1,error:{code:"NOT_IMPLEMENTED",message:"Password reset functionality is not yet implemented",details:"Please contact administrator for password reset"}}}catch(b){return console.error("Password reset error:",b),u({variant:"destructive",title:"Password Reset Error",description:"An unexpected error occurred"}),{success:!1,error:{code:"UNKNOWN",message:"An unexpected error occurred",details:b instanceof Error?b.message:"Unknown error"}}}}};return e.jsx(Kc.Provider,{value:N,children:a})},bf=zr("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),di=l.forwardRef(({className:a,variant:t,...s},r)=>e.jsx("div",{ref:r,role:"alert",className:ce(bf({variant:t}),a),...s}));di.displayName="Alert";const wf=l.forwardRef(({className:a,...t},s)=>e.jsx("h5",{ref:s,className:ce("mb-1 font-medium leading-none tracking-tight",a),...t}));wf.displayName="AlertTitle";const ui=l.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:ce("text-sm [&_p]:leading-relaxed",a),...t}));ui.displayName="AlertDescription";const Un=zr("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),F=l.forwardRef(({className:a,variant:t,size:s,asChild:r=!1,...n},o)=>{const i=r?im:"button";return e.jsx(i,{className:ce(Un({variant:t,size:s,className:a})),ref:o,...n})});F.displayName="Button";class jf extends l.Component{constructor(s){super(s);bs(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0}),window.location.reload()});this.state={hasError:!1}}static getDerivedStateFromError(s){if(s.message.includes("hydration")||s.message.includes("Text content does not match")||s.message.includes("Expected server HTML to contain"))return console.warn("Hydration error caught and handled:",s.message),{hasError:!0,error:s};throw s}componentDidCatch(s,r){console.error("HydrationErrorBoundary caught an error:",s,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs(di,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(sa,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(ui,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-800",children:"Display Issue Detected"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"There was a minor display issue. This usually happens on mobile devices during page refresh."})]}),e.jsxs(F,{onClick:this.handleRetry,variant:"outline",size:"sm",className:"w-full",children:[e.jsx(Fm,{className:"h-4 w-4 mr-2"}),"Refresh Page"]})]})]})})}):this.props.children}}function Nf({children:a}){const t=Dn(),s=Kt(),{user:r,profile:n,loading:o}=ft();return l.useEffect(()=>{o||(()=>{if(r&&n&&t.pathname.startsWith("/dashboard")){console.log("MobileRouter: User authenticated, allowing dashboard access");return}if(!r&&t.pathname.startsWith("/dashboard")){console.log("MobileRouter: User not authenticated, redirecting to login"),s("/login",{replace:!0});return}if(r&&n&&t.pathname!=="/"&&!t.pathname.startsWith("/dashboard")&&!t.pathname.startsWith("/login")&&!t.pathname.startsWith("/onboarding")){console.log("MobileRouter: Invalid route, redirecting to dashboard"),s("/dashboard",{replace:!0});return}})()},[t.pathname,r,n,o,s]),o?e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})}):e.jsx(e.Fragment,{children:a})}const _f=({children:a})=>{const{profile:t,loading:s}=ft(),r=Kt(),n=Dn();return l.useEffect(()=>{!s&&t&&n.pathname!=="/onboarding"&&t.is_first_login&&(console.log("First-time login detected, redirecting to onboarding"),r("/onboarding",{replace:!0}))},[t,s,r,n.pathname]),!s&&t?.is_first_login&&n.pathname!=="/onboarding"?null:e.jsx(e.Fragment,{children:a})};var Qc={exports:{}},Jc={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ar=l;function Sf(a,t){return a===t&&(a!==0||1/a===1/t)||a!==a&&t!==t}var kf=typeof Object.is=="function"?Object.is:Sf,Cf=ar.useState,Pf=ar.useEffect,Af=ar.useLayoutEffect,Ef=ar.useDebugValue;function Rf(a,t){var s=t(),r=Cf({inst:{value:s,getSnapshot:t}}),n=r[0].inst,o=r[1];return Af(function(){n.value=s,n.getSnapshot=t,io(n)&&o({inst:n})},[a,s,t]),Pf(function(){return io(n)&&o({inst:n}),a(function(){io(n)&&o({inst:n})})},[a]),Ef(s),s}function io(a){var t=a.getSnapshot;a=a.value;try{var s=t();return!kf(a,s)}catch{return!0}}function Tf(a,t){return t()}var Df=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Tf:Rf;Jc.useSyncExternalStore=ar.useSyncExternalStore!==void 0?ar.useSyncExternalStore:Df;Qc.exports=Jc;var If=Qc.exports;function Of(){return If.useSyncExternalStore(Lf,()=>!0,()=>!1)}function Lf(){return()=>{}}var hi="Avatar",[Mf,Nb]=Rs(hi),[Ff,Xc]=Mf(hi),ed=l.forwardRef((a,t)=>{const{__scopeAvatar:s,...r}=a,[n,o]=l.useState("idle");return e.jsx(Ff,{scope:s,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:e.jsx(De.span,{...r,ref:t})})});ed.displayName=hi;var td="AvatarImage",sd=l.forwardRef((a,t)=>{const{__scopeAvatar:s,src:r,onLoadingStatusChange:n=()=>{},...o}=a,i=Xc(td,s),c=$f(r,o),d=$s(u=>{n(u),i.onImageLoadingStatusChange(u)});return ns(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?e.jsx(De.img,{...o,ref:t,src:r}):null});sd.displayName=td;var ad="AvatarFallback",rd=l.forwardRef((a,t)=>{const{__scopeAvatar:s,delayMs:r,...n}=a,o=Xc(ad,s),[i,c]=l.useState(r===void 0);return l.useEffect(()=>{if(r!==void 0){const d=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(d)}},[r]),i&&o.imageLoadingStatus!=="loaded"?e.jsx(De.span,{...n,ref:t}):null});rd.displayName=ad;function Xi(a,t){return a?t?(a.src!==t&&(a.src=t),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function $f(a,{referrerPolicy:t,crossOrigin:s}){const r=Of(),n=l.useRef(null),o=r?(n.current||(n.current=new window.Image),n.current):null,[i,c]=l.useState(()=>Xi(o,a));return ns(()=>{c(Xi(o,a))},[o,a]),ns(()=>{const d=m=>()=>{c(m)};if(!o)return;const u=d("loaded"),h=d("error");return o.addEventListener("load",u),o.addEventListener("error",h),t&&(o.referrerPolicy=t),typeof s=="string"&&(o.crossOrigin=s),()=>{o.removeEventListener("load",u),o.removeEventListener("error",h)}},[o,s,t]),i}var nd=ed,od=sd,id=rd;const mi=l.forwardRef(({className:a,...t},s)=>e.jsx(nd,{ref:s,className:ce("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t}));mi.displayName=nd.displayName;const pi=l.forwardRef(({className:a,...t},s)=>e.jsx(od,{ref:s,className:ce("aspect-square h-full w-full",a),...t}));pi.displayName=od.displayName;const fi=l.forwardRef(({className:a,...t},s)=>e.jsx(id,{ref:s,className:ce("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t}));fi.displayName=id.displayName;const mn=cm,pn=dm,Vf=l.forwardRef(({className:a,inset:t,children:s,...r},n)=>e.jsxs(sc,{ref:n,className:ce("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",a),...r,children:[s,e.jsx(On,{className:"ml-auto h-4 w-4"})]}));Vf.displayName=sc.displayName;const Uf=l.forwardRef(({className:a,...t},s)=>e.jsx(ac,{ref:s,className:ce("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...t}));Uf.displayName=ac.displayName;const Ar=l.forwardRef(({className:a,sideOffset:t=4,...s},r)=>e.jsx(lm,{children:e.jsx(rc,{ref:r,sideOffset:t,className:ce("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})}));Ar.displayName=rc.displayName;const Vs=l.forwardRef(({className:a,inset:t,...s},r)=>e.jsx(nc,{ref:r,className:ce("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",a),...s}));Vs.displayName=nc.displayName;const zf=l.forwardRef(({className:a,children:t,checked:s,...r},n)=>e.jsxs(oc,{ref:n,className:ce("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),checked:s,...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ic,{children:e.jsx(In,{className:"h-4 w-4"})})}),t]}));zf.displayName=oc.displayName;const Bf=l.forwardRef(({className:a,children:t,...s},r)=>e.jsxs(lc,{ref:r,className:ce("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ic,{children:e.jsx(Sc,{className:"h-2 w-2 fill-current"})})}),t]}));Bf.displayName=lc.displayName;const Co=l.forwardRef(({className:a,inset:t,...s},r)=>e.jsx(cc,{ref:r,className:ce("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",a),...s}));Co.displayName=cc.displayName;const dn=l.forwardRef(({className:a,...t},s)=>e.jsx(dc,{ref:s,className:ce("-mx-1 my-1 h-px bg-muted",a),...t}));dn.displayName=dc.displayName;const Hf=zr("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Je({className:a,variant:t,...s}){return e.jsx("div",{className:ce(Hf({variant:t}),a),...s})}function qf({onMobileMenuToggle:a}){const{profile:t,signOut:s}=ft(),r=Kt(),[n]=l.useState([{id:1,message:"New vehicle checked in at Location A",time:"2 min ago"},{id:2,message:"Payment received for KA01AB1234",time:"5 min ago"}]),o=async()=>{await s()},i=d=>{switch(d){case"super_admin":return"bg-parkflow-red text-white";case"contractor":return"bg-parkflow-blue text-white";case"attendant":return"bg-parkflow-green text-white";default:return"bg-muted"}},c=d=>{switch(d){case"super_admin":return"Super Admin";case"contractor":return"Contractor";case"attendant":return"Attendant";default:return d}};return t?e.jsx("nav",{className:"sticky top-0 z-50 w-full border-b bg-white/50 backdrop-blur-xl supports-[backdrop-filter]:bg-white/30",children:e.jsxs("div",{className:"flex h-14 sm:h-16 items-center justify-between px-3 sm:px-4 lg:px-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 min-w-0",children:[e.jsx(ot,{className:"h-5 w-5 sm:h-6 sm:w-6 lg:h-8 lg:w-8 text-parkflow-blue flex-shrink-0"}),e.jsx("h1",{className:"text-base sm:text-lg lg:text-xl xl:text-2xl font-bold text-parkflow-blue truncate",children:"ParkFlow"})]}),e.jsx(Je,{className:`${i(t.role||"")} text-xs sm:text-sm hidden sm:inline-flex flex-shrink-0`,children:c(t.role||"")})]}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 lg:space-x-4",children:[e.jsx(F,{variant:"ghost",size:"icon",className:"lg:hidden relative z-50 h-8 w-8 sm:h-9 sm:w-9",onClick:d=>{d.preventDefault(),d.stopPropagation(),a&&a()},children:e.jsx(Mm,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),e.jsxs(mn,{children:[e.jsx(pn,{asChild:!0,children:e.jsxs(F,{variant:"ghost",size:"icon",className:"relative h-8 w-8 sm:h-9 sm:w-9",children:[e.jsx(vo,{className:"h-4 w-4 sm:h-5 sm:w-5"}),n.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-3 w-3 bg-parkflow-red rounded-full text-xs text-white flex items-center justify-center",children:n.length})]})}),e.jsxs(Ar,{align:"end",className:"w-72 sm:w-80",children:[e.jsx(Co,{className:"text-sm",children:"Notifications"}),e.jsx(dn,{}),n.map(d=>e.jsxs(Vs,{className:"flex flex-col items-start p-3 sm:p-4",children:[e.jsx("p",{className:"text-xs sm:text-sm",children:d.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:d.time})]},d.id))]})]}),e.jsxs(mn,{children:[e.jsx(pn,{asChild:!0,children:e.jsx(F,{variant:"ghost",className:"relative h-8 w-8 sm:h-9 sm:w-9 lg:h-10 lg:w-10 rounded-full",children:e.jsxs(mi,{className:"h-8 w-8 sm:h-9 sm:w-9 lg:h-10 lg:w-10",children:[e.jsx(pi,{src:"",alt:t.user_name||t.email||"User"}),e.jsx(fi,{className:"bg-parkflow-blue text-white text-xs sm:text-sm",children:(t.user_name||t.email||"U").charAt(0).toUpperCase()})]})})}),e.jsxs(Ar,{className:"w-48 sm:w-56",align:"end",children:[e.jsx(Co,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium leading-none truncate",children:t.user_name||t.email||"User"}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground truncate",children:t.email||"No email"}),e.jsx(Je,{className:`${i(t.role||"")} w-fit mt-2 text-xs`,variant:"secondary",children:c(t.role||"")})]})}),e.jsx(dn,{}),e.jsxs(Vs,{onClick:()=>r("/dashboard/profile"),className:"text-xs sm:text-sm",children:[e.jsx(Sr,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Profile"})]}),e.jsxs(Vs,{onClick:()=>r("/dashboard/settings"),className:"text-xs sm:text-sm",children:[e.jsx(ri,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Settings"})]}),e.jsx(dn,{}),e.jsxs(Vs,{onClick:o,className:"text-xs sm:text-sm",children:[e.jsx(kc,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Sign out"})]})]})]})]})]})}):null}const Wf=[{title:"Dashboard",href:"/dashboard",icon:Om,roles:["super_admin","contractor","attendant"]},{title:"Contractors",href:"/dashboard/contractors",icon:Ra,roles:["super_admin"]},{title:"Subscriptions",href:"/dashboard/subscriptions",icon:wa,roles:["super_admin"]},{title:"Locations",href:"/dashboard/locations",icon:rs,roles:["super_admin","contractor"]},{title:"Attendants",href:"/dashboard/attendants",icon:Wt,roles:["super_admin","contractor"]},{title:"Vehicles",href:"/dashboard/vehicles",icon:ot,roles:["super_admin","contractor","attendant"]},{title:"QR Scanner",href:"/dashboard/qr-scanner",icon:wo,roles:["attendant"]},{title:"Check In/Out",href:"/dashboard/check-inout",icon:ni,roles:["attendant"]},{title:"Logs",href:"/dashboard/logs",icon:go,roles:["super_admin","contractor","attendant"]},{title:"Income",href:"/dashboard/income",icon:ta,roles:["super_admin","contractor"]},{title:"Reports",href:"/dashboard/reports",icon:ja,roles:["super_admin","contractor"]},{title:"Settings",href:"/dashboard/settings",icon:ri,roles:["super_admin","contractor","attendant"]}];function Yf({className:a,isMobileOpen:t,onMobileClose:s}){const{profile:r}=ft(),n=Dn(),o=Kt();if(!r)return null;const i=Wf.filter(d=>d.roles.includes(r.role)),c=d=>{o(d),s&&s()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:ce("hidden lg:flex w-64 flex-col bg-gradient-to-b from-indigo-900 via-purple-900 to-indigo-800 text-white/90",a),children:[e.jsx("div",{className:"flex-1 overflow-y-auto py-4 sm:py-6",children:e.jsx("nav",{className:"grid items-start px-2 sm:px-3 text-xs sm:text-sm font-medium",children:i.map(d=>{const u=d.icon,h=n.pathname===d.href||d.href!=="/dashboard"&&n.pathname.startsWith(d.href);return e.jsxs(F,{variant:h?"secondary":"ghost",className:ce("w-full justify-start mb-1 rounded-lg text-xs sm:text-sm py-2 px-2 sm:px-3",h?"bg-white/15 text-white hover:bg-white/20":"text-white/80 hover:bg-white/10 hover:text-white"),onClick:()=>c(d.href),children:[e.jsx(u,{className:"mr-2 h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:d.title}),d.badge&&e.jsx("span",{className:"ml-auto rounded-full bg-parkflow-blue px-1.5 py-0.5 text-xs text-white flex-shrink-0",children:d.badge})]},d.href)})})}),e.jsx("div",{className:"mt-auto p-2 sm:p-4",children:e.jsxs("div",{className:"rounded-lg bg-white/10 p-3 sm:p-4 text-center shadow-sm text-white",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium",children:"ParkFlow Pro"}),e.jsx("p",{className:"text-xs text-white/70 mt-1",children:r.role==="super_admin"?"System Administrator":r.role==="contractor"?"Contractor Panel":"Attendant Panel"})]})})]}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 lg:hidden",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:s}),e.jsxs("div",{className:"fixed left-0 top-0 h-full w-64 sm:w-72 bg-gradient-to-b from-indigo-900 via-purple-900 to-indigo-800 text-white/90",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b border-white/10",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold",children:"Menu"}),e.jsx(F,{variant:"ghost",size:"icon",onClick:s,className:"text-white/80 hover:text-white hover:bg-white/10 h-8 w-8",children:e.jsx(Ds,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto py-3 sm:py-4",children:e.jsx("nav",{className:"grid items-start px-2 sm:px-3 text-sm font-medium",children:i.map(d=>{const u=d.icon,h=n.pathname===d.href||d.href!=="/dashboard"&&n.pathname.startsWith(d.href);return e.jsxs(F,{variant:h?"secondary":"ghost",className:ce("w-full justify-start mb-1 rounded-lg text-sm py-2 px-2 sm:px-3",h?"bg-white/15 text-white hover:bg-white/20":"text-white/80 hover:bg-white/10 hover:text-white"),onClick:()=>c(d.href),children:[e.jsx(u,{className:"mr-2 h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:d.title}),d.badge&&e.jsx("span",{className:"ml-auto rounded-full bg-parkflow-blue px-1.5 py-0.5 text-xs text-white flex-shrink-0",children:d.badge})]},d.href)})})}),e.jsx("div",{className:"p-3 sm:p-4 border-t border-white/10",children:e.jsxs("div",{className:"rounded-lg bg-white/10 p-3 sm:p-4 text-center shadow-sm text-white",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium",children:"ParkFlow Pro"}),e.jsx("p",{className:"text-xs text-white/70 mt-1",children:r.role==="super_admin"?"System Administrator":r.role==="contractor"?"Contractor Panel":"Attendant Panel"})]})})]})]})]})}function zn(a){const{page:t=1,pageSize:s=10,search:r="",sortBy:n="created_on",sortOrder:o="desc"}=a,i=[];return r&&i.push({key:"all",value:r,operator:"LIKE"}),{curPage:t,perPage:s,sortBy:n,direction:o,whereClause:i}}class oa{static async getAllAttendants(t={}){const s=zn(t),r=await pe.post("/attendants/paginated",s);return{data:r.data.data,count:r.data.count,curPage:r.data.curPage,perPage:r.data.perPage,totalPages:r.data.totalPages,page:r.data.curPage,pageSize:r.data.perPage}}static async getAttendantsByContractor(t,s={}){const{page:r=1,pageSize:n=10,search:o="",sortBy:i="created_on",sortOrder:c="desc"}=s;return(await pe.get(`/attendants/contractor/${t}`,{page:r,pageSize:n,search:o,sortBy:i,sortOrder:c})).data}static async createAttendant(t){return(await pe.post("/attendants",{user_name:t.user_name,email:t.email,password:t.password,phone_number:t.phone_number,location_id:t.location_id,contractor_id:t.contractor_id,status:"active"})).data}static async updateAttendant(t,s){const r={};return s.user_name&&(r.user_name=s.user_name),s.email&&(r.email=s.email),s.password&&(r.password=s.password),s.phone_number!==void 0&&(r.phone_number=s.phone_number),s.location_id!==void 0&&(r.location_id=s.location_id),s.status&&(r.status=s.status),(await pe.post(`/attendants/update/${t}`,r)).data}static async deleteAttendant(t){await pe.get(`/attendants/delete/${t}`)}static async getAttendantStats(t){return t?(await pe.get(`/attendants/${t}/stats`)).data:(await pe.get("/attendants/stats/overall")).data}static async getAttendantByUserId(t){return(await pe.get(`/attendants/user/${t}`)).data}static async getAttendantById(t){return(await pe.get(`/attendants/${t}`)).data}static async getAttendantLocations(t){return(await pe.get(`/attendants/${t}/locations`)).data||[]}static async addVehicle(t,s){const r=await this.getAttendantByUserId(s);if(!r.location_id||r.location_id!==t.location_id)throw new Error("You are not authorized to add vehicles to this location");const{data:n,error:o}=await supabase.from("vehicles").select("id, plate_number, status, location_id, parking_locations:location_id (locations_name)").eq("plate_number",t.plate_number).eq("status","checked_in").single();if(o&&o.code!=="PGRST116")throw new Error(`Error checking existing vehicle: ${o.message}`);if(n){const u=n.parking_locations?.locations_name||"Unknown Location";throw new Error(`Vehicle ${t.plate_number} is already parked at ${u}. Please check out the vehicle first before checking in again.`)}const i=new Date().toISOString(),{data:c,error:d}=await supabase.from("vehicles").insert({plate_number:t.plate_number,vehicle_type:t.vehicle_type,location_id:t.location_id,contractor_id:t.contractor_id,check_in_time:i,payment_status:"pending",created_by:s}).select(`
        *,
        parking_locations (
          locations_name,
          address
        )
      `).single();if(d)throw d;return c}static async updateVehicle(t,s,r){const{data:n,error:o}=await supabase.from("vehicles").select("location_id").eq("id",t).eq("is_deleted",!1).single();if(o)throw o;const i=await this.getAttendantByUserId(r);if(!i.location_id||i.location_id!==n.location_id)throw new Error("You are not authorized to update vehicles in this location");const{data:c,error:d}=await supabase.from("vehicles").update({...s,updated_by:r}).eq("id",t).select(`
        *,
        parking_locations (
          locations_name,
          address
        )
      `).single();if(d)throw d;return c}static async exitVehicle(t,s){const{data:r,error:n}=await supabase.from("vehicles").select("location_id, check_in_time, vehicle_type").eq("id",t).eq("is_deleted",!1).single();if(n)throw n;const o=await this.getAttendantByUserId(s);if(!o.location_id||o.location_id!==r.location_id)throw new Error("You are not authorized to exit vehicles from this location");const i=new Date().toISOString(),c=new Date(r.check_in_time),d=Math.ceil((new Date(i).getTime()-c.getTime())/(1e3*60*60)),{data:u,error:h}=await supabase.from("contractors").select("rates_2wheeler, rates_4wheeler").eq("id",o.contractor_id).single();let m=0,p=0;if(h){console.error("Error fetching contractor rates:",h);const y={"2wheeler":{upTo2Hours:2,upTo6Hours:5,upTo12Hours:8,upTo24Hours:12},"4wheeler":{upTo2Hours:5,upTo6Hours:10,upTo12Hours:18,upTo24Hours:30}},w=y[r.vehicle_type]||y["4wheeler"];if(d<=2)m=w.upTo2Hours;else if(d<=6)m=w.upTo6Hours;else if(d<=12)m=w.upTo12Hours;else if(d<=24)m=w.upTo24Hours;else{const N=Math.floor(d/24),g=d%24;m=N*w.upTo24Hours+g*(w.upTo24Hours/24)}p=m/d}else{const y=r.vehicle_type==="2wheeler"?u.rates_2wheeler:u.rates_4wheeler;if(d<=2)m=y.upTo2Hours;else if(d<=6)m=y.upTo6Hours;else if(d<=12)m=y.upTo12Hours;else if(d<=24)m=y.upTo24Hours;else{const w=Math.floor(d/24),N=d%24;m=w*y.upTo24Hours+N*(y.upTo24Hours/24)}p=m/d}const{data:f,error:v}=await supabase.from("vehicles").update({check_out_time:i,payment_amount:m,payment_status:"completed",updated_by:s}).eq("id",t).select(`
        *,
        parking_locations (
          locations_name,
          address
        )
      `).single();if(v)throw v;try{const{error:y}=await supabase.from("payments").insert({vehicle_id:t,location_id:r.location_id,contractor_id:o.contractor_id,attendant_id:o.id,amount:m,payment_method:"cash",payment_status:"completed",duration_hours:d,hourly_rate:p});y?(console.error("Payment record creation error:",y),console.warn("Payment record could not be created, but vehicle exit was successful")):console.log("Payment record created successfully in payments table")}catch(y){console.error("Error creating payment record:",y)}return f}static async getVehiclesByLocation(t){const s=await this.getAttendantByUserId(t);if(!s.location_id)throw new Error("No location assigned to this attendant");const{data:r,error:n}=await supabase.from("vehicles").select(`
        *,
        parking_locations (
          locations_name,
          address
        )
      `).eq("location_id",s.location_id).eq("is_deleted",!1).order("created_on",{ascending:!1});if(n)throw n;return r||[]}static async getVehiclesByDateRange(t,s,r){const n=await this.getAttendantByUserId(t);if(!n.location_id)throw new Error("No location assigned to this attendant");const{data:o,error:i}=await supabase.from("vehicles").select(`
        *,
        parking_locations (
          locations_name,
          address
        )
      `).eq("location_id",n.location_id).eq("is_deleted",!1).gte("created_on",s).lte("created_on",r).order("created_on",{ascending:!1});if(i)throw i;return o||[]}static async getVehiclesByAttendant(t){const{data:s,error:r}=await supabase.from("vehicles").select(`
        *,
        parking_locations (
          locations_name,
          address
        )
      `).eq("created_by",t).eq("is_deleted",!1).order("created_on",{ascending:!1});if(r)throw r;return s||[]}static async getAttendantStatsByUser(t){const s=new Date().toISOString().split("T")[0],r=await this.getAttendantByUserId(t);if(!r.location_id)return{totalVehicles:0,todayVehicles:0,totalRevenue:0,todayRevenue:0,activeVehicles:0};const[n,o,i]=await Promise.all([supabase.from("vehicles").select("payment_amount",{count:"exact"}).eq("location_id",r.location_id).eq("is_deleted",!1),supabase.from("vehicles").select("payment_amount",{count:"exact"}).eq("location_id",r.location_id).gte("created_on",s).eq("is_deleted",!1),supabase.from("vehicles").select("payment_amount",{count:"exact"}).eq("location_id",r.location_id).is("check_out_time",null).eq("is_deleted",!1)]),c=n.data?.reduce((u,h)=>u+(h.payment_amount||0),0)||0,d=o.data?.reduce((u,h)=>u+(h.payment_amount||0),0)||0;return{totalVehicles:n.count||0,todayVehicles:o.count||0,totalRevenue:c,todayRevenue:d,activeVehicles:i.count||0}}static async checkDeviceRestriction(t,s){try{const{data:r,error:n}=await supabase.from("profiles").select("device_fingerprint").eq("id",t).single();return n?(console.error("Device restriction check error:",n),!0):!r?.device_fingerprint||r.device_fingerprint===""?(console.log("Device restriction: No previous device fingerprint, allowing login"),!0):r.device_fingerprint===s?(console.log("Device restriction: Same device detected, allowing login"),!0):(console.log("Device restriction: Different device detected, allowing login with warning"),!0)}catch(r){return console.error("Device restriction check failed:",r),!0}}static async updateDeviceFingerprint(t,s){try{const{error:r}=await supabase.from("profiles").update({device_fingerprint:s}).eq("id",t);r?console.error("Failed to update device fingerprint:",r):console.log("Device fingerprint updated successfully")}catch(r){console.error("Device fingerprint update failed:",r)}}static async isAttendantLoggedIn(t){try{const{data:s,error:r}=await supabase.from("profiles").select("device_fingerprint").eq("id",t).single();return r?(console.error("Check login status error:",r),!1):!!(s?.device_fingerprint&&s.device_fingerprint!=="")}catch(s){return console.error("Check login status failed:",s),!1}}static generateVehicleQRCode(t){const s={type:"vehicle_entry",plate_number:t.plate_number,vehicle_type:t.vehicle_type,location_id:t.location_id,timestamp:new Date().toISOString()};return JSON.stringify(s)}static generateExitQRCode(t){const s={type:"vehicle_exit",vehicle_id:t,timestamp:new Date().toISOString()};return JSON.stringify(s)}}const wr=Object.freeze(Object.defineProperty({__proto__:null,AttendantAPI:oa},Symbol.toStringTag,{value:"Module"}));class es{static async createLocation(t){return(await pe.post("/locations",{locations_name:t.locations_name,address:t.address,city:t.city,state:t.state,pincode:t.pincode,total_slots:t.total_slots,contractor_id:t.contractor_id,status:t.status||"active"})).data}static async getAllLocations(){return(await pe.get("/locations")).data||[]}static async getLocationById(t){return(await pe.get(`/locations/${t}`)).data}static async getPaginatedLocations(t={}){const s=zn(t),r=await pe.post("/locations/paginated",s);return{data:r.data.data,count:r.data.count,curPage:r.data.curPage,perPage:r.data.perPage,totalPages:r.data.totalPages,page:r.data.curPage,pageSize:r.data.perPage}}static async getContractorLocations(t){return(await pe.get(`/locations/contractor/${t}`)).data||[]}static async getAttendantLocations(t){return(await pe.get(`/locations/attendant/${t}`)).data||[]}static async updateLocation(t,s){return(await pe.post(`/locations/update/${t}`,s)).data}static async deleteLocation(t){await pe.get(`/locations/delete/${t}`)}static async getLocationStats(t){return(await pe.get(`/locations/${t}/stats`)).data}static async assignLocationToAttendant(t,s){await pe.post(`/locations/${s}/assign-attendant`,{attendantId:t})}static async removeLocationFromAttendant(t,s){await pe.get(`/locations/delete/${t}/attendant/${s}`)}}const Gf=Object.freeze(Object.defineProperty({__proto__:null,LocationAPI:es},Symbol.toStringTag,{value:"Module"}));class kt{static async getAllContractors(){return(await pe.get("/contractors")).data||[]}static async getContractorsPaginated(t={}){const s=zn(t),r=await pe.post("/contractors/paginated",s);return{data:r.data.data,count:r.data.count,curPage:r.data.curPage,perPage:r.data.perPage,totalPages:r.data.totalPages,page:r.data.curPage,pageSize:r.data.perPage}}static async getContractorByUserId(t){return(await pe.get(`/contractors/user/${t}`)).data}static async getContractorById(t){return(await pe.get(`/contractors/${t}`)).data}static async createContractor(t){return(await pe.post("/contractors",t)).data}static async updateContractor(t,s){return(await pe.post(`/contractors/update/${t}`,s)).data}static async deleteContractor(t){await pe.get(`/contractors/delete/${t}`)}static async getContractorLocations(t){return(await pe.get(`/contractors/${t}/locations`)).data||[]}static async getContractorAttendants(t){return(await pe.get(`/contractors/${t}/attendants`)).data||[]}static async getContractorVehicles(t){return(await pe.get(`/contractors/${t}/vehicles`)).data||[]}static async getContractorPayments(t){return(await pe.get(`/contractors/${t}/payments`)).data||[]}static async getContractorStats(t){return(await pe.get(`/contractors/${t}/stats`)).data}static async getContractorDayWiseRevenue(t,s=30){return(await pe.get(`/contractors/${t}/revenue/day-wise`,{days:s})).data}static async getContractorMonthWiseRevenue(t,s=12){return(await pe.get(`/contractors/${t}/revenue/month-wise`,{months:s})).data}}const Er=Object.freeze(Object.defineProperty({__proto__:null,ContractorAPI:kt},Symbol.toStringTag,{value:"Module"}));async function Bn(a){try{const t=await oa.getAttendantByUserId(a);if(!t||!t.location_id)return{isExpired:!0,isSuspended:!0,daysRemaining:0,endDate:null,status:"unknown"};const s=await es.getLocationById(t.location_id);if(!s||!s.contractor_id)return{isExpired:!0,isSuspended:!0,daysRemaining:0,endDate:null,status:"unknown"};const r=await kt.getContractorById(s.contractor_id);if(!r||!r.profiles)return{isExpired:!0,isSuspended:!0,daysRemaining:0,endDate:null,status:"unknown"};const n=r.profiles,o=new Date,i=n.subscription_end_date?new Date(n.subscription_end_date):null,c=i&&i<o,d=n.subscription_status==="expired"||n.subscription_status==="suspended",u=i?Math.ceil((i.getTime()-o.getTime())/(1e3*60*60*24)):0;return{isExpired:c||!1,isSuspended:d||!1,daysRemaining:Math.max(0,u),endDate:i,status:n.subscription_status||"unknown"}}catch(t){return console.error("Error checking attendant contractor subscription:",t),{isExpired:!0,isSuspended:!0,daysRemaining:0,endDate:null,status:"error"}}}function Zf(a){return a.isExpired?"Your contractor's subscription has expired. Please contact your contractor to recharge.":a.daysRemaining<=7?`Your contractor's subscription will expire in ${a.daysRemaining} days. Please contact your contractor to recharge.`:""}function Kf({className:a=""}){const{profile:t}=ft(),[s,r]=l.useState(null),[n,o]=l.useState(!0);if(l.useEffect(()=>{t?.role==="attendant"&&Bn(t.id).then(r)},[t]),t?.role!=="attendant"||!s||!s.isExpired&&!s.isSuspended&&s.daysRemaining>7)return null;const i=Zf(s);if(!i)return null;const c=s.isExpired||s.isSuspended,d=c?"destructive":"default";return n?e.jsxs(di,{className:`${d==="destructive"?"border-red-200 bg-red-50":"border-yellow-200 bg-yellow-50"} ${a}`,children:[e.jsx(sa,{className:"h-4 w-4"}),e.jsxs(ui,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex-1",children:[e.jsx("strong",{children:c?"Contractor Subscription Expired!":"Contractor Subscription Expiring Soon!"}),e.jsx("br",{}),i]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>o(!1),className:"ml-2 h-6 w-6 p-0",children:e.jsx(Ds,{className:"h-4 w-4"})})]})]}):null}function Qf(){const{user:a,profile:t,loading:s}=ft(),[r,n]=l.useState(!1);return console.log("DashboardLayout: loading =",s,"user =",a?.id,"profile =",t?.id),s?(console.log("DashboardLayout: Showing loading spinner"),e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})})):!a||!t?(console.log("DashboardLayout: No user or profile, redirecting to role selection"),e.jsx(wc,{to:"/",replace:!0})):t.status==="inactive"?e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-parkflow-red mb-4",children:"Account Inactive"}),e.jsx("p",{className:"text-muted-foreground",children:"Your account is currently inactive. Please contact your administrator to activate your account."})]})}):e.jsx(_f,{children:e.jsxs("div",{className:"min-h-screen bg-[radial-gradient(900px_450px_at_70%_20%,theme(colors.indigo.200)/20,transparent_60%),linear-gradient(to_bottom_right,theme(colors.slate.50),theme(colors.slate.100))]",children:[e.jsx(qf,{onMobileMenuToggle:()=>n(!r)}),e.jsxs("div",{className:"flex min-h-[calc(100vh-3.5rem)] sm:min-h-[calc(100vh-4rem)]",children:[e.jsx(Yf,{className:"sticky top-14 sm:top-16 h-[calc(100vh-3.5rem)] sm:h-[calc(100vh-4rem)] hidden lg:flex",isMobileOpen:r,onMobileClose:()=>n(!1)}),e.jsx("main",{className:"flex-1 overflow-hidden",children:e.jsxs("div",{className:"p-2 sm:p-3 lg:p-4 xl:p-6",children:[e.jsx(Kf,{className:"mb-4"}),e.jsx(ym,{})]})})]}),e.jsx(Tc,{})]})})}const Jf=()=>{const a=Kt();return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4 sm:p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 via-purple-900/80 to-pink-900/90"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-purple-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_left,_var(--tw-gradient-stops))] from-indigo-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-pink-600/10 via-transparent to-transparent"}),e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-gradient-to-r from-indigo-500/20 to-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-full blur-3xl animate-pulse delay-500"}),e.jsxs("div",{className:"max-w-5xl w-full grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 items-center relative z-10",children:[e.jsxs("div",{className:"text-white space-y-4 sm:space-y-6 text-center md:text-left relative z-10",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-2 sm:space-x-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-r from-purple-500 via-indigo-500 to-blue-500 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-base sm:text-lg",children:"CAR"})}),e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold bg-gradient-to-r from-purple-300 via-indigo-300 to-blue-300 bg-clip-text text-transparent",children:"ParkFlow"})]}),e.jsx("p",{className:"text-base sm:text-lg text-white/80 font-light",children:"Smart Parking Management Made Easy"})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-2 sm:space-x-3 text-white/90",children:[e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs font-bold",children:""})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Real-time Parking Analytics"})]}),e.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-2 sm:space-x-3 text-white/90",children:[e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs font-bold",children:""})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Secure Role-based Access"})]}),e.jsxs("div",{className:"flex items-center justify-center md:justify-start space-x-2 sm:space-x-3 text-white/90",children:[e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs font-bold",children:""})}),e.jsx("span",{className:"text-sm sm:text-base",children:"Scalable Multi-location Management"})]})]})]}),e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 p-4 sm:p-6 text-white text-center relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/80 via-indigo-600/80 to-blue-600/80"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-1",children:"Welcome to ParkFlow"}),e.jsx("p",{className:"text-purple-100 text-xs sm:text-sm",children:"Select a role to sign in to your dashboard"})]})]}),e.jsxs("div",{className:"p-4 sm:p-6 space-y-3 sm:space-y-4 bg-white/5 backdrop-blur-sm",children:[e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("button",{className:"w-full flex items-center justify-center space-x-2 p-3 bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold rounded-xl transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-[1.02]",onClick:()=>a("/login?role=contractor"),children:[e.jsx("span",{className:"text-sm",children:""}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Continue as Contractor"})]}),e.jsxs("button",{className:"w-full flex items-center justify-center space-x-2 p-3 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white font-semibold rounded-xl transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-[1.02]",onClick:()=>a("/login?role=attendant"),children:[e.jsx("span",{className:"text-sm",children:""}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Continue as Attendant"})]}),e.jsxs("button",{className:"w-full flex items-center justify-center space-x-2 p-3 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-semibold rounded-xl transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-[1.02]",onClick:()=>a("/superadmin-verification"),children:[e.jsx("span",{className:"text-sm",children:""}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Continue as Super Admin"})]})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 sm:space-x-6 pt-2 sm:pt-3 text-white/70 text-xs",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-green-400",children:""}),e.jsx("span",{children:"SSL Secured"})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-blue-400",children:""}),e.jsx("span",{children:"MFA Supported"})]})]}),e.jsxs("p",{className:"text-center text-xs text-white/60 leading-relaxed",children:["By clicking continue, you agree to our"," ",e.jsx(ss,{to:"/terms-of-service",className:"text-purple-300 hover:text-purple-200 underline",children:"Terms of Service"})," ","and"," ",e.jsx(ss,{to:"/privacy-policy",className:"text-purple-300 hover:text-purple-200 underline",children:"Privacy Policy"}),"."]})]})]})})]})]})},ge=l.forwardRef(({className:a,type:t,...s},r)=>e.jsx("input",{type:t,className:ce("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:r,...s}));ge.displayName="Input";var Xf="Label",ld=l.forwardRef((a,t)=>e.jsx(De.label,{...a,ref:t,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(a.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));ld.displayName=Xf;var cd=ld;const ex=zr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),te=l.forwardRef(({className:a,...t},s)=>e.jsx(cd,{ref:s,className:ce(ex(),a),...t}));te.displayName=cd.displayName;const _e=l.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:ce("rounded-lg border bg-card text-card-foreground shadow-sm",a),...t}));_e.displayName="Card";const ze=l.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:ce("flex flex-col space-y-1.5 p-6",a),...t}));ze.displayName="CardHeader";const Be=l.forwardRef(({className:a,...t},s)=>e.jsx("h3",{ref:s,className:ce("text-2xl font-semibold leading-none tracking-tight",a),...t}));Be.displayName="CardTitle";const et=l.forwardRef(({className:a,...t},s)=>e.jsx("p",{ref:s,className:ce("text-sm text-muted-foreground",a),...t}));et.displayName="CardDescription";const Ee=l.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:ce("p-6 pt-0",a),...t}));Ee.displayName="CardContent";const tx=l.forwardRef(({className:a,...t},s)=>e.jsx("div",{ref:s,className:ce("flex items-center p-6 pt-0",a),...t}));tx.displayName="CardFooter";function xi(a){const t=l.useRef({value:a,previous:a});return l.useMemo(()=>(t.current.value!==a&&(t.current.previous=t.current.value,t.current.value=a),t.current.previous),[a])}var Hn="Checkbox",[sx,_b]=Rs(Hn),[ax,gi]=sx(Hn);function rx(a){const{__scopeCheckbox:t,checked:s,children:r,defaultChecked:n,disabled:o,form:i,name:c,onCheckedChange:d,required:u,value:h="on",internal_do_not_use_render:m}=a,[p,f]=Ia({prop:s,defaultProp:n??!1,onChange:d,caller:Hn}),[v,y]=l.useState(null),[w,N]=l.useState(null),g=l.useRef(!1),b=v?!!i||!!v.closest("form"):!0,A={checked:p,disabled:o,setChecked:f,control:v,setControl:y,name:c,form:i,value:h,hasConsumerStoppedPropagationRef:g,required:u,defaultChecked:ia(n)?!1:n,isFormControl:b,bubbleInput:w,setBubbleInput:N};return e.jsx(ax,{scope:t,...A,children:nx(m)?m(A):r})}var dd="CheckboxTrigger",ud=l.forwardRef(({__scopeCheckbox:a,onKeyDown:t,onClick:s,...r},n)=>{const{control:o,value:i,disabled:c,checked:d,required:u,setControl:h,setChecked:m,hasConsumerStoppedPropagationRef:p,isFormControl:f,bubbleInput:v}=gi(dd,a),y=rt(n,h),w=l.useRef(d);return l.useEffect(()=>{const N=o?.form;if(N){const g=()=>m(w.current);return N.addEventListener("reset",g),()=>N.removeEventListener("reset",g)}},[o,m]),e.jsx(De.button,{type:"button",role:"checkbox","aria-checked":ia(d)?"mixed":d,"aria-required":u,"data-state":xd(d),"data-disabled":c?"":void 0,disabled:c,value:i,...r,ref:y,onKeyDown:Oe(t,N=>{N.key==="Enter"&&N.preventDefault()}),onClick:Oe(s,N=>{m(g=>ia(g)?!0:!g),v&&f&&(p.current=N.isPropagationStopped(),p.current||N.stopPropagation())})})});ud.displayName=dd;var vi=l.forwardRef((a,t)=>{const{__scopeCheckbox:s,name:r,checked:n,defaultChecked:o,required:i,disabled:c,value:d,onCheckedChange:u,form:h,...m}=a;return e.jsx(rx,{__scopeCheckbox:s,checked:n,defaultChecked:o,disabled:c,required:i,onCheckedChange:u,name:r,form:h,value:d,internal_do_not_use_render:({isFormControl:p})=>e.jsxs(e.Fragment,{children:[e.jsx(ud,{...m,ref:t,__scopeCheckbox:s}),p&&e.jsx(fd,{__scopeCheckbox:s})]})})});vi.displayName=Hn;var hd="CheckboxIndicator",md=l.forwardRef((a,t)=>{const{__scopeCheckbox:s,forceMount:r,...n}=a,o=gi(hd,s);return e.jsx(Ts,{present:r||ia(o.checked)||o.checked===!0,children:e.jsx(De.span,{"data-state":xd(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...a.style}})})});md.displayName=hd;var pd="CheckboxBubbleInput",fd=l.forwardRef(({__scopeCheckbox:a,...t},s)=>{const{control:r,hasConsumerStoppedPropagationRef:n,checked:o,defaultChecked:i,required:c,disabled:d,name:u,value:h,form:m,bubbleInput:p,setBubbleInput:f}=gi(pd,a),v=rt(s,f),y=xi(o),w=uc(r);l.useEffect(()=>{const g=p;if(!g)return;const b=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(b,"checked").set,E=!n.current;if(y!==o&&P){const V=new Event("click",{bubbles:E});g.indeterminate=ia(o),P.call(g,ia(o)?!1:o),g.dispatchEvent(V)}},[p,y,o,n]);const N=l.useRef(ia(o)?!1:o);return e.jsx(De.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??N.current,required:c,disabled:d,name:u,value:h,form:m,...t,tabIndex:-1,ref:v,style:{...t.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});fd.displayName=pd;function nx(a){return typeof a=="function"}function ia(a){return a==="indeterminate"}function xd(a){return ia(a)?"indeterminate":a?"checked":"unchecked"}const fn=l.forwardRef(({className:a,...t},s)=>e.jsx(vi,{ref:s,className:ce("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...t,children:e.jsx(md,{className:ce("flex items-center justify-center text-current"),children:e.jsx(In,{className:"h-4 w-4"})})}));fn.displayName=vi.displayName;function ox(){const[a,t]=l.useState(""),[s,r]=l.useState(""),[n,o]=l.useState(!1),[i,c]=l.useState(!1),[d,u]=l.useState(!1),{signIn:h,user:m,profile:p,signOut:f}=ft(),v=Kt(),[y]=bm(),w=y.get("role")||"";l.useEffect(()=>{if(console.log("Login useEffect triggered:",{user:m?.id,profile:p?.id,role:w,loading:d}),m&&p&&p.status==="active"){if(console.log("Login: User and profile found, checking role..."),w&&p.role!==w){console.log("Role mismatch detected:",{expected:w,actual:p.role}),u(!1);return}if(w==="attendant"){console.log("Attendant role requires explicit login, not auto-redirecting"),u(!1);return}console.log("Login: All checks passed, navigating to dashboard..."),u(!1),v("/dashboard",{replace:!0})}else console.log("Login: Not ready for navigation yet:",{hasUser:!!m,hasProfile:!!p,profileStatus:p?.status})},[m,p,v,w,d]);const N=async()=>{await f(),t(""),r("")},g=async b=>{b.preventDefault(),u(!0),console.log("Login: Starting login process...",{email:a,role:w});try{const A=await h(a,s,w);console.log("Login: Sign in result:",A),A&&!A.error?(console.log("Login: Sign in successful"),w==="attendant"?(console.log("Login: Manually navigating to dashboard for attendant"),u(!1),v("/dashboard",{replace:!0})):(console.log("Login: Navigation will be handled by useEffect"),setTimeout(()=>{console.log("Login: Timeout reached, resetting loading state"),u(!1)},3e3))):(console.log("Login: Sign in failed:",A?.error),u(!1))}catch(A){console.error("Login: Unexpected error during sign in:",A),u(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 via-purple-900/80 to-pink-900/90"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-purple-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_left,_var(--tw-gradient-stops))] from-indigo-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-pink-600/10 via-transparent to-transparent"}),e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-gradient-to-r from-indigo-500/20 to-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-full blur-3xl animate-pulse delay-500"}),e.jsxs("div",{className:"max-w-6xl w-full grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center relative z-10",children:[e.jsxs("div",{className:"text-white space-y-6 sm:space-y-8 text-center lg:text-left relative z-10",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center lg:justify-start space-x-2 sm:space-x-3",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-r from-purple-500 via-indigo-500 to-blue-500 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-xl sm:text-2xl",children:"CAR"})}),e.jsx("h1",{className:"text-4xl sm:text-5xl font-bold bg-gradient-to-r from-purple-300 via-indigo-300 to-blue-300 bg-clip-text text-transparent",children:"ParkFlow"})]}),e.jsx("p",{className:"text-lg sm:text-xl text-white/80 font-light",children:"Smart Parking Management Made Easy"})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center lg:justify-start space-x-2 sm:space-x-3 text-white/90",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs sm:text-sm",children:""})}),e.jsx("span",{className:"text-base sm:text-lg",children:"Real-time Parking Analytics"})]}),e.jsxs("div",{className:"flex items-center justify-center lg:justify-start space-x-2 sm:space-x-3 text-white/90",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs sm:text-sm",children:""})}),e.jsx("span",{className:"text-base sm:text-lg",children:"Secure Role-based Access"})]}),e.jsxs("div",{className:"flex items-center justify-center lg:justify-start space-x-2 sm:space-x-3 text-white/90",children:[e.jsx("div",{className:"w-5 h-5 sm:w-6 sm:h-6 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xs sm:text-sm",children:""})}),e.jsx("span",{className:"text-base sm:text-lg",children:"Scalable Multi-location Management"})]})]})]}),e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsxs(_e,{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 p-4 sm:p-6 text-white relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/80 via-indigo-600/80 to-blue-600/80"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold",children:w?`${w==="contractor"?"Contractor":"Attendant"} Login`:"Sign In"}),e.jsx("p",{className:"text-purple-100 text-xs sm:text-sm mt-1",children:w?`Enter your credentials to access the ${w} dashboard`:"Enter your credentials to access your dashboard"})]})})]}),e.jsxs(Ee,{className:"p-6 sm:p-8 bg-white/5 backdrop-blur-sm",children:[m&&e.jsx("div",{className:"mb-4 sm:mb-6 p-3 sm:p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-xs sm:text-sm font-medium text-blue-900 truncate",children:["Active Session: ",m.email]}),e.jsxs("p",{className:"text-xs text-blue-700",children:["Role: ",p?.role||"Unknown"," | Status: ",p?.status||"Unknown"]})]}),e.jsx(F,{variant:"ghost",size:"sm",onClick:N,className:"text-blue-600 hover:text-blue-700 flex-shrink-0 ml-2",children:e.jsx(kc,{className:"h-4 w-4"})})]})}),e.jsxs("form",{onSubmit:g,className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",className:"text-white font-medium text-sm sm:text-base",children:"Email"}),e.jsx(ge,{id:"email",type:"email",placeholder:"Enter your email",value:a,onChange:b=>t(b.target.value),required:!0,className:"h-10 sm:h-12 bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",className:"text-white font-medium text-sm sm:text-base",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"password",type:n?"text":"password",placeholder:"Enter your password",value:s,onChange:b=>r(b.target.value),required:!0,className:"h-10 sm:h-12 bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm pr-12"}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 text-white/60 hover:text-white hover:bg-white/10",onClick:()=>o(!n),children:n?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fn,{id:"remember",checked:i,onCheckedChange:b=>c(b),className:"border-white/30 data-[state=checked]:bg-purple-500 data-[state=checked]:border-purple-500"}),e.jsx(te,{htmlFor:"remember",className:"text-xs sm:text-sm text-white/80",children:"Remember me"})]}),e.jsx(F,{type:"submit",className:"w-full h-10 sm:h-12 bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 hover:from-purple-700 hover:via-indigo-700 hover:to-blue-700 text-white font-semibold rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]",disabled:d,children:d?"Signing in...":"Sign In"}),e.jsxs("div",{className:"text-center space-y-2 sm:space-y-3",children:[e.jsxs(F,{variant:"ghost",onClick:()=>v("/"),className:"text-xs sm:text-sm text-white/70 hover:text-white hover:bg-white/10",children:[e.jsx(ca,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Back to Role Selection"]}),e.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[e.jsx(ss,{to:"/forgot-password",className:"text-xs sm:text-sm text-purple-300 hover:text-purple-200 hover:underline block",children:"Forgot your password?"}),e.jsx(ss,{to:"/register",className:"text-xs sm:text-sm text-white/70 hover:text-white hover:underline block",children:"Need an account? Request Access"})]}),e.jsxs("p",{className:"text-xs text-white/60 leading-relaxed pt-1 sm:pt-2",children:["By clicking continue, you agree to our"," ",e.jsx(ss,{to:"/terms-of-service",className:"text-purple-300 hover:text-purple-200 underline",children:"Terms of Service"})," ","and"," ",e.jsx(ss,{to:"/privacy-policy",className:"text-purple-300 hover:text-purple-200 underline",children:"Privacy Policy"}),"."]})]})]})]})]})})]})]})}function ix(){const[a,t]=l.useState(""),[s,r]=l.useState(""),[n,o]=l.useState(!1),[i,c]=l.useState(!1),{signIn:d,user:u,profile:h}=ft(),m=Kt();l.useEffect(()=>{console.log("SuperAdminLogin: useEffect triggered",{user:!!u,profile:!!h,profileRole:h?.role}),u&&h?(console.log("SuperAdminLogin: User authenticated, role:",h.role),h.role==="super_admin"?(console.log("SuperAdminLogin: Redirecting to dashboard"),m("/dashboard")):(console.log("SuperAdminLogin: User is not super admin, redirecting to role selection"),m("/"))):console.log("SuperAdminLogin: No user or profile, staying on login page")},[u,h,m]);const p=async f=>{f.preventDefault(),c(!0),await d(a,s,"super_admin"),c(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 via-purple-900/80 to-pink-900/90"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-purple-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_left,_var(--tw-gradient-stops))] from-indigo-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-pink-600/10 via-transparent to-transparent"}),e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-gradient-to-r from-indigo-500/20 to-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-full blur-3xl animate-pulse delay-500"}),e.jsx("div",{className:"w-full max-w-md relative z-10",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-indigo-600 to-pink-600 p-6 text-white text-center relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/80 via-indigo-600/80 to-pink-600/80"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-xl",children:""})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Super Admin Login"})]}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Enter your credentials to access the admin dashboard"})]})]}),e.jsx("div",{className:"p-8 bg-white/5 backdrop-blur-sm",children:e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",className:"text-white font-medium",children:"Email"}),e.jsx(ge,{id:"email",type:"email",placeholder:"admin@parkflow.com",value:a,onChange:f=>t(f.target.value),required:!0,className:"h-12 bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",className:"text-white font-medium",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"password",type:n?"text":"password",placeholder:"Enter your password",value:s,onChange:f=>r(f.target.value),required:!0,className:"h-12 bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm pr-12"}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 text-white/60 hover:text-white hover:bg-white/10",onClick:()=>o(!n),children:n?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsx(F,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-purple-600 via-indigo-600 to-pink-600 hover:from-purple-700 hover:via-indigo-700 hover:to-pink-700 text-white font-semibold rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]",disabled:i,children:i?"Signing in...":"Sign In"}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(ss,{to:"/forgot-password",className:"text-sm text-purple-300 hover:text-purple-200 hover:underline block",children:"Forgot your password?"}),e.jsx(ss,{to:"/",className:"text-sm text-white/70 hover:text-white hover:underline block",children:"Return to Role Selection"}),e.jsxs("p",{className:"text-xs text-white/60 leading-relaxed pt-2",children:["By clicking continue, you agree to our"," ",e.jsx(ss,{to:"/terms-of-service",className:"text-purple-300 hover:text-purple-200 underline",children:"Terms of Service"})," ","and"," ",e.jsx(ss,{to:"/privacy-policy",className:"text-purple-300 hover:text-purple-200 underline",children:"Privacy Policy"}),"."]})]})]})})]})})]})}function Po(a,[t,s]){return Math.min(s,Math.max(t,a))}var lx=[" ","Enter","ArrowUp","ArrowDown"],cx=[" ","Enter"],Oa="Select",[qn,Wn,dx]=um(Oa),[hr,Sb]=Rs(Oa,[dx,ur]),Yn=ur(),[ux,xa]=hr(Oa),[hx,mx]=hr(Oa),gd=a=>{const{__scopeSelect:t,children:s,open:r,defaultOpen:n,onOpenChange:o,value:i,defaultValue:c,onValueChange:d,dir:u,name:h,autoComplete:m,disabled:p,required:f,form:v}=a,y=Yn(t),[w,N]=l.useState(null),[g,b]=l.useState(null),[A,P]=l.useState(!1),E=An(u),[V,M]=Ia({prop:r,defaultProp:n??!1,onChange:o,caller:Oa}),[O,I]=Ia({prop:i,defaultProp:c,onChange:d,caller:Oa}),ee=l.useRef(null),G=w?v||!!w.closest("form"):!0,[ae,$]=l.useState(new Set),Y=Array.from(ae).map(Z=>Z.props.value).join(";");return e.jsx(Go,{...y,children:e.jsxs(ux,{required:f,scope:t,trigger:w,onTriggerChange:N,valueNode:g,onValueNodeChange:b,valueNodeHasChildren:A,onValueNodeHasChildrenChange:P,contentId:as(),value:O,onValueChange:I,open:V,onOpenChange:M,dir:E,triggerPointerDownPosRef:ee,disabled:p,children:[e.jsx(qn.Provider,{scope:t,children:e.jsx(hx,{scope:a.__scopeSelect,onNativeOptionAdd:l.useCallback(Z=>{$(_=>new Set(_).add(Z))},[]),onNativeOptionRemove:l.useCallback(Z=>{$(_=>{const L=new Set(_);return L.delete(Z),L})},[]),children:s})}),G?e.jsxs(Ud,{"aria-hidden":!0,required:f,tabIndex:-1,name:h,autoComplete:m,value:O,onChange:Z=>I(Z.target.value),disabled:p,form:v,children:[O===void 0?e.jsx("option",{value:""}):null,Array.from(ae)]},Y):null]})})};gd.displayName=Oa;var vd="SelectTrigger",yd=l.forwardRef((a,t)=>{const{__scopeSelect:s,disabled:r=!1,...n}=a,o=Yn(s),i=xa(vd,s),c=i.disabled||r,d=rt(t,i.onTriggerChange),u=Wn(s),h=l.useRef("touch"),[m,p,f]=Bd(y=>{const w=u().filter(b=>!b.disabled),N=w.find(b=>b.value===i.value),g=Hd(w,y,N);g!==void 0&&i.onValueChange(g.value)}),v=y=>{c||(i.onOpenChange(!0),f()),y&&(i.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return e.jsx(Pn,{asChild:!0,...o,children:e.jsx(De.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":zd(i.value)?"":void 0,...n,ref:d,onClick:Oe(n.onClick,y=>{y.currentTarget.focus(),h.current!=="mouse"&&v(y)}),onPointerDown:Oe(n.onPointerDown,y=>{h.current=y.pointerType;const w=y.target;w.hasPointerCapture(y.pointerId)&&w.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(v(y),y.preventDefault())}),onKeyDown:Oe(n.onKeyDown,y=>{const w=m.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&p(y.key),!(w&&y.key===" ")&&lx.includes(y.key)&&(v(),y.preventDefault())})})})});yd.displayName=vd;var bd="SelectValue",wd=l.forwardRef((a,t)=>{const{__scopeSelect:s,className:r,style:n,children:o,placeholder:i="",...c}=a,d=xa(bd,s),{onValueNodeHasChildrenChange:u}=d,h=o!==void 0,m=rt(t,d.onValueNodeChange);return ns(()=>{u(h)},[u,h]),e.jsx(De.span,{...c,ref:m,style:{pointerEvents:"none"},children:zd(d.value)?e.jsx(e.Fragment,{children:i}):o})});wd.displayName=bd;var px="SelectIcon",jd=l.forwardRef((a,t)=>{const{__scopeSelect:s,children:r,...n}=a;return e.jsx(De.span,{"aria-hidden":!0,...n,ref:t,children:r||""})});jd.displayName=px;var fx="SelectPortal",Nd=a=>e.jsx(xc,{asChild:!0,...a});Nd.displayName=fx;var La="SelectContent",_d=l.forwardRef((a,t)=>{const s=xa(La,a.__scopeSelect),[r,n]=l.useState();if(ns(()=>{n(new DocumentFragment)},[]),!s.open){const o=r;return o?ei.createPortal(e.jsx(Sd,{scope:a.__scopeSelect,children:e.jsx(qn.Slot,{scope:a.__scopeSelect,children:e.jsx("div",{children:a.children})})}),o):null}return e.jsx(kd,{...a,ref:t})});_d.displayName=La;var ds=10,[Sd,ga]=hr(La),xx="SelectContentImpl",gx=gc("SelectContent.RemoveScroll"),kd=l.forwardRef((a,t)=>{const{__scopeSelect:s,position:r="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:o,onPointerDownOutside:i,side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:m,collisionBoundary:p,collisionPadding:f,sticky:v,hideWhenDetached:y,avoidCollisions:w,...N}=a,g=xa(La,s),[b,A]=l.useState(null),[P,E]=l.useState(null),V=rt(t,Q=>A(Q)),[M,O]=l.useState(null),[I,ee]=l.useState(null),G=Wn(s),[ae,$]=l.useState(!1),Y=l.useRef(!1);l.useEffect(()=>{if(b)return hc(b)},[b]),mc();const Z=l.useCallback(Q=>{const[z,...D]=G().map(oe=>oe.ref.current),[X]=D.slice(-1),B=document.activeElement;for(const oe of Q)if(oe===B||(oe?.scrollIntoView({block:"nearest"}),oe===z&&P&&(P.scrollTop=0),oe===X&&P&&(P.scrollTop=P.scrollHeight),oe?.focus(),document.activeElement!==B))return},[G,P]),_=l.useCallback(()=>Z([M,b]),[Z,M,b]);l.useEffect(()=>{ae&&_()},[ae,_]);const{onOpenChange:L,triggerPointerDownPosRef:C}=g;l.useEffect(()=>{if(b){let Q={x:0,y:0};const z=X=>{Q={x:Math.abs(Math.round(X.pageX)-(C.current?.x??0)),y:Math.abs(Math.round(X.pageY)-(C.current?.y??0))}},D=X=>{Q.x<=10&&Q.y<=10?X.preventDefault():b.contains(X.target)||L(!1),document.removeEventListener("pointermove",z),C.current=null};return C.current!==null&&(document.addEventListener("pointermove",z),document.addEventListener("pointerup",D,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",z),document.removeEventListener("pointerup",D,{capture:!0})}}},[b,L,C]),l.useEffect(()=>{const Q=()=>L(!1);return window.addEventListener("blur",Q),window.addEventListener("resize",Q),()=>{window.removeEventListener("blur",Q),window.removeEventListener("resize",Q)}},[L]);const[T,H]=Bd(Q=>{const z=G().filter(B=>!B.disabled),D=z.find(B=>B.ref.current===document.activeElement),X=Hd(z,Q,D);X&&setTimeout(()=>X.ref.current.focus())}),x=l.useCallback((Q,z,D)=>{const X=!Y.current&&!D;(g.value!==void 0&&g.value===z||X)&&(O(Q),X&&(Y.current=!0))},[g.value]),S=l.useCallback(()=>b?.focus(),[b]),q=l.useCallback((Q,z,D)=>{const X=!Y.current&&!D;(g.value!==void 0&&g.value===z||X)&&ee(Q)},[g.value]),U=r==="popper"?Ao:Cd,de=U===Ao?{side:c,sideOffset:d,align:u,alignOffset:h,arrowPadding:m,collisionBoundary:p,collisionPadding:f,sticky:v,hideWhenDetached:y,avoidCollisions:w}:{};return e.jsx(Sd,{scope:s,content:b,viewport:P,onViewportChange:E,itemRefCallback:x,selectedItem:M,onItemLeave:S,itemTextRefCallback:q,focusSelectedItem:_,selectedItemText:I,position:r,isPositioned:ae,searchRef:T,children:e.jsx(pc,{as:gx,allowPinchZoom:!0,children:e.jsx(fc,{asChild:!0,trapped:g.open,onMountAutoFocus:Q=>{Q.preventDefault()},onUnmountAutoFocus:Oe(n,Q=>{g.trigger?.focus({preventScroll:!0}),Q.preventDefault()}),children:e.jsx(qo,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:Q=>Q.preventDefault(),onDismiss:()=>g.onOpenChange(!1),children:e.jsx(U,{role:"listbox",id:g.contentId,"data-state":g.open?"open":"closed",dir:g.dir,onContextMenu:Q=>Q.preventDefault(),...N,...de,onPlaced:()=>$(!0),ref:V,style:{display:"flex",flexDirection:"column",outline:"none",...N.style},onKeyDown:Oe(N.onKeyDown,Q=>{const z=Q.ctrlKey||Q.altKey||Q.metaKey;if(Q.key==="Tab"&&Q.preventDefault(),!z&&Q.key.length===1&&H(Q.key),["ArrowUp","ArrowDown","Home","End"].includes(Q.key)){let X=G().filter(B=>!B.disabled).map(B=>B.ref.current);if(["ArrowUp","End"].includes(Q.key)&&(X=X.slice().reverse()),["ArrowUp","ArrowDown"].includes(Q.key)){const B=Q.target,oe=X.indexOf(B);X=X.slice(oe+1)}setTimeout(()=>Z(X)),Q.preventDefault()}})})})})})})});kd.displayName=xx;var vx="SelectItemAlignedPosition",Cd=l.forwardRef((a,t)=>{const{__scopeSelect:s,onPlaced:r,...n}=a,o=xa(La,s),i=ga(La,s),[c,d]=l.useState(null),[u,h]=l.useState(null),m=rt(t,V=>h(V)),p=Wn(s),f=l.useRef(!1),v=l.useRef(!0),{viewport:y,selectedItem:w,selectedItemText:N,focusSelectedItem:g}=i,b=l.useCallback(()=>{if(o.trigger&&o.valueNode&&c&&u&&y&&w&&N){const V=o.trigger.getBoundingClientRect(),M=u.getBoundingClientRect(),O=o.valueNode.getBoundingClientRect(),I=N.getBoundingClientRect();if(o.dir!=="rtl"){const B=I.left-M.left,oe=O.left-B,Ae=V.left-oe,Ce=V.width+Ae,Ie=Math.max(Ce,M.width),K=window.innerWidth-ds,Ne=Po(oe,[ds,Math.max(ds,K-Ie)]);c.style.minWidth=Ce+"px",c.style.left=Ne+"px"}else{const B=M.right-I.right,oe=window.innerWidth-O.right-B,Ae=window.innerWidth-V.right-oe,Ce=V.width+Ae,Ie=Math.max(Ce,M.width),K=window.innerWidth-ds,Ne=Po(oe,[ds,Math.max(ds,K-Ie)]);c.style.minWidth=Ce+"px",c.style.right=Ne+"px"}const ee=p(),G=window.innerHeight-ds*2,ae=y.scrollHeight,$=window.getComputedStyle(u),Y=parseInt($.borderTopWidth,10),Z=parseInt($.paddingTop,10),_=parseInt($.borderBottomWidth,10),L=parseInt($.paddingBottom,10),C=Y+Z+ae+L+_,T=Math.min(w.offsetHeight*5,C),H=window.getComputedStyle(y),x=parseInt(H.paddingTop,10),S=parseInt(H.paddingBottom,10),q=V.top+V.height/2-ds,U=G-q,de=w.offsetHeight/2,Q=w.offsetTop+de,z=Y+Z+Q,D=C-z;if(z<=q){const B=ee.length>0&&w===ee[ee.length-1].ref.current;c.style.bottom="0px";const oe=u.clientHeight-y.offsetTop-y.offsetHeight,Ae=Math.max(U,de+(B?S:0)+oe+_),Ce=z+Ae;c.style.height=Ce+"px"}else{const B=ee.length>0&&w===ee[0].ref.current;c.style.top="0px";const Ae=Math.max(q,Y+y.offsetTop+(B?x:0)+de)+D;c.style.height=Ae+"px",y.scrollTop=z-q+y.offsetTop}c.style.margin=`${ds}px 0`,c.style.minHeight=T+"px",c.style.maxHeight=G+"px",r?.(),requestAnimationFrame(()=>f.current=!0)}},[p,o.trigger,o.valueNode,c,u,y,w,N,o.dir,r]);ns(()=>b(),[b]);const[A,P]=l.useState();ns(()=>{u&&P(window.getComputedStyle(u).zIndex)},[u]);const E=l.useCallback(V=>{V&&v.current===!0&&(b(),g?.(),v.current=!1)},[b,g]);return e.jsx(bx,{scope:s,contentWrapper:c,shouldExpandOnScrollRef:f,onScrollButtonChange:E,children:e.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:A},children:e.jsx(De.div,{...n,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});Cd.displayName=vx;var yx="SelectPopperPosition",Ao=l.forwardRef((a,t)=>{const{__scopeSelect:s,align:r="start",collisionPadding:n=ds,...o}=a,i=Yn(s);return e.jsx(Wo,{...i,...o,ref:t,align:r,collisionPadding:n,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ao.displayName=yx;var[bx,yi]=hr(La,{}),Eo="SelectViewport",Pd=l.forwardRef((a,t)=>{const{__scopeSelect:s,nonce:r,...n}=a,o=ga(Eo,s),i=yi(Eo,s),c=rt(t,o.onViewportChange),d=l.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),e.jsx(qn.Slot,{scope:s,children:e.jsx(De.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:Oe(n.onScroll,u=>{const h=u.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:p}=i;if(p?.current&&m){const f=Math.abs(d.current-h.scrollTop);if(f>0){const v=window.innerHeight-ds*2,y=parseFloat(m.style.minHeight),w=parseFloat(m.style.height),N=Math.max(y,w);if(N<v){const g=N+f,b=Math.min(v,g),A=g-b;m.style.height=b+"px",m.style.bottom==="0px"&&(h.scrollTop=A>0?A:0,m.style.justifyContent="flex-end")}}}d.current=h.scrollTop})})})]})});Pd.displayName=Eo;var Ad="SelectGroup",[wx,jx]=hr(Ad),Nx=l.forwardRef((a,t)=>{const{__scopeSelect:s,...r}=a,n=as();return e.jsx(wx,{scope:s,id:n,children:e.jsx(De.div,{role:"group","aria-labelledby":n,...r,ref:t})})});Nx.displayName=Ad;var Ed="SelectLabel",Rd=l.forwardRef((a,t)=>{const{__scopeSelect:s,...r}=a,n=jx(Ed,s);return e.jsx(De.div,{id:n.id,...r,ref:t})});Rd.displayName=Ed;var xn="SelectItem",[_x,Td]=hr(xn),Dd=l.forwardRef((a,t)=>{const{__scopeSelect:s,value:r,disabled:n=!1,textValue:o,...i}=a,c=xa(xn,s),d=ga(xn,s),u=c.value===r,[h,m]=l.useState(o??""),[p,f]=l.useState(!1),v=rt(t,g=>d.itemRefCallback?.(g,r,n)),y=as(),w=l.useRef("touch"),N=()=>{n||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(_x,{scope:s,value:r,disabled:n,textId:y,isSelected:u,onItemTextChange:l.useCallback(g=>{m(b=>b||(g?.textContent??"").trim())},[]),children:e.jsx(qn.ItemSlot,{scope:s,value:r,disabled:n,textValue:h,children:e.jsx(De.div,{role:"option","aria-labelledby":y,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...i,ref:v,onFocus:Oe(i.onFocus,()=>f(!0)),onBlur:Oe(i.onBlur,()=>f(!1)),onClick:Oe(i.onClick,()=>{w.current!=="mouse"&&N()}),onPointerUp:Oe(i.onPointerUp,()=>{w.current==="mouse"&&N()}),onPointerDown:Oe(i.onPointerDown,g=>{w.current=g.pointerType}),onPointerMove:Oe(i.onPointerMove,g=>{w.current=g.pointerType,n?d.onItemLeave?.():w.current==="mouse"&&g.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Oe(i.onPointerLeave,g=>{g.currentTarget===document.activeElement&&d.onItemLeave?.()}),onKeyDown:Oe(i.onKeyDown,g=>{d.searchRef?.current!==""&&g.key===" "||(cx.includes(g.key)&&N(),g.key===" "&&g.preventDefault())})})})})});Dd.displayName=xn;var gr="SelectItemText",Id=l.forwardRef((a,t)=>{const{__scopeSelect:s,className:r,style:n,...o}=a,i=xa(gr,s),c=ga(gr,s),d=Td(gr,s),u=mx(gr,s),[h,m]=l.useState(null),p=rt(t,N=>m(N),d.onItemTextChange,N=>c.itemTextRefCallback?.(N,d.value,d.disabled)),f=h?.textContent,v=l.useMemo(()=>e.jsx("option",{value:d.value,disabled:d.disabled,children:f},d.value),[d.disabled,d.value,f]),{onNativeOptionAdd:y,onNativeOptionRemove:w}=u;return ns(()=>(y(v),()=>w(v)),[y,w,v]),e.jsxs(e.Fragment,{children:[e.jsx(De.span,{id:d.textId,...o,ref:p}),d.isSelected&&i.valueNode&&!i.valueNodeHasChildren?ei.createPortal(o.children,i.valueNode):null]})});Id.displayName=gr;var Od="SelectItemIndicator",Ld=l.forwardRef((a,t)=>{const{__scopeSelect:s,...r}=a;return Td(Od,s).isSelected?e.jsx(De.span,{"aria-hidden":!0,...r,ref:t}):null});Ld.displayName=Od;var Ro="SelectScrollUpButton",Md=l.forwardRef((a,t)=>{const s=ga(Ro,a.__scopeSelect),r=yi(Ro,a.__scopeSelect),[n,o]=l.useState(!1),i=rt(t,r.onScrollButtonChange);return ns(()=>{if(s.viewport&&s.isPositioned){let c=function(){const u=d.scrollTop>0;o(u)};const d=s.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[s.viewport,s.isPositioned]),n?e.jsx($d,{...a,ref:i,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=s;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});Md.displayName=Ro;var To="SelectScrollDownButton",Fd=l.forwardRef((a,t)=>{const s=ga(To,a.__scopeSelect),r=yi(To,a.__scopeSelect),[n,o]=l.useState(!1),i=rt(t,r.onScrollButtonChange);return ns(()=>{if(s.viewport&&s.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,h=Math.ceil(d.scrollTop)<u;o(h)};const d=s.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[s.viewport,s.isPositioned]),n?e.jsx($d,{...a,ref:i,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=s;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});Fd.displayName=To;var $d=l.forwardRef((a,t)=>{const{__scopeSelect:s,onAutoScroll:r,...n}=a,o=ga("SelectScrollButton",s),i=l.useRef(null),c=Wn(s),d=l.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return l.useEffect(()=>()=>d(),[d]),ns(()=>{c().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[c]),e.jsx(De.div,{"aria-hidden":!0,...n,ref:t,style:{flexShrink:0,...n.style},onPointerDown:Oe(n.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(r,50))}),onPointerMove:Oe(n.onPointerMove,()=>{o.onItemLeave?.(),i.current===null&&(i.current=window.setInterval(r,50))}),onPointerLeave:Oe(n.onPointerLeave,()=>{d()})})}),Sx="SelectSeparator",Vd=l.forwardRef((a,t)=>{const{__scopeSelect:s,...r}=a;return e.jsx(De.div,{"aria-hidden":!0,...r,ref:t})});Vd.displayName=Sx;var Do="SelectArrow",kx=l.forwardRef((a,t)=>{const{__scopeSelect:s,...r}=a,n=Yn(s),o=xa(Do,s),i=ga(Do,s);return o.open&&i.position==="popper"?e.jsx(Yo,{...n,...r,ref:t}):null});kx.displayName=Do;var Cx="SelectBubbleInput",Ud=l.forwardRef(({__scopeSelect:a,value:t,...s},r)=>{const n=l.useRef(null),o=rt(r,n),i=xi(t);return l.useEffect(()=>{const c=n.current;if(!c)return;const d=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(d,"value").set;if(i!==t&&h){const m=new Event("change",{bubbles:!0});h.call(c,t),c.dispatchEvent(m)}},[i,t]),e.jsx(De.select,{...s,style:{...hm,...s.style},ref:o,defaultValue:t})});Ud.displayName=Cx;function zd(a){return a===""||a===void 0}function Bd(a){const t=$s(a),s=l.useRef(""),r=l.useRef(0),n=l.useCallback(i=>{const c=s.current+i;t(c),function d(u){s.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>d(""),1e3))}(c)},[t]),o=l.useCallback(()=>{s.current="",window.clearTimeout(r.current)},[]);return l.useEffect(()=>()=>window.clearTimeout(r.current),[]),[s,n,o]}function Hd(a,t,s){const n=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,o=s?a.indexOf(s):-1;let i=Px(a,Math.max(o,0));n.length===1&&(i=i.filter(u=>u!==s));const d=i.find(u=>u.textValue.toLowerCase().startsWith(n.toLowerCase()));return d!==s?d:void 0}function Px(a,t){return a.map((s,r)=>a[(t+r)%a.length])}var Ax=gd,qd=yd,Ex=wd,Rx=jd,Tx=Nd,Wd=_d,Dx=Pd,Yd=Rd,Gd=Dd,Ix=Id,Ox=Ld,Zd=Md,Kd=Fd,Qd=Vd;const Lt=Ax,Mt=Ex,Ct=l.forwardRef(({className:a,children:t,...s},r)=>e.jsxs(qd,{ref:r,className:ce("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[t,e.jsx(Rx,{asChild:!0,children:e.jsx(_c,{className:"h-4 w-4 opacity-50"})})]}));Ct.displayName=qd.displayName;const Jd=l.forwardRef(({className:a,...t},s)=>e.jsx(Zd,{ref:s,className:ce("flex cursor-default items-center justify-center py-1",a),...t,children:e.jsx(Tm,{className:"h-4 w-4"})}));Jd.displayName=Zd.displayName;const Xd=l.forwardRef(({className:a,...t},s)=>e.jsx(Kd,{ref:s,className:ce("flex cursor-default items-center justify-center py-1",a),...t,children:e.jsx(_c,{className:"h-4 w-4"})}));Xd.displayName=Kd.displayName;const Pt=l.forwardRef(({className:a,children:t,position:s="popper",...r},n)=>e.jsx(Tx,{children:e.jsxs(Wd,{ref:n,className:ce("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...r,children:[e.jsx(Jd,{}),e.jsx(Dx,{className:ce("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Xd,{})]})}));Pt.displayName=Wd.displayName;const Lx=l.forwardRef(({className:a,...t},s)=>e.jsx(Yd,{ref:s,className:ce("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...t}));Lx.displayName=Yd.displayName;const $e=l.forwardRef(({className:a,children:t,...s},r)=>e.jsxs(Gd,{ref:r,className:ce("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",a),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Ox,{children:e.jsx(In,{className:"h-4 w-4"})})}),e.jsx(Ix,{children:t})]}));$e.displayName=Gd.displayName;const Mx=l.forwardRef(({className:a,...t},s)=>e.jsx(Qd,{ref:s,className:ce("-mx-1 my-1 h-px bg-muted",a),...t}));Mx.displayName=Qd.displayName;function Fx(){const[a,t]=l.useState({user_name:"",email:"",password:"",confirmPassword:"",phone_number:"",role:"",contractor_name:"",attendant_name:""}),[s,r]=l.useState(!1),[n,o]=l.useState(!1),[i,c]=l.useState(!1),{signUp:d}=ft(),u=Kt(),h=(p,f)=>{t(v=>({...v,[p]:f}))},m=async p=>{if(p.preventDefault(),a.password!==a.confirmPassword){alert("Passwords don't match!");return}if(!a.role){alert("Please select a role!");return}c(!0);const f={user_name:a.user_name,email:a.email,phone_number:a.phone_number,role:a.role,contractor_name:a.role==="contractor"?a.contractor_name:void 0,attendant_name:a.role==="attendant"?a.attendant_name:void 0},v=await d(a.email,a.password,f);v.success?u("/login"):console.error("Signup failed:",v.error),c(!1)};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 via-purple-900/80 to-pink-900/90"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-purple-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_left,_var(--tw-gradient-stops))] from-indigo-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-pink-600/10 via-transparent to-transparent"}),e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-gradient-to-r from-indigo-500/20 to-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-full blur-3xl animate-pulse delay-500"}),e.jsxs("div",{className:"w-full max-w-md sm:max-w-lg space-y-4 sm:space-y-6 relative z-10",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-r from-emerald-400 to-emerald-500 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(ni,{className:"h-4 w-4 sm:h-5 sm:w-5 text-white"})}),e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-gradient-to-r from-blue-400 to-blue-500 rounded-lg flex items-center justify-center shadow-lg",children:e.jsx(ot,{className:"h-4 w-4 sm:h-5 sm:w-5 text-white"})})]}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-purple-300 via-indigo-300 to-blue-300 bg-clip-text text-transparent",children:"ParkFlow"}),e.jsx("p",{className:"text-emerald-300 font-medium mt-1 sm:mt-2 text-sm sm:text-base",children:"Request Access"}),e.jsx("p",{className:"text-white/80 text-xs sm:text-sm px-4",children:"Create an account to join the parking management system"})]}),e.jsxs(_e,{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs(ze,{className:"pb-4 sm:pb-6 bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 text-white relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/80 via-indigo-600/80 to-blue-600/80"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(Be,{className:"text-lg sm:text-xl",children:"Create Account"}),e.jsx(et,{className:"text-purple-100 text-sm",children:"Fill in your details to request system access"})]})]}),e.jsx(Ee,{className:"px-4 sm:px-6 pb-4 sm:pb-6 bg-white/5 backdrop-blur-sm",children:e.jsxs("form",{onSubmit:m,className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"role",className:"text-white font-medium",children:"Role *"}),e.jsxs(Lt,{value:a.role,onValueChange:p=>h("role",p),children:[e.jsx(Ct,{className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm",children:e.jsx(Mt,{placeholder:"Select your role"})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"contractor",children:"Contractor"}),e.jsx($e,{value:"attendant",children:"Attendant"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"user_name",className:"text-white font-medium",children:"Full Name *"}),e.jsx(ge,{id:"user_name",placeholder:"Enter your full name",value:a.user_name,onChange:p=>h("user_name",p.target.value),required:!0,className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),a.role==="contractor"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"contractor_name",className:"text-white font-medium",children:"Company/Business Name"}),e.jsx(ge,{id:"contractor_name",placeholder:"Enter your company name",value:a.contractor_name,onChange:p=>h("contractor_name",p.target.value),className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),a.role==="attendant"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"attendant_name",className:"text-white font-medium",children:"Display Name"}),e.jsx(ge,{id:"attendant_name",placeholder:"Enter your display name",value:a.attendant_name,onChange:p=>h("attendant_name",p.target.value),className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",className:"text-white font-medium",children:"Email *"}),e.jsx(ge,{id:"email",type:"email",placeholder:"Enter your email",value:a.email,onChange:p=>h("email",p.target.value),required:!0,className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"phone_number",className:"text-white font-medium",children:"Phone Number"}),e.jsx(ge,{id:"phone_number",type:"tel",placeholder:"Enter your phone number",value:a.phone_number,onChange:p=>h("phone_number",p.target.value),className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",className:"text-white font-medium",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"password",type:s?"text":"password",placeholder:"Create a password",value:a.password,onChange:p=>h("password",p.target.value),required:!0,className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm pr-12"}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6 text-white/60 hover:text-white hover:bg-white/10",onClick:()=>r(!s),children:s?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"confirmPassword",className:"text-white font-medium",children:"Confirm Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"confirmPassword",type:n?"text":"password",placeholder:"Confirm your password",value:a.confirmPassword,onChange:p=>h("confirmPassword",p.target.value),required:!0,className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm pr-12"}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6 text-white/60 hover:text-white hover:bg-white/10",onClick:()=>o(!n),children:n?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsx(F,{type:"submit",className:"w-full bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 hover:from-purple-700 hover:via-indigo-700 hover:to-blue-700 text-white font-semibold rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]",disabled:i,children:i?"Creating Account...":"Request Access"}),e.jsxs("div",{className:"bg-blue-500/20 border border-blue-400/30 p-3 rounded-lg backdrop-blur-sm",children:[e.jsx("p",{className:"text-xs text-blue-200 font-medium text-center",children:" Account Activation Required"}),e.jsx("p",{className:"text-xs text-white/80 mt-1 text-center",children:"Your account will need to be activated by an administrator before you can sign in"})]}),e.jsx("div",{className:"text-center",children:e.jsx(ss,{to:"/login",className:"text-sm text-white/70 hover:text-white hover:underline",children:"Already have an account? Sign in"})})]})})]})]})]})}function $x(){const[a,t]=l.useState(""),[s,r]=l.useState(!1),[n,o]=l.useState(!1),{resetPassword:i}=ft(),c=Kt(),d=async u=>{u.preventDefault(),r(!0);const{success:h}=await i(a);h&&o(!0),r(!1)};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-parkflow-red/10 via-background to-parkflow-blue/10 p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 mb-4",children:e.jsx(ot,{className:"h-10 w-10 text-parkflow-blue"})}),e.jsx("h1",{className:"text-3xl font-bold text-parkflow-blue",children:"ParkFlow"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mt-2",children:"Check Your Email"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"We've sent password reset instructions to your email"})]}),e.jsx(_e,{className:"shadow-lg",children:e.jsx(Ee,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Rt,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Email Sent Successfully!"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["We've sent password reset instructions to ",e.jsx("strong",{children:a})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Please check your email and follow the instructions to reset your password. If you don't see the email, check your spam folder."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(F,{onClick:()=>o(!1),variant:"outline",className:"w-full",children:[e.jsx(bo,{className:"h-4 w-4 mr-2"}),"Send Another Email"]}),e.jsxs(F,{onClick:()=>c("/login"),variant:"ghost",className:"w-full",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Back to Login"]})]})]})})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-parkflow-red/10 via-background to-parkflow-blue/10 p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 mb-4",children:e.jsx(ot,{className:"h-10 w-10 text-parkflow-blue"})}),e.jsx("h1",{className:"text-3xl font-bold text-parkflow-blue",children:"ParkFlow"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mt-2",children:"Forgot Password"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Enter your email address and we'll send you instructions to reset your password"})]}),e.jsxs(_e,{className:"shadow-lg",children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Reset Password"}),e.jsx(et,{children:"Enter your email address to receive password reset instructions"})]}),e.jsx(Ee,{children:e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",children:"Email Address"}),e.jsx(ge,{id:"email",type:"email",placeholder:"Enter your email address",value:a,onChange:u=>t(u.target.value),required:!0})]}),e.jsx(F,{type:"submit",className:"w-full",disabled:s,children:s?"Sending...":"Send Reset Instructions"}),e.jsx("div",{className:"text-center",children:e.jsxs(ss,{to:"/login",className:"text-sm text-muted-foreground hover:underline flex items-center justify-center",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Back to Login"]})})]})})]}),e.jsx(_e,{className:"bg-muted/50",children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-2 text-center",children:"Need Help?"}),e.jsxs("div",{className:"text-xs space-y-1 text-muted-foreground text-center",children:[e.jsx("p",{children:" Make sure you enter the email address associated with your account"}),e.jsx("p",{children:" Check your spam folder if you don't receive the email"}),e.jsx("p",{children:" Contact your administrator if you continue to have issues"})]})]})})]})})}function Vx(){const[a,t]=l.useState(""),[s,r]=l.useState(""),[n,o]=l.useState(!1),[i,c]=l.useState(!1),[d,u]=l.useState(!1),[h,m]=l.useState(!1),[p,f]=l.useState(""),v=Kt();l.useEffect(()=>{(async()=>{const{AuthAPI:N}=await Ye(async()=>{const{AuthAPI:b}=await Promise.resolve().then(()=>Bt);return{AuthAPI:b}},void 0);N.isAuthenticated()||f("No active session found. Please request a new password reset.")})()},[]);const y=async w=>{if(w.preventDefault(),u(!0),f(""),a!==s){f("Passwords do not match"),u(!1);return}if(a.length<6){f("Password must be at least 6 characters long"),u(!1);return}try{const{AuthAPI:N}=await Ye(async()=>{const{AuthAPI:P}=await Promise.resolve().then(()=>Bt);return{AuthAPI:P}},void 0),g=N.getUser();if(!g?.id)throw new Error("User not authenticated");const{apiClient:b}=await Ye(async()=>{const{apiClient:P}=await Promise.resolve().then(()=>ci);return{apiClient:P}},void 0),A=await b.post(`/profiles/updatePassword/${g.id}`,{newPassword:a});if(!A.success)throw new Error(A.message||"Failed to update password");m(!0)}catch(N){console.error("Password reset error:",N),f(N instanceof Error?N.message:"An error occurred while resetting your password")}finally{u(!1)}};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-parkflow-red/10 via-background to-parkflow-blue/10 p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 mb-4",children:e.jsx(ot,{className:"h-10 w-10 text-parkflow-blue"})}),e.jsx("h1",{className:"text-3xl font-bold text-parkflow-blue",children:"ParkFlow"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mt-2",children:"Password Reset Successful"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Your password has been updated successfully"})]}),e.jsx(_e,{className:"shadow-lg",children:e.jsx(Ee,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Rt,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"Password Updated!"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Your password has been successfully updated. You can now log in with your new password."})]}),e.jsxs(F,{onClick:()=>v("/login"),className:"w-full",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Go to Login"]})]})})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-parkflow-red/10 via-background to-parkflow-blue/10 p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center space-x-2 mb-4",children:e.jsx(ot,{className:"h-10 w-10 text-parkflow-blue"})}),e.jsx("h1",{className:"text-3xl font-bold text-parkflow-blue",children:"ParkFlow"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground mt-2",children:"Reset Password"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Enter your new password below"})]}),e.jsxs(_e,{className:"shadow-lg",children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Set New Password"}),e.jsx(et,{children:"Enter a strong password for your account"})]}),e.jsx(Ee,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[p&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-600",children:p})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"password",type:n?"text":"password",placeholder:"Enter your new password",value:a,onChange:w=>t(w.target.value),required:!0}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6",onClick:()=>o(!n),children:n?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"confirmPassword",type:i?"text":"password",placeholder:"Confirm your new password",value:s,onChange:w=>r(w.target.value),required:!0}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6",onClick:()=>c(!i),children:i?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsx(F,{type:"submit",className:"w-full",disabled:d,children:d?"Updating Password...":"Update Password"}),e.jsx("div",{className:"text-center",children:e.jsxs(F,{type:"button",variant:"ghost",onClick:()=>v("/login"),className:"text-sm text-muted-foreground hover:text-foreground",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Back to Login"]})})]})})]}),e.jsx(_e,{className:"bg-muted/50",children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("h3",{className:"font-medium mb-2 text-center",children:"Password Requirements"}),e.jsxs("div",{className:"text-xs space-y-1 text-muted-foreground text-center",children:[e.jsx("p",{children:" At least 6 characters long"}),e.jsx("p",{children:" Use a combination of letters, numbers, and symbols"}),e.jsx("p",{children:" Avoid using common passwords or personal information"})]})]})})]})})}const zt=(a,t)=>{if(!a)return"N/A";try{const s=new Date(a);if(isNaN(s.getTime()))return"N/A";const{includeTime:r=!1,includeSeconds:n=!1,format:o="short"}=t||{},i={day:"2-digit",month:"2-digit",year:"2-digit",timeZone:"Asia/Kolkata"};return r&&(i.hour="2-digit",i.minute="2-digit",i.hour12=!0),n&&(i.second="2-digit"),o==="medium"?i.month="short":o==="long"&&(i.month="long"),s.toLocaleDateString("en-IN",i)}catch(s){return console.warn("Date formatting error:",s),"N/A"}},ts=a=>{if(!a)return"N/A";try{return zt(a,{includeTime:!0,includeSeconds:!0})}catch(t){return console.warn("DateTime formatting error:",t),"N/A"}},Ux=a=>{if(!a)return"N/A";try{const t=new Date,s=new Date(a);if(isNaN(s.getTime()))return"N/A";const r=Math.floor((t.getTime()-s.getTime())/(1e3*60));if(r<1)return"Just now";if(r<60)return`${r}m ago`;const n=Math.floor(r/60);return n<24?`${n}h ago`:`${Math.floor(n/24)}d ago`}catch(t){return console.warn("TimeAgo formatting error:",t),"N/A"}},mt=a=>{try{return typeof a!="number"||isNaN(a)?"0.00":new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(a)}catch(t){return console.warn("Currency formatting error:",t),"0.00"}};function zx(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(F,{variant:"ghost",onClick:()=>window.history.back(),className:"text-white hover:text-blue-300 mb-4",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Terms of Service"}),e.jsxs("p",{className:"text-slate-300",children:["Last updated: ",new Date().toLocaleDateString()]})]}),e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"1. Acceptance of Terms"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"By accessing and using ParkFlow's smart parking management system, you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to abide by the above, please do not use this service."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"2. Description of Service"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"ParkFlow provides a comprehensive smart parking management platform that includes:"}),e.jsxs("ul",{className:"list-disc list-inside text-slate-600 space-y-2 ml-4",children:[e.jsx("li",{children:"Real-time parking space monitoring and analytics"}),e.jsx("li",{children:"Role-based access control for contractors, attendants, and administrators"}),e.jsx("li",{children:"Multi-location parking management capabilities"}),e.jsx("li",{children:"Vehicle tracking and payment processing"}),e.jsx("li",{children:"Reporting and dashboard functionalities"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"3. User Accounts and Responsibilities"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Account Creation:"})," You must provide accurate and complete information when creating your account. You are responsible for maintaining the confidentiality of your account credentials."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role-Based Access:"})," Access to different features is determined by your assigned role (Contractor, Attendant, or Super Admin). You may only access features appropriate to your role."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Prohibited Activities:"})," You agree not to:"]}),e.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[e.jsx("li",{children:"Attempt to gain unauthorized access to other users' accounts or system areas"}),e.jsx("li",{children:"Use the service for any illegal or unauthorized purpose"}),e.jsx("li",{children:"Interfere with or disrupt the service or servers connected to the service"}),e.jsx("li",{children:"Share your account credentials with others"}),e.jsx("li",{children:"Manipulate or falsify parking data or reports"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"4. Data and Privacy"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Your use of ParkFlow is also governed by our Privacy Policy. We collect and process data necessary for providing parking management services, including vehicle information, payment data, and usage analytics. We implement appropriate security measures to protect your data."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"5. Payment Terms"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Service Fees:"})," ParkFlow may charge fees for premium features or usage beyond certain limits. All fees are clearly displayed before purchase."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment Processing:"})," We use secure third-party payment processors. You are responsible for all charges incurred under your account."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Refunds:"})," Refund policies are determined on a case-by-case basis and must be requested within 30 days of the original transaction."]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"6. Service Availability"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'While we strive to maintain high service availability, ParkFlow is provided "as is" and we do not guarantee uninterrupted access. We may perform maintenance, updates, or modifications that temporarily affect service availability.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"7. Limitation of Liability"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"ParkFlow shall not be liable for any indirect, incidental, special, consequential, or punitive damages, including but not limited to loss of profits, data, or business opportunities, arising from your use of the service."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"8. Termination"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We may terminate or suspend your account immediately, without prior notice, for conduct that we believe violates these Terms of Service or is harmful to other users, us, or third parties, or for any other reason at our sole discretion."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"9. Changes to Terms"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We reserve the right to modify these terms at any time. We will notify users of any material changes via email or through the service. Your continued use of the service after such modifications constitutes acceptance of the updated terms."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"10. Contact Information"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"If you have any questions about these Terms of Service, please contact us at:"}),e.jsx("div",{className:"mt-4 p-4 bg-slate-50 rounded-lg",children:e.jsxs("p",{className:"text-slate-700",children:[e.jsx("strong",{children:"Email:"})," legal@parkflow.com",e.jsx("br",{}),e.jsx("strong",{children:"Address:"})," ParkFlow Legal Department",e.jsx("br",{}),"123 Smart Parking Ave, Tech City, TC 12345"]})})]}),e.jsx("div",{className:"pt-8 border-t border-slate-200",children:e.jsxs("p",{className:"text-sm text-slate-500 text-center",children:["These Terms of Service are effective as of ",zt(new Date)," and will remain in effect except with respect to any changes in their provisions in the future."]})})]})]})})})}function Bx(){return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs(F,{variant:"ghost",onClick:()=>window.history.back(),className:"text-white hover:text-blue-300 mb-4",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Privacy Policy"}),e.jsxs("p",{className:"text-slate-300",children:["Last updated: ",new Date().toLocaleDateString()]})]}),e.jsxs("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"1. Introduction"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'ParkFlow ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our smart parking management platform.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"2. Information We Collect"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-3",children:"Personal Information"}),e.jsxs("ul",{className:"list-disc list-inside text-slate-600 space-y-2 ml-4",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Account Information:"})," Name, email address, phone number, role designation"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Vehicle Information:"})," License plate numbers, vehicle type, entry/exit times"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Payment Information:"})," Billing details, payment methods (processed securely through third-party providers)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Location Data:"})," Parking location coordinates, facility information"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-3",children:"Usage Information"}),e.jsxs("ul",{className:"list-disc list-inside text-slate-600 space-y-2 ml-4",children:[e.jsx("li",{children:"System access logs and timestamps"}),e.jsx("li",{children:"Feature usage patterns and preferences"}),e.jsx("li",{children:"Device information and browser type"}),e.jsx("li",{children:"IP addresses and geolocation data"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-slate-700 mb-3",children:"Parking Analytics Data"}),e.jsxs("ul",{className:"list-disc list-inside text-slate-600 space-y-2 ml-4",children:[e.jsx("li",{children:"Occupancy rates and parking duration statistics"}),e.jsx("li",{children:"Revenue and transaction data"}),e.jsx("li",{children:"System performance metrics"}),e.jsx("li",{children:"User behavior patterns (anonymized)"})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"3. How We Use Your Information"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Service Provision:"})," To provide and maintain our parking management services, process transactions, and manage user accounts."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Communication:"})," To send service-related notifications, updates, and respond to your inquiries."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Analytics:"})," To analyze usage patterns, improve our services, and generate parking management reports."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Security:"})," To monitor for fraudulent activity, ensure system security, and prevent unauthorized access."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Compliance:"})," To comply with legal obligations and regulatory requirements."]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"4. Information Sharing and Disclosure"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsx("p",{children:"We do not sell, trade, or rent your personal information to third parties. We may share information in the following circumstances:"}),e.jsxs("div",{className:"ml-4 space-y-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Service Providers:"})," With trusted third-party vendors who assist in operating our platform (payment processors, cloud hosting providers, analytics services)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Business Partners:"})," With parking facility owners and operators as necessary to provide services."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Legal Requirements:"})," When required by law, court order, or to protect our rights and safety."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Business Transfers:"})," In connection with a merger, acquisition, or sale of assets."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Consent:"})," When you have given explicit consent for specific sharing purposes."]})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"5. Data Security"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsx("p",{children:"We implement comprehensive security measures to protect your information:"}),e.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[e.jsx("li",{children:"End-to-end encryption for data transmission"}),e.jsx("li",{children:"Secure data storage with access controls"}),e.jsx("li",{children:"Regular security audits and vulnerability assessments"}),e.jsx("li",{children:"Multi-factor authentication for administrative access"}),e.jsx("li",{children:"Employee training on data protection best practices"}),e.jsx("li",{children:"Incident response procedures for data breaches"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"6. Data Retention"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We retain your personal information for as long as necessary to provide our services and fulfill the purposes outlined in this policy. Parking transaction data is typically retained for 7 years for accounting and legal compliance purposes. Account information is retained until you request deletion or close your account."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"7. Your Rights and Choices"}),e.jsxs("div",{className:"space-y-4 text-slate-600",children:[e.jsx("p",{children:"Depending on your location, you may have the following rights regarding your personal information:"}),e.jsxs("ul",{className:"list-disc list-inside ml-4 space-y-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Access:"})," Request access to your personal information we hold"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Correction:"})," Request correction of inaccurate or incomplete information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Deletion:"})," Request deletion of your personal information"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Portability:"})," Request a copy of your data in a portable format"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Restriction:"})," Request restriction of processing in certain circumstances"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Objection:"})," Object to processing based on legitimate interests"]})]}),e.jsx("p",{className:"mt-4",children:"To exercise these rights, please contact us at privacy@parkflow.com"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"8. Cookies and Tracking Technologies"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"We use cookies and similar tracking technologies to enhance your experience, analyze usage patterns, and improve our services. You can control cookie preferences through your browser settings, though some features may not function properly if cookies are disabled."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"9. International Data Transfers"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Your information may be transferred to and processed in countries other than your own. We ensure appropriate safeguards are in place to protect your information in accordance with applicable data protection laws."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"10. Children's Privacy"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:"Our services are not intended for individuals under 16 years of age. We do not knowingly collect personal information from children under 16. If we become aware that we have collected such information, we will take steps to delete it promptly."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"11. Changes to This Privacy Policy"}),e.jsx("p",{className:"text-slate-600 leading-relaxed",children:'We may update this Privacy Policy from time to time. We will notify you of any material changes by posting the new policy on our website and updating the "Last updated" date. We encourage you to review this policy periodically.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"12. Contact Us"}),e.jsx("p",{className:"text-slate-600 leading-relaxed mb-4",children:"If you have any questions about this Privacy Policy or our data practices, please contact us:"}),e.jsx("div",{className:"p-4 bg-slate-50 rounded-lg",children:e.jsxs("p",{className:"text-slate-700",children:[e.jsx("strong",{children:"Privacy Officer:"})," privacy@parkflow.com",e.jsx("br",{}),e.jsx("strong",{children:"General Inquiries:"})," support@parkflow.com",e.jsx("br",{}),e.jsx("strong",{children:"Address:"})," ParkFlow Privacy Department",e.jsx("br",{}),"123 Smart Parking Ave, Tech City, TC 12345",e.jsx("br",{}),e.jsx("strong",{children:"Phone:"})," +1 (555) 123-PARK"]})})]}),e.jsx("div",{className:"pt-8 border-t border-slate-200",children:e.jsxs("p",{className:"text-sm text-slate-500 text-center",children:["This Privacy Policy is effective as of ",new Date().toLocaleDateString()," and will remain in effect except with respect to any changes in its provisions in the future."]})})]})]})})})}function Hx(){const[a,t]=l.useState(""),[s,r]=l.useState(!1),[n,o]=l.useState(""),[i,c]=l.useState(0),d=Kt(),u="123456",h=3,m=async p=>{p.preventDefault(),r(!0),o("");try{if(a.toUpperCase()===u)console.log("SuperAdminVerification: OTP is valid, navigating to superadminlogin"),d("/superadminlogin");else{const f=i+1;c(f),f>=h?(o("Too many failed attempts. Redirecting to Role Selection..."),setTimeout(()=>{d("/")},2e3)):o(`Invalid OTP. ${h-f} attempts remaining.`)}}catch(f){o("An error occurred during verification. Please try again."),console.error("OTP verification error:",f)}r(!1)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-900/90 via-purple-900/80 to-pink-900/90"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-purple-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_bottom_left,_var(--tw-gradient-stops))] from-indigo-600/20 via-transparent to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-pink-600/10 via-transparent to-transparent"}),e.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-gradient-to-r from-indigo-500/20 to-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-80 h-80 bg-gradient-to-r from-pink-500/10 to-purple-500/10 rounded-full blur-3xl animate-pulse delay-500"}),e.jsx("div",{className:"w-full max-w-md relative z-10",children:e.jsxs("div",{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 via-indigo-600 to-pink-600 p-6 text-white text-center relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/80 via-indigo-600/80 to-pink-600/80"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(na,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-2xl font-bold",children:"Super Admin Verification"})]}),e.jsx("p",{className:"text-purple-100 text-sm",children:"Enter the 6-digit verification code to access Super Admin"})]})]}),e.jsxs("div",{className:"p-8 bg-white/5 backdrop-blur-sm",children:[e.jsxs("form",{onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"otp",className:"text-white font-medium",children:"Verification Code"}),e.jsx(ge,{id:"otp",type:"text",placeholder:"Enter 6-digit code",value:a,onChange:p=>t(p.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"").slice(0,6)),required:!0,className:"h-12 text-center text-lg tracking-widest bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm",maxLength:6}),e.jsx("p",{className:"text-xs text-white/60 text-center",children:"Enter the 6-character verification code"})]}),n&&e.jsx("div",{className:"p-3 bg-red-500/20 border border-red-400/30 rounded-lg backdrop-blur-sm",children:e.jsx("p",{className:"text-red-200 text-sm",children:n})}),e.jsx(F,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-purple-600 via-indigo-600 to-pink-600 hover:from-purple-700 hover:via-indigo-700 hover:to-pink-700 text-white font-semibold rounded-xl shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02]",disabled:s||a.length!==6,children:s?"Verifying...":"Verify & Continue"})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsxs(F,{variant:"ghost",onClick:()=>d("/"),className:"text-sm text-white/70 hover:text-white hover:bg-white/10",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Back to Role Selection"]})}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-500/20 border border-yellow-400/30 rounded-lg backdrop-blur-sm",children:e.jsxs("p",{className:"text-xs text-yellow-200 text-center",children:[e.jsx("strong",{children:"Development Mode:"})," Use code ",e.jsx("span",{className:"bg-yellow-500/30 px-1 rounded font-mono text-yellow-100",children:"123456"})," for testing"]})})]})]})})]})}function qx(){const{profile:a,updateProfile:t,user:s,signOut:r}=ft();Kt();const{toast:n}=Tt(),[o,i]=l.useState(1),[c,d]=l.useState(!1),[u,h]=l.useState(!1),[m,p]=l.useState({newPassword:"",confirmPassword:"",acceptTerms:!1,enableNotifications:!0}),f=[{id:1,title:"Welcome",description:"Get started with ParkFlow"},{id:2,title:"Security",description:"Set up your password"},{id:3,title:"Preferences",description:"Configure your settings"},{id:4,title:"Complete",description:"You're all set!"}],v=async()=>{if(m.newPassword!==m.confirmPassword){n({variant:"destructive",title:"Password Mismatch",description:"Passwords do not match. Please try again."});return}if(m.newPassword.length<8){n({variant:"destructive",title:"Weak Password",description:"Password must be at least 8 characters long."});return}d(!0);try{const{apiClient:N}=await Ye(async()=>{const{apiClient:b}=await Promise.resolve().then(()=>ci);return{apiClient:b}},void 0),{AuthAPI:g}=await Ye(async()=>{const{AuthAPI:b}=await Promise.resolve().then(()=>Bt);return{AuthAPI:b}},void 0);if(!s?.id)throw new Error("User not authenticated");await N.post(`/profiles/updatePassword/${s.id}`,{newPassword:m.newPassword});try{const b=await g.fetchProfile();b&&(await t(b),console.log("Profile refreshed after password update, is_first_login:",b.is_first_login))}catch(b){console.error("Error refreshing profile:",b)}n({title:"Password Updated",description:"Your password has been successfully updated."}),i(3)}catch(N){console.error("Password update error:",N),n({variant:"destructive",title:"Error",description:"Failed to update password. Please try again."})}finally{d(!1)}},y=async()=>{d(!0);try{const{AuthAPI:N}=await Ye(async()=>{const{AuthAPI:g}=await Promise.resolve().then(()=>Bt);return{AuthAPI:g}},void 0);if(n({title:"Setup Complete!",description:"Your account setup is complete. Please login with your new password."}),a?.role==="attendant"&&s)try{const{AttendantAPI:g}=await Ye(async()=>{const{AttendantAPI:b}=await Promise.resolve().then(()=>wr);return{AttendantAPI:b}},void 0);await g.updateDeviceFingerprint(s.id,"")}catch(g){console.error("Failed to clear device fingerprint:",g)}N.removeToken(),setTimeout(()=>{window.location.href="/login"},500)}catch(N){console.error("Onboarding completion error:",N),n({variant:"destructive",title:"Error",description:"Failed to complete setup. Please try again."})}finally{d(!1)}},w=()=>{switch(a?.role){case"attendant":return[{icon:e.jsx(ot,{className:"h-5 w-5"}),title:"Vehicle Check-in/out",description:"Manage vehicle entries and exits"},{icon:e.jsx(qs,{className:"h-5 w-5"}),title:"Real-time Monitoring",description:"Track parking status live"},{icon:e.jsx(na,{className:"h-5 w-5"}),title:"Secure Access",description:"Role-based permissions"}];case"contractor":return[{icon:e.jsx(Wt,{className:"h-5 w-5"}),title:"Team Management",description:"Manage your attendants and locations"},{icon:e.jsx(ot,{className:"h-5 w-5"}),title:"Location Overview",description:"Monitor all your parking locations"},{icon:e.jsx(no,{className:"h-5 w-5"}),title:"Analytics",description:"Track performance and revenue"}];case"super_admin":return[{icon:e.jsx(Wt,{className:"h-5 w-5"}),title:"User Management",description:"Manage all users and permissions"},{icon:e.jsx(na,{className:"h-5 w-5"}),title:"System Control",description:"Full system administration"},{icon:e.jsx(no,{className:"h-5 w-5"}),title:"Analytics",description:"Comprehensive system insights"}];default:return[]}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-pink-500/10 rounded-full blur-3xl animate-pulse delay-500"})]}),e.jsx("div",{className:"relative z-10 min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-center space-x-4",children:f.map((N,g)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`
                    w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold
                    ${o>=N.id?"bg-gradient-to-r from-purple-600 to-pink-600 text-white":"bg-white/20 text-white/60"}
                  `,children:o>N.id?e.jsx(Rt,{className:"h-5 w-5"}):N.id}),g<f.length-1&&e.jsx("div",{className:`w-16 h-1 mx-2 ${o>N.id?"bg-gradient-to-r from-purple-600 to-pink-600":"bg-white/20"}`})]},N.id))}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:f[o-1].title}),e.jsx("p",{className:"text-white/80",children:f[o-1].description})]})]}),e.jsx(_e,{className:"bg-white/10 backdrop-blur-xl border border-white/20 shadow-2xl rounded-3xl",children:e.jsxs(Ee,{className:"p-8",children:[o===1&&e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto",children:e.jsx(no,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-3xl font-bold text-white mb-2",children:["Welcome to ParkFlow, ",a?.user_name,"!"]}),e.jsxs("p",{className:"text-white/80 text-lg",children:["You're now a ",e.jsx(Je,{variant:"secondary",className:"ml-2",children:a?.role?.toUpperCase()})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-8",children:w().map((N,g)=>e.jsxs("div",{className:"bg-white/10 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-purple-400 mb-2 flex justify-center",children:N.icon}),e.jsx("h4",{className:"text-white font-semibold mb-1",children:N.title}),e.jsx("p",{className:"text-white/70 text-sm",children:N.description})]},g))}),e.jsxs(F,{onClick:()=>i(2),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white px-8 py-3 rounded-xl",children:["Get Started",e.jsx(br,{className:"ml-2 h-4 w-4"})]})]}),o===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(na,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Set Up Your Password"}),e.jsx("p",{className:"text-white/80",children:"For security, please set a strong password for your account."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(te,{htmlFor:"newPassword",className:"text-white font-medium",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"newPassword",type:u?"text":"password",value:m.newPassword,onChange:N=>p({...m,newPassword:N.target.value}),className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm",placeholder:"Enter your new password"}),e.jsx(F,{type:"button",variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-white/60 hover:text-white hover:bg-white/10",onClick:()=>h(!u),children:u?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"confirmPassword",className:"text-white font-medium",children:"Confirm Password"}),e.jsx(ge,{id:"confirmPassword",type:"password",value:m.confirmPassword,onChange:N=>p({...m,confirmPassword:N.target.value}),className:"bg-white/10 border-white/20 text-white placeholder:text-white/60 focus:border-purple-400 focus:ring-purple-400 backdrop-blur-sm",placeholder:"Confirm your new password"})]}),e.jsxs("div",{className:"bg-blue-500/20 border border-blue-400/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-blue-200 font-semibold mb-2",children:"Password Requirements:"}),e.jsxs("ul",{className:"text-blue-100 text-sm space-y-1",children:[e.jsx("li",{children:" At least 8 characters long"}),e.jsx("li",{children:" Mix of letters, numbers, and symbols"}),e.jsx("li",{children:" Avoid common words or personal info"})]})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(F,{variant:"ghost",onClick:()=>i(1),className:"text-white/70 hover:text-white hover:bg-white/10",children:"Back"}),e.jsx(F,{onClick:v,disabled:c||!m.newPassword||!m.confirmPassword,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white",children:c?"Updating...":"Update Password"})]})]}),o===3&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Wt,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Configure Your Preferences"}),e.jsx("p",{className:"text-white/80",children:"Set up your account preferences for the best experience."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fn,{id:"acceptTerms",checked:m.acceptTerms,onCheckedChange:N=>p({...m,acceptTerms:N}),className:"border-white/30 data-[state=checked]:bg-purple-500 data-[state=checked]:border-purple-500"}),e.jsx(te,{htmlFor:"acceptTerms",className:"text-white/80",children:"I accept the Terms of Service and Privacy Policy"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fn,{id:"enableNotifications",checked:m.enableNotifications,onCheckedChange:N=>p({...m,enableNotifications:N}),className:"border-white/30 data-[state=checked]:bg-purple-500 data-[state=checked]:border-purple-500"}),e.jsx(te,{htmlFor:"enableNotifications",className:"text-white/80",children:"Enable notifications for important updates"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(F,{variant:"ghost",onClick:()=>i(2),className:"text-white/70 hover:text-white hover:bg-white/10",children:"Back"}),e.jsx(F,{onClick:()=>i(4),disabled:!m.acceptTerms,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white",children:"Continue"})]})]}),o===4&&e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full flex items-center justify-center mx-auto",children:e.jsx(Rt,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-3xl font-bold text-white mb-2",children:"Setup Complete!"}),e.jsx("p",{className:"text-white/80 text-lg",children:"Your account is ready. Welcome to ParkFlow!"})]}),e.jsxs("div",{className:"bg-green-500/20 border border-green-400/30 rounded-lg p-4",children:[e.jsx("h4",{className:"text-green-200 font-semibold mb-2",children:"What's Next?"}),e.jsxs("ul",{className:"text-green-100 text-sm space-y-1",children:[e.jsx("li",{children:" Explore your personalized dashboard"}),e.jsx("li",{children:" Complete your profile information"}),e.jsx("li",{children:" Start using ParkFlow features"})]})]}),e.jsxs(F,{onClick:y,disabled:c,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white px-8 py-3 rounded-xl",children:[c?"Completing...":"Go to Dashboard",e.jsx(br,{className:"ml-2 h-4 w-4"})]})]})]})})]})})]})}class Ot{static async getDashboardStats(){try{const{DashboardAPI:t}=await Ye(async()=>{const{DashboardAPI:r}=await import("./dashboardApi-DxH4pNKS.js");return{DashboardAPI:r}},__vite__mapDeps([0,1,2,3,4])),s=await t.getDashboardMetrics();return{totalContractors:s.totalContractors,totalLocations:s.totalLocations,totalAttendants:s.activeAttendants,totalVehicles:s.totalVehicles,totalRevenue:s.totalRevenue,todayRevenue:s.dailyRevenue,monthlyRevenue:s.monthlyRevenue,todayVehicles:0,monthlyVehicles:0}}catch(t){return console.error("Error fetching dashboard stats:",t),{totalContractors:0,totalLocations:0,totalAttendants:0,totalVehicles:0,totalRevenue:0,todayRevenue:0,monthlyRevenue:0,todayVehicles:0,monthlyVehicles:0}}}static async getDayWiseRevenue(t=30){try{const{DashboardAPI:s}=await Ye(async()=>{const{DashboardAPI:r}=await import("./dashboardApi-DxH4pNKS.js");return{DashboardAPI:r}},__vite__mapDeps([0,1,2,3,4]));return await s.getDayWiseRevenue(t)}catch(s){return console.error("Error fetching day-wise revenue:",s),{}}}static async getAllContractors(){const{ContractorAPI:t}=await Ye(async()=>{const{ContractorAPI:s}=await Promise.resolve().then(()=>Er);return{ContractorAPI:s}},void 0);return await t.getAllContractors()}static async getPaginatedContractors(t={}){const{ContractorAPI:s}=await Ye(async()=>{const{ContractorAPI:r}=await Promise.resolve().then(()=>Er);return{ContractorAPI:r}},void 0);return await s.getContractorsPaginated(t)}static async createContractor(t){return(await pe.post("/contractors",{user_name:t.user_name,email:t.email,password:t.password||"TempPassword123!",phone_number:t.phone_number,company_name:t.company_name,contact_number:t.contact_number,allowed_locations:t.allowed_locations,allowed_attendants_per_location:t.allowed_attendants_per_location,status:t.status||"active",rates_2wheeler:t.rates_2wheeler,rates_4wheeler:t.rates_4wheeler})).data}static async updateContractor(t,s){return(await pe.post(`/contractors/update/${t}`,s)).data}static async deleteContractor(t){await pe.get(`/contractors/delete/${t}`)}static async getSystemAnalytics(){try{const{DashboardAPI:t}=await Ye(async()=>{const{DashboardAPI:r}=await import("./dashboardApi-DxH4pNKS.js");return{DashboardAPI:r}},__vite__mapDeps([0,1,2,3,4]));return await t.getSystemAnalytics()}catch(t){return console.error("Error fetching system analytics:",t),{today:{vehicles:0,revenue:0},yesterday:{vehicles:0,revenue:0},thisMonth:{vehicles:0,revenue:0},lastMonth:{vehicles:0,revenue:0}}}}static async getAllLocations(){const{LocationAPI:t}=await Ye(async()=>{const{LocationAPI:s}=await Promise.resolve().then(()=>Gf);return{LocationAPI:s}},void 0);return await t.getAllLocations()}static async createLocation(t){return(await pe.post("/locations",{locations_name:t.locations_name,address:t.address,city:t.city,state:t.state,pincode:t.pincode,total_slots:t.total_slots,contractor_id:t.contractor_id,status:t.status||"active"})).data}static async updateLocation(t,s){return(await pe.post(`/locations/update/${t}`,s)).data}static async deleteLocation(t){await pe.get(`/locations/delete/${t}`)}static async getAllAttendants(){const{AttendantAPI:t}=await Ye(async()=>{const{AttendantAPI:s}=await Promise.resolve().then(()=>wr);return{AttendantAPI:s}},void 0);return await t.getAllAttendants()}static async createAttendant(t){return(await pe.post("/attendants",{user_name:t.user_name,email:t.email,password:t.password||"TempPassword123!",phone_number:t.phone_number,location_id:t.location_id,contractor_id:t.contractor_id,status:t.status||"active"})).data}static async updateAttendant(t,s){return(await pe.post(`/attendants/update/${t}`,s)).data}static async deleteAttendant(t){await pe.get(`/attendants/delete/${t}`)}}function Pe({title:a,value:t,description:s,icon:r,trend:n,variant:o="default"}){const i={default:"bg-gradient-to-br from-slate-50 to-slate-100 border-slate-200",success:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",warning:"bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",danger:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",info:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200"},c={default:"text-slate-600",success:"text-green-600",warning:"text-yellow-600",danger:"text-red-600",info:"text-blue-600"};return e.jsxs(_e,{className:`${i[o]} hover:shadow-lg transition-all duration-200 rounded-xl border-2 hover:scale-105`,children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2 sm:pb-3",children:[e.jsx(Be,{className:"text-xs sm:text-sm font-semibold text-slate-700",children:a}),e.jsx("div",{className:`p-1.5 sm:p-2 rounded-lg ${i[o]}`,children:e.jsx(r,{className:`h-4 w-4 sm:h-5 sm:w-5 ${c[o]}`})})]}),e.jsxs(Ee,{className:"pt-0",children:[e.jsx("div",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-1 sm:mb-2",children:t}),s&&e.jsx("p",{className:"text-xs sm:text-sm text-slate-600 mb-1 sm:mb-2",children:s}),n&&e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 text-xs sm:text-sm",children:[e.jsxs("span",{className:`font-medium ${n.value>=0?"text-green-600":"text-red-600"}`,children:[n.value>=0?"+":"",n.value,"%"]}),e.jsx("span",{className:"text-slate-500",children:n.label})]})]})]})}function Wx(a,t){return l.useReducer((s,r)=>t[s][r]??s,a)}var bi="ScrollArea",[eu,kb]=Rs(bi),[Yx,is]=eu(bi),tu=l.forwardRef((a,t)=>{const{__scopeScrollArea:s,type:r="hover",dir:n,scrollHideDelay:o=600,...i}=a,[c,d]=l.useState(null),[u,h]=l.useState(null),[m,p]=l.useState(null),[f,v]=l.useState(null),[y,w]=l.useState(null),[N,g]=l.useState(0),[b,A]=l.useState(0),[P,E]=l.useState(!1),[V,M]=l.useState(!1),O=rt(t,ee=>d(ee)),I=An(n);return e.jsx(Yx,{scope:s,type:r,dir:I,scrollHideDelay:o,scrollArea:c,viewport:u,onViewportChange:h,content:m,onContentChange:p,scrollbarX:f,onScrollbarXChange:v,scrollbarXEnabled:P,onScrollbarXEnabledChange:E,scrollbarY:y,onScrollbarYChange:w,scrollbarYEnabled:V,onScrollbarYEnabledChange:M,onCornerWidthChange:g,onCornerHeightChange:A,children:e.jsx(De.div,{dir:I,...i,ref:O,style:{position:"relative","--radix-scroll-area-corner-width":N+"px","--radix-scroll-area-corner-height":b+"px",...a.style}})})});tu.displayName=bi;var su="ScrollAreaViewport",au=l.forwardRef((a,t)=>{const{__scopeScrollArea:s,children:r,nonce:n,...o}=a,i=is(su,s),c=l.useRef(null),d=rt(t,c,i.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(De.div,{"data-radix-scroll-area-viewport":"",...o,ref:d,style:{overflowX:i.scrollbarXEnabled?"scroll":"hidden",overflowY:i.scrollbarYEnabled?"scroll":"hidden",...a.style},children:e.jsx("div",{ref:i.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});au.displayName=su;var Is="ScrollAreaScrollbar",wi=l.forwardRef((a,t)=>{const{forceMount:s,...r}=a,n=is(Is,a.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:i}=n,c=a.orientation==="horizontal";return l.useEffect(()=>(c?o(!0):i(!0),()=>{c?o(!1):i(!1)}),[c,o,i]),n.type==="hover"?e.jsx(Gx,{...r,ref:t,forceMount:s}):n.type==="scroll"?e.jsx(Zx,{...r,ref:t,forceMount:s}):n.type==="auto"?e.jsx(ru,{...r,ref:t,forceMount:s}):n.type==="always"?e.jsx(ji,{...r,ref:t}):null});wi.displayName=Is;var Gx=l.forwardRef((a,t)=>{const{forceMount:s,...r}=a,n=is(Is,a.__scopeScrollArea),[o,i]=l.useState(!1);return l.useEffect(()=>{const c=n.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),i(!0)},h=()=>{d=window.setTimeout(()=>i(!1),n.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",h),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",h)}}},[n.scrollArea,n.scrollHideDelay]),e.jsx(Ts,{present:s||o,children:e.jsx(ru,{"data-state":o?"visible":"hidden",...r,ref:t})})}),Zx=l.forwardRef((a,t)=>{const{forceMount:s,...r}=a,n=is(Is,a.__scopeScrollArea),o=a.orientation==="horizontal",i=Zn(()=>d("SCROLL_END"),100),[c,d]=Wx("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return l.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,n.scrollHideDelay,d]),l.useEffect(()=>{const u=n.viewport,h=o?"scrollLeft":"scrollTop";if(u){let m=u[h];const p=()=>{const f=u[h];m!==f&&(d("SCROLL"),i()),m=f};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[n.viewport,o,d,i]),e.jsx(Ts,{present:s||c!=="hidden",children:e.jsx(ji,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Oe(a.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Oe(a.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),ru=l.forwardRef((a,t)=>{const s=is(Is,a.__scopeScrollArea),{forceMount:r,...n}=a,[o,i]=l.useState(!1),c=a.orientation==="horizontal",d=Zn(()=>{if(s.viewport){const u=s.viewport.offsetWidth<s.viewport.scrollWidth,h=s.viewport.offsetHeight<s.viewport.scrollHeight;i(c?u:h)}},10);return rr(s.viewport,d),rr(s.content,d),e.jsx(Ts,{present:r||o,children:e.jsx(ji,{"data-state":o?"visible":"hidden",...n,ref:t})})}),ji=l.forwardRef((a,t)=>{const{orientation:s="vertical",...r}=a,n=is(Is,a.__scopeScrollArea),o=l.useRef(null),i=l.useRef(0),[c,d]=l.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=cu(c.viewport,c.content),h={...r,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:p=>o.current=p,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:p=>i.current=p};function m(p,f){return tg(p,i.current,c,f)}return s==="horizontal"?e.jsx(Kx,{...h,ref:t,onThumbPositionChange:()=>{if(n.viewport&&o.current){const p=n.viewport.scrollLeft,f=el(p,c,n.dir);o.current.style.transform=`translate3d(${f}px, 0, 0)`}},onWheelScroll:p=>{n.viewport&&(n.viewport.scrollLeft=p)},onDragScroll:p=>{n.viewport&&(n.viewport.scrollLeft=m(p,n.dir))}}):s==="vertical"?e.jsx(Qx,{...h,ref:t,onThumbPositionChange:()=>{if(n.viewport&&o.current){const p=n.viewport.scrollTop,f=el(p,c);o.current.style.transform=`translate3d(0, ${f}px, 0)`}},onWheelScroll:p=>{n.viewport&&(n.viewport.scrollTop=p)},onDragScroll:p=>{n.viewport&&(n.viewport.scrollTop=m(p))}}):null}),Kx=l.forwardRef((a,t)=>{const{sizes:s,onSizesChange:r,...n}=a,o=is(Is,a.__scopeScrollArea),[i,c]=l.useState(),d=l.useRef(null),u=rt(t,d,o.onScrollbarXChange);return l.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(ou,{"data-orientation":"horizontal",...n,ref:u,sizes:s,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Gn(s)+"px",...a.style},onThumbPointerDown:h=>a.onThumbPointerDown(h.x),onDragScroll:h=>a.onDragScroll(h.x),onWheelScroll:(h,m)=>{if(o.viewport){const p=o.viewport.scrollLeft+h.deltaX;a.onWheelScroll(p),uu(p,m)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&i&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:vn(i.paddingLeft),paddingEnd:vn(i.paddingRight)}})}})}),Qx=l.forwardRef((a,t)=>{const{sizes:s,onSizesChange:r,...n}=a,o=is(Is,a.__scopeScrollArea),[i,c]=l.useState(),d=l.useRef(null),u=rt(t,d,o.onScrollbarYChange);return l.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),e.jsx(ou,{"data-orientation":"vertical",...n,ref:u,sizes:s,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Gn(s)+"px",...a.style},onThumbPointerDown:h=>a.onThumbPointerDown(h.y),onDragScroll:h=>a.onDragScroll(h.y),onWheelScroll:(h,m)=>{if(o.viewport){const p=o.viewport.scrollTop+h.deltaY;a.onWheelScroll(p),uu(p,m)&&h.preventDefault()}},onResize:()=>{d.current&&o.viewport&&i&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:vn(i.paddingTop),paddingEnd:vn(i.paddingBottom)}})}})}),[Jx,nu]=eu(Is),ou=l.forwardRef((a,t)=>{const{__scopeScrollArea:s,sizes:r,hasThumb:n,onThumbChange:o,onThumbPointerUp:i,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:h,onResize:m,...p}=a,f=is(Is,s),[v,y]=l.useState(null),w=rt(t,O=>y(O)),N=l.useRef(null),g=l.useRef(""),b=f.viewport,A=r.content-r.viewport,P=$s(h),E=$s(d),V=Zn(m,10);function M(O){if(N.current){const I=O.clientX-N.current.left,ee=O.clientY-N.current.top;u({x:I,y:ee})}}return l.useEffect(()=>{const O=I=>{const ee=I.target;v?.contains(ee)&&P(I,A)};return document.addEventListener("wheel",O,{passive:!1}),()=>document.removeEventListener("wheel",O,{passive:!1})},[b,v,A,P]),l.useEffect(E,[r,E]),rr(v,V),rr(f.content,V),e.jsx(Jx,{scope:s,scrollbar:v,hasThumb:n,onThumbChange:$s(o),onThumbPointerUp:$s(i),onThumbPositionChange:E,onThumbPointerDown:$s(c),children:e.jsx(De.div,{...p,ref:w,style:{position:"absolute",...p.style},onPointerDown:Oe(a.onPointerDown,O=>{O.button===0&&(O.target.setPointerCapture(O.pointerId),N.current=v.getBoundingClientRect(),g.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",f.viewport&&(f.viewport.style.scrollBehavior="auto"),M(O))}),onPointerMove:Oe(a.onPointerMove,M),onPointerUp:Oe(a.onPointerUp,O=>{const I=O.target;I.hasPointerCapture(O.pointerId)&&I.releasePointerCapture(O.pointerId),document.body.style.webkitUserSelect=g.current,f.viewport&&(f.viewport.style.scrollBehavior=""),N.current=null})})})}),gn="ScrollAreaThumb",iu=l.forwardRef((a,t)=>{const{forceMount:s,...r}=a,n=nu(gn,a.__scopeScrollArea);return e.jsx(Ts,{present:s||n.hasThumb,children:e.jsx(Xx,{ref:t,...r})})}),Xx=l.forwardRef((a,t)=>{const{__scopeScrollArea:s,style:r,...n}=a,o=is(gn,s),i=nu(gn,s),{onThumbPositionChange:c}=i,d=rt(t,m=>i.onThumbChange(m)),u=l.useRef(void 0),h=Zn(()=>{u.current&&(u.current(),u.current=void 0)},100);return l.useEffect(()=>{const m=o.viewport;if(m){const p=()=>{if(h(),!u.current){const f=sg(m,c);u.current=f,c()}};return c(),m.addEventListener("scroll",p),()=>m.removeEventListener("scroll",p)}},[o.viewport,h,c]),e.jsx(De.div,{"data-state":i.hasThumb?"visible":"hidden",...n,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Oe(a.onPointerDownCapture,m=>{const f=m.target.getBoundingClientRect(),v=m.clientX-f.left,y=m.clientY-f.top;i.onThumbPointerDown({x:v,y})}),onPointerUp:Oe(a.onPointerUp,i.onThumbPointerUp)})});iu.displayName=gn;var Ni="ScrollAreaCorner",lu=l.forwardRef((a,t)=>{const s=is(Ni,a.__scopeScrollArea),r=!!(s.scrollbarX&&s.scrollbarY);return s.type!=="scroll"&&r?e.jsx(eg,{...a,ref:t}):null});lu.displayName=Ni;var eg=l.forwardRef((a,t)=>{const{__scopeScrollArea:s,...r}=a,n=is(Ni,s),[o,i]=l.useState(0),[c,d]=l.useState(0),u=!!(o&&c);return rr(n.scrollbarX,()=>{const h=n.scrollbarX?.offsetHeight||0;n.onCornerHeightChange(h),d(h)}),rr(n.scrollbarY,()=>{const h=n.scrollbarY?.offsetWidth||0;n.onCornerWidthChange(h),i(h)}),u?e.jsx(De.div,{...r,ref:t,style:{width:o,height:c,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...a.style}}):null});function vn(a){return a?parseInt(a,10):0}function cu(a,t){const s=a/t;return isNaN(s)?0:s}function Gn(a){const t=cu(a.viewport,a.content),s=a.scrollbar.paddingStart+a.scrollbar.paddingEnd,r=(a.scrollbar.size-s)*t;return Math.max(r,18)}function tg(a,t,s,r="ltr"){const n=Gn(s),o=n/2,i=t||o,c=n-i,d=s.scrollbar.paddingStart+i,u=s.scrollbar.size-s.scrollbar.paddingEnd-c,h=s.content-s.viewport,m=r==="ltr"?[0,h]:[h*-1,0];return du([d,u],m)(a)}function el(a,t,s="ltr"){const r=Gn(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=t.scrollbar.size-n,i=t.content-t.viewport,c=o-r,d=s==="ltr"?[0,i]:[i*-1,0],u=Po(a,d);return du([0,i],[0,c])(u)}function du(a,t){return s=>{if(a[0]===a[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(a[1]-a[0]);return t[0]+r*(s-a[0])}}function uu(a,t){return a>0&&a<t}var sg=(a,t=()=>{})=>{let s={left:a.scrollLeft,top:a.scrollTop},r=0;return function n(){const o={left:a.scrollLeft,top:a.scrollTop},i=s.left!==o.left,c=s.top!==o.top;(i||c)&&t(),s=o,r=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(r)};function Zn(a,t){const s=$s(a),r=l.useRef(0);return l.useEffect(()=>()=>window.clearTimeout(r.current),[]),l.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(s,t)},[s,t])}function rr(a,t){const s=$s(t);ns(()=>{let r=0;if(a){const n=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(s)});return n.observe(a),()=>{window.cancelAnimationFrame(r),n.unobserve(a)}}},[a,s])}var hu=tu,ag=au,rg=lu;const ng=l.forwardRef(({className:a,children:t,...s},r)=>e.jsxs(hu,{ref:r,className:ce("relative overflow-hidden",a),...s,children:[e.jsx(ag,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(mu,{}),e.jsx(rg,{})]}));ng.displayName=hu.displayName;const mu=l.forwardRef(({className:a,orientation:t="vertical",...s},r)=>e.jsx(wi,{ref:r,orientation:t,className:ce("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...s,children:e.jsx(iu,{className:"relative flex-1 rounded-full bg-border"})}));mu.displayName=wi.displayName;const bt=Jo,og=Xo,pu=l.forwardRef(({className:a,...t},s)=>e.jsx(En,{ref:s,className:ce("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t}));pu.displayName=En.displayName;const yt=l.forwardRef(({className:a,children:t,...s},r)=>e.jsxs(og,{children:[e.jsx(pu,{}),e.jsxs(Rn,{ref:r,className:ce("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...s,children:[t,e.jsxs(Zo,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[e.jsx(Ds,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));yt.displayName=Rn.displayName;const wt=({className:a,...t})=>e.jsx("div",{className:ce("flex flex-col space-y-1.5 text-center sm:text-left",a),...t});wt.displayName="DialogHeader";const Kn=({className:a,...t})=>e.jsx("div",{className:ce("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});Kn.displayName="DialogFooter";const jt=l.forwardRef(({className:a,...t},s)=>e.jsx(Ko,{ref:s,className:ce("text-lg font-semibold leading-none tracking-tight",a),...t}));jt.displayName=Ko.displayName;const At=l.forwardRef(({className:a,...t},s)=>e.jsx(Qo,{ref:s,className:ce("text-sm text-muted-foreground",a),...t}));At.displayName=Qo.displayName;var Qn="Tabs",[ig,Cb]=Rs(Qn,[Tn]),fu=Tn(),[lg,_i]=ig(Qn),xu=l.forwardRef((a,t)=>{const{__scopeTabs:s,value:r,onValueChange:n,defaultValue:o,orientation:i="horizontal",dir:c,activationMode:d="automatic",...u}=a,h=An(c),[m,p]=Ia({prop:r,onChange:n,defaultProp:o??"",caller:Qn});return e.jsx(lg,{scope:s,baseId:as(),value:m,onValueChange:p,orientation:i,dir:h,activationMode:d,children:e.jsx(De.div,{dir:h,"data-orientation":i,...u,ref:t})})});xu.displayName=Qn;var gu="TabsList",vu=l.forwardRef((a,t)=>{const{__scopeTabs:s,loop:r=!0,...n}=a,o=_i(gu,s),i=fu(s);return e.jsx(vc,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:r,children:e.jsx(De.div,{role:"tablist","aria-orientation":o.orientation,...n,ref:t})})});vu.displayName=gu;var yu="TabsTrigger",bu=l.forwardRef((a,t)=>{const{__scopeTabs:s,value:r,disabled:n=!1,...o}=a,i=_i(yu,s),c=fu(s),d=Nu(i.baseId,r),u=_u(i.baseId,r),h=r===i.value;return e.jsx(yc,{asChild:!0,...c,focusable:!n,active:h,children:e.jsx(De.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":u,"data-state":h?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:d,...o,ref:t,onMouseDown:Oe(a.onMouseDown,m=>{!n&&m.button===0&&m.ctrlKey===!1?i.onValueChange(r):m.preventDefault()}),onKeyDown:Oe(a.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&i.onValueChange(r)}),onFocus:Oe(a.onFocus,()=>{const m=i.activationMode!=="manual";!h&&!n&&m&&i.onValueChange(r)})})})});bu.displayName=yu;var wu="TabsContent",ju=l.forwardRef((a,t)=>{const{__scopeTabs:s,value:r,forceMount:n,children:o,...i}=a,c=_i(wu,s),d=Nu(c.baseId,r),u=_u(c.baseId,r),h=r===c.value,m=l.useRef(h);return l.useEffect(()=>{const p=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(p)},[]),e.jsx(Ts,{present:n||h,children:({present:p})=>e.jsx(De.div,{"data-state":h?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!p,id:u,tabIndex:0,...i,ref:t,style:{...a.style,animationDuration:m.current?"0s":void 0},children:p&&o})})});ju.displayName=wu;function Nu(a,t){return`${a}-trigger-${t}`}function _u(a,t){return`${a}-content-${t}`}var cg=xu,Su=vu,ku=bu,Cu=ju;const Pu=cg,Si=l.forwardRef(({className:a,...t},s)=>e.jsx(Su,{ref:s,className:ce("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...t}));Si.displayName=Su.displayName;const Ta=l.forwardRef(({className:a,...t},s)=>e.jsx(ku,{ref:s,className:ce("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",a),...t}));Ta.displayName=ku.displayName;const Da=l.forwardRef(({className:a,...t},s)=>e.jsx(Cu,{ref:s,className:ce("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...t}));Da.displayName=Cu.displayName;const Hr=l.forwardRef(({className:a,...t},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:ce("w-full caption-bottom text-sm",a),...t})}));Hr.displayName="Table";const qr=l.forwardRef(({className:a,...t},s)=>e.jsx("thead",{ref:s,className:ce("[&_tr]:border-b",a),...t}));qr.displayName="TableHeader";const Wr=l.forwardRef(({className:a,...t},s)=>e.jsx("tbody",{ref:s,className:ce("[&_tr:last-child]:border-0",a),...t}));Wr.displayName="TableBody";const dg=l.forwardRef(({className:a,...t},s)=>e.jsx("tfoot",{ref:s,className:ce("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t}));dg.displayName="TableFooter";const Bs=l.forwardRef(({className:a,...t},s)=>e.jsx("tr",{ref:s,className:ce("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",a),...t}));Bs.displayName="TableRow";const tt=l.forwardRef(({className:a,...t},s)=>e.jsx("th",{ref:s,className:ce("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t}));tt.displayName="TableHead";const st=l.forwardRef(({className:a,...t},s)=>e.jsx("td",{ref:s,className:ce("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t}));st.displayName="TableCell";const ug=l.forwardRef(({className:a,...t},s)=>e.jsx("caption",{ref:s,className:ce("mt-4 text-sm text-muted-foreground",a),...t}));ug.displayName="TableCaption";const hg=l.memo(function(){Kt();const[t,s]=l.useState(null),[r,n]=l.useState(null),[o,i]=l.useState(!0),c=l.useRef(!1),[d,u]=l.useState([]),[h,m]=l.useState([]),[p,f]=l.useState([]);l.useState(!1),l.useState(!1),l.useState(!1),l.useState(!1),l.useState(!1),l.useState(!1),l.useState({company_name:"",contact_number:"",email:"",password:"",allowed_locations:5,allowed_attendants_per_location:3}),l.useState({locations_name:"",address:"",city:"",state:"",pincode:"",contractor_id:"",total_slots:50}),l.useState({user_name:"",email:"",password:"",phone_number:"",location_id:""});const{toast:v}=Tt(),y=async()=>{try{i(!0);const[E,V,M,O,I]=await Promise.all([Ot.getDashboardStats(),Ot.getSystemAnalytics(),Ot.getAllContractors(),Ot.getAllLocations(),Ot.getAllAttendants()]);s(E),n(V),u(M),m(O),f(I)}catch(E){console.error("Error fetching dashboard data:",E),v({variant:"destructive",title:"Error",description:"Failed to fetch dashboard data"})}finally{i(!1)}};l.useEffect(()=>{c.current||(console.log("SuperAdminDashboard: Initial data fetch triggered"),c.current=!0,y())},[]);const w=(E,V)=>V===0?0:Math.round((E-V)/V*100);if(o)return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((E,V)=>e.jsxs(_e,{children:[e.jsxs(ze,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx("div",{className:"h-4 w-20 bg-muted animate-pulse rounded"}),e.jsx("div",{className:"h-4 w-4 bg-muted animate-pulse rounded"})]}),e.jsxs(Ee,{children:[e.jsx("div",{className:"h-8 w-16 bg-muted animate-pulse rounded mb-2"}),e.jsx("div",{className:"h-3 w-24 bg-muted animate-pulse rounded"})]})]},V))})});const N=r?.today?.vehicles!==void 0&&r?.yesterday?.vehicles!==void 0?w(r.today.vehicles,r.yesterday.vehicles):0,g=r?.today?.revenue!==void 0&&r?.yesterday?.revenue!==void 0?w(r.today.revenue,r.yesterday.revenue):0,b=r?.thisMonth?.vehicles!==void 0&&r?.lastMonth?.vehicles!==void 0?w(r.thisMonth.vehicles,r.lastMonth.vehicles):0,A=r?.thisMonth?.revenue!==void 0&&r?.lastMonth?.revenue!==void 0?w(r.thisMonth.revenue,r.lastMonth.revenue):0;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-extrabold tracking-tight bg-gradient-to-r from-amber-400 via-pink-400 to-rose-400 bg-clip-text text-transparent",children:"Super Admin Dashboard"}),e.jsx("p",{className:"text-sm sm:text-base text-slate-600",children:"Complete overview and management of your ParkFlow system"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(F,{variant:"outline",className:"bg-white/50 backdrop-blur w-full sm:w-auto",children:[e.jsx(ta,{className:"h-4 w-4 mr-2"}),"Generate Reports"]}),e.jsxs(F,{variant:"outline",className:"bg-white/50 backdrop-blur w-full sm:w-auto",children:[e.jsx(ri,{className:"h-4 w-4 mr-2"}),"System Settings"]})]})]}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-5",children:[e.jsx(Pe,{title:"Total Contractors",value:t?.totalContractors||0,description:"Active businesses",icon:Rm,variant:"info"}),e.jsx(Pe,{title:"Total Locations",value:t?.totalLocations||0,description:"Parking locations",icon:rs,variant:"success"}),e.jsx(Pe,{title:"Total Attendants",value:t?.totalAttendants||0,description:"Active staff members",icon:Wt,variant:"warning"}),e.jsx(Pe,{title:"Total Vehicles",value:t?.totalVehicles||0,description:"Vehicles managed",icon:ot,variant:"default"}),e.jsx(Pe,{title:"Total Revenue",value:`${t?.totalRevenue?.toFixed(2)||0}`,description:"All time earnings",icon:vs,variant:"success"})]}),e.jsxs("div",{className:"grid gap-3 sm:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(Pe,{title:"Today's Vehicles",value:t?.todayVehicles||0,description:"Vehicles checked in today",icon:ot,variant:"info",trend:{value:N,label:"vs yesterday"}}),e.jsx(Pe,{title:"Today's Revenue",value:`${(t?.todayRevenue||0).toFixed(2)}`,description:"Revenue earned today",icon:vs,variant:"success",trend:{value:g,label:"vs yesterday"}}),e.jsx(Pe,{title:"Monthly Vehicles",value:t?.monthlyVehicles||0,description:"This month's traffic",icon:Us,variant:"warning",trend:{value:b,label:"vs last month"}}),e.jsx(Pe,{title:"Monthly Revenue",value:`${(t?.monthlyRevenue||0).toFixed(2)}`,description:"This month's earnings",icon:Us,variant:"success",trend:{value:A,label:"vs last month"}})]}),!1]})});class mg{async insertLog(t){try{const{error:s}=await supabase.from("system_logs").insert({level:t.level,message:t.message,details:t.details,user_id:t.user_id,action:t.action,resource:t.resource,created_at:new Date().toISOString()});s&&(console.warn("Failed to insert log into database:",s),console.log(`[${t.level.toUpperCase()}] ${t.message}`,t.details))}catch(s){console.warn("Logger service error:",s),console.log(`[${t.level.toUpperCase()}] ${t.message}`,t.details)}}info(t,s,r,n,o){this.insertLog({level:"info",message:t,details:s,action:r||"info",resource:n||"system",user_id:o})}success(t,s,r,n,o){this.insertLog({level:"success",message:t,details:s,action:r||"success",resource:n||"system",user_id:o})}warning(t,s,r,n,o){this.insertLog({level:"warning",message:t,details:s,action:r||"warning",resource:n||"system",user_id:o})}error(t,s,r,n,o){this.insertLog({level:"error",message:t,details:s,action:r||"error",resource:n||"system",user_id:o})}logVehicleCheckin(t,s,r){this.info(`Vehicle ${t} checked in`,`Vehicle registered at location ${s}`,"vehicle_checkin","vehicles",r)}logVehicleCheckout(t,s,r){this.success(`Vehicle ${t} checked out`,`Payment received: ${s}`,"vehicle_checkout","vehicles",r)}logContractorCreate(t,s){this.info(`Contractor ${t} registered`,"New contractor added to the system","contractor_create","contractors",s)}logAttendantCreate(t,s){this.info(`Attendant ${t} added`,"New attendant registered","attendant_create","attendants",s)}logLocationCreate(t,s){this.info(`Location ${t} created`,"New parking location added","location_create","locations",s)}logPaymentReceived(t,s,r){this.success(`Payment received: ${t}`,`Payment method: ${s}`,"payment_received","payments",r)}logSystemError(t,s){this.error(`System error: ${t}`,s,"system_error","system")}logUserLogin(t,s){this.info(`User ${t} logged in`,`Role: ${s}`,"user_login","authentication")}logUserLogout(t){this.info(`User ${t} logged out`,"User session ended","user_logout","authentication")}}const lo=new mg;class Gt{static async createVehicle(t){const s=await pe.post("/vehicles",{plate_number:t.plate_number,vehicle_type:t.vehicle_type,location_id:t.location_id,contractor_id:t.contractor_id,mobile_number:t.mobile_number,gate_in_id:t.gate_in_id,session_id:t.session_id});try{const{AuthAPI:r}=await Ye(async()=>{const{AuthAPI:o}=await Promise.resolve().then(()=>Bt);return{AuthAPI:o}},void 0),n=r.getUser();n&&lo.logVehicleCheckin(t.plate_number,t.location_id,n.id)}catch(r){console.error("Error logging vehicle check-in:",r)}return s.data}static async getAllVehicles(){return(await pe.get("/vehicles")).data||[]}static async getContractorVehicles(t){return(await pe.get(`/vehicles/contractor/${t}`)).data||[]}static async getAttendantVehicles(t){let s=t;if(!s){const{AuthAPI:n}=await Ye(async()=>{const{AuthAPI:i}=await Promise.resolve().then(()=>Bt);return{AuthAPI:i}},void 0),o=n.getUser();if(!o)throw new Error("User not authenticated");s=o.id}return(await pe.get(`/vehicles/attendant/${s}`)).data||[]}static async getVehiclesByLocation(t){return(await pe.get(`/vehicles/location/${t}`)).data||[]}static async checkoutVehicle(t,s){const r=await pe.post(`/vehicles/checkout/${t}`,{check_out_time:s.check_out_time,payment_amount:s.payment_amount,payment_method:s.payment_method});try{const{AuthAPI:n}=await Ye(async()=>{const{AuthAPI:i}=await Promise.resolve().then(()=>Bt);return{AuthAPI:i}},void 0),o=n.getUser();o&&(lo.logVehicleCheckout(r.data.plate_number,s.payment_amount,o.id),lo.logPaymentReceived(s.payment_amount,s.payment_method,o.id))}catch(n){console.error("Error logging vehicle checkout:",n)}return r.data}static async getVehicleById(t){return(await pe.get(`/vehicles/${t}`)).data}static async getVehicleStats(t){const s=t?{locationId:t}:{};return(await pe.get("/vehicles/stats",s)).data}static async getVehiclesByDateRange(t,s,r){return(await pe.get("/vehicles/date-range",{locationId:t,startDate:s,endDate:r})).data||[]}static async updateVehicle(t,s){return(await pe.post(`/vehicles/update/${t}`,s)).data}static async deleteVehicle(t){await pe.get(`/vehicles/delete/${t}`)}}const pg=Object.freeze(Object.defineProperty({__proto__:null,VehicleAPI:Gt},Symbol.toStringTag,{value:"Module"}));class Au{static async getAllPayments(){return(await pe.get("/payments")).data||[]}static async getPaymentsPaginated(t={}){const s=zn(t),r=await pe.post("/payments/paginated",s);return{data:r.data.data,count:r.data.count,curPage:r.data.curPage,perPage:r.data.perPage,totalPages:r.data.totalPages,page:r.data.curPage,pageSize:r.data.perPage}}static async getContractorPayments(t,s={}){const{page:r=1,pageSize:n=10,search:o="",sortBy:i="created_at",sortOrder:c="desc"}=s;return(await pe.get(`/payments/contractor/${t}`,{page:r,pageSize:n,search:o,sortBy:i,sortOrder:c})).data}static async getAttendantPayments(t,s={}){const{page:r=1,pageSize:n=10,search:o="",sortBy:i="created_at",sortOrder:c="desc"}=s;return(await pe.get(`/payments/attendant/${t}`,{page:r,pageSize:n,search:o,sortBy:i,sortOrder:c})).data}static async getLocationPayments(t){return(await pe.get(`/payments/location/${t}`)).data||[]}static async getPaymentStats(t,s){const r={};return t&&(r.contractorId=t),s&&(r.locationId=s),(await pe.get("/payments/stats",r)).data}static async getLocationWisePayments(t){const s=t?{contractorId:t}:{},r=await pe.get("/payments/location-wise",s);return Array.isArray(r.data)?r.data:[]}static async getContractorWisePayments(){const t=await pe.get("/payments/contractor-wise");return Array.isArray(t.data)?t.data:[]}}const tl=Object.freeze(Object.defineProperty({__proto__:null,PaymentAPI:Au},Symbol.toStringTag,{value:"Module"}));class sl{static async getContractorDashboard(t){return(await pe.get(`/contractor-dashboard/${t}`)).data}static async getContractorStats(t){return(await pe.get(`/contractor-dashboard/${t}/stats`)).data}}class ps{static async getSubscriptionPlans(){return(await pe.get("/subscriptions/plans")).data||[]}static async getSubscriptionPlanById(t){return(await pe.get(`/subscriptions/plans/${t}`)).data}static async getContractorSubscription(t){return(await pe.get(`/subscriptions/contractor/${t}`)).data}static async assignSubscription(t,s,r=30){await pe.post("/subscriptions/assign",{contractorId:t,planId:s,durationDays:r})}static async extendSubscription(t,s){await pe.post(`/subscriptions/extend/${t}`,{additionalDays:s})}static async checkSubscriptionValidity(t){try{return(await this.getContractorSubscription(t))?.is_valid||!1}catch(s){return console.error("Error checking subscription validity:",s),!1}}static async getExpiryMessage(t){const s=await this.getContractorSubscription(t);return s?s.status==="expired"?`Your subscription has expired on ${new Date(s.end_date).toLocaleDateString()}. Please recharge to continue using the service.`:s.status==="suspended"?"Your subscription has been suspended. Please contact administrator for assistance.":s.days_remaining<=7&&s.days_remaining>0?`Your subscription will expire in ${s.days_remaining} days. Please recharge to avoid service interruption.`:s.days_remaining<=0?"Your subscription has expired. Please recharge to continue using the service.":"":"No subscription found. Please contact administrator to assign a subscription plan."}static async getExpiringSubscriptions(t=7){return(await pe.get("/subscriptions/expiring",{days:t})).data||[]}static async getExpiredSubscriptions(){return(await pe.get("/subscriptions/expired")).data||[]}static async updateSubscriptionPlan(t,s){return(await pe.post(`/subscriptions/plans/update/${t}`,s)).data}static async createSubscriptionPlan(t){return(await pe.post("/subscriptions/plans",t)).data}static async deleteSubscriptionPlan(t){await pe.get(`/subscriptions/plans/delete/${t}`)}static async getFinancialSummary(){return(await pe.get("/subscriptions/financial-summary")).data}}const fg=l.memo(function(){const{profile:t,user:s}=ft(),{toast:r}=Tt(),n=l.useRef(!1),[o,i]=l.useState({totalLocations:0,totalAttendants:0,totalVehicles:0,totalRevenue:0,todayRevenue:0,occupancyRate:0,todayVehicles:0}),[c,d]=l.useState({rates_2wheeler:{upTo2Hours:2,upTo6Hours:5,upTo12Hours:8,upTo24Hours:12},rates_4wheeler:{upTo2Hours:5,upTo6Hours:10,upTo12Hours:18,upTo24Hours:30}}),[u,h]=l.useState(!1),[m,p]=l.useState(!1),[f,v]=l.useState(!1),[y,w]=l.useState(null),[N,g]=l.useState(!0),[b,A]=l.useState(null),[P,E]=l.useState([]),[V,M]=l.useState(null);l.useState(!1),l.useState(!1),l.useState(null),l.useState({name:"",email:"",phone_number:"",shift_start:"",shift_end:""});const O=async()=>{if(s?.id)try{g(!0),A(null);const[_,L,C]=await Promise.all([sl.getContractorDashboard(s.id),sl.getContractorStats(s.id),I()]),T={..._,assignedLocations:_?.assignedLocations||[]};w(T),i(L||{totalLocations:0,totalAttendants:0,totalVehicles:0,totalRevenue:0,todayRevenue:0,occupancyRate:0,todayVehicles:0}),M(C)}catch(_){console.error("Error fetching contractor data:",_),A(_ instanceof Error?_.message:"Failed to fetch data")}finally{g(!1)}},I=async()=>{if(!s?.id)return null;try{const _=await ps.getContractorSubscription(s.id);return _?{planName:_.plan_name||"Unknown Plan",price:0,startDate:_.start_date||"",endDate:_.end_date||"",status:_.status||"active",daysRemaining:_.days_remaining||0}:null}catch(_){return console.error("Error fetching subscription details:",_),null}},ee=async()=>{if(s?.id)try{h(!0);const _=await kt.getContractorByUserId(s.id);_&&d({rates_2wheeler:_.rates_2wheeler||c.rates_2wheeler,rates_4wheeler:_.rates_4wheeler||c.rates_4wheeler})}catch(_){console.error("Error fetching rates:",_),r({variant:"destructive",title:"Error",description:"Failed to fetch rates"})}finally{h(!1)}},G=async()=>{if(s?.id)try{p(!0);const _=await kt.getContractorByUserId(s.id);if(!_)throw new Error("Contractor not found");await pe.post(`/contractors/update/${_.id}`,{rates_2wheeler:c.rates_2wheeler,rates_4wheeler:c.rates_4wheeler}),r({title:"Success",description:"Rates updated successfully"}),v(!1)}catch(_){console.error("Error saving rates:",_),r({variant:"destructive",title:"Error",description:"Failed to save rates"})}finally{p(!1)}},ae=(_,L,C)=>{const T=parseFloat(C)||0;d(H=>({...H,[`rates_${_}`]:{...H[`rates_${_}`],[L]:T}}))},$=async()=>{if(s?.id)try{const _=await kt.getContractorByUserId(s.id);if(!_)return;const C=(await Gt.getContractorVehicles(_.id)).filter(S=>!S.is_deleted).sort((S,q)=>new Date(q.check_in_time).getTime()-new Date(S.check_in_time).getTime()).slice(0,5),H=(await Au.getContractorPayments(_.id,{page:1,pageSize:3})).data||[],x=[];C?.forEach(S=>{const q=Y(S.check_in_time),U=S.location?.locations_name||S.parking_locations?.locations_name||"Unknown";if(x.push({id:`vehicle-${S.id}`,type:"vehicle_checkin",title:"New vehicle check-in",description:`Location: ${U}`,timeAgo:q,timestamp:S.check_in_time,icon:"green"}),S.check_out_time){const de=Y(S.check_out_time);x.push({id:`vehicle-checkout-${S.id}`,type:"vehicle_checkout",title:"Vehicle check-out",description:`Plate: ${S.plate_number}`,timeAgo:de,timestamp:S.check_out_time,icon:"blue"})}}),H?.forEach(S=>{const q=Y(S.created_at||S.created_on||""),U=S.vehicle?.plate_number||"Unknown";x.push({id:`payment-${S.id}`,type:"payment",title:"Payment received",description:`${(S.amount||0).toFixed(2)} from Vehicle ${U}`,timeAgo:q,timestamp:S.created_at||S.created_on||"",icon:"orange"})}),x.sort((S,q)=>new Date(q.timestamp).getTime()-new Date(S.timestamp).getTime()),E(x.slice(0,5))}catch(_){console.error("Error fetching recent activity:",_)}},Y=_=>{const L=new Date,C=new Date(_),T=Math.floor((L.getTime()-C.getTime())/(1e3*60));if(T<1)return"Just now";if(T<60)return`${T} min ago`;const H=Math.floor(T/60);if(H<24)return`${H} hour${H>1?"s":""} ago`;const x=Math.floor(H/24);return`${x} day${x>1?"s":""} ago`},Z=_=>{if(!_)return"N/A";try{return new Date(_).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}};return l.useEffect(()=>{s&&!n.current&&(console.log("ContractorDashboard: Initial data fetch triggered"),n.current=!0,O(),$(),ee())},[s?.id]),N?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})}):b?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600",children:"Error"}),e.jsx("p",{className:"text-muted-foreground",children:b})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-extrabold tracking-tight bg-gradient-to-r from-amber-400 via-pink-400 to-rose-400 bg-clip-text text-transparent",children:"Contractor Dashboard"}),e.jsxs("p",{className:"text-slate-600",children:["Welcome back, ",t?.user_name||"Contractor","! Manage your parking operations"]})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(F,{variant:"outline",className:"bg-white/50 backdrop-blur",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"View Reports"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Pe,{title:"Total Locations",value:o.totalLocations,description:"Active parking sites",icon:rs,variant:"success"}),e.jsx(Pe,{title:"Active Attendants",value:o.totalAttendants,description:"On-duty staff",icon:Wt,variant:"warning"}),e.jsx(Pe,{title:"Total Vehicles",value:o.totalVehicles,description:"All-time processed",icon:ot,variant:"info"}),e.jsx(Pe,{title:"Today's Vehicles",value:o.todayVehicles,description:"Checked in today",icon:ot,variant:"default"}),e.jsx(Pe,{title:"Today's Revenue",value:`${(o.todayRevenue||0).toFixed(2)}`,description:"+12% from yesterday",icon:vs,variant:"success"}),e.jsx(Pe,{title:"Total Revenue",value:`${(o.totalRevenue||0).toFixed(2)}`,description:"Lifetime earnings",icon:Us,variant:"success"}),e.jsx(Pe,{title:"Occupancy Rate",value:`${o.occupancyRate}%`,description:"Current utilization",icon:ta,variant:o.occupancyRate>80?"danger":o.occupancyRate>60?"warning":"success"})]}),V&&e.jsxs(_e,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 rounded-xl",children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Be,{className:"flex items-center space-x-2 text-blue-900",children:[e.jsx(Vi,{className:"h-5 w-5"}),e.jsx("span",{children:"Your Subscription Plan"})]}),e.jsx(et,{className:"text-blue-700",children:"Current subscription details and status"})]}),e.jsxs(Je,{variant:V.status==="active"?"default":"destructive",className:V.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:[V.status==="active"?e.jsx(Rt,{className:"h-3 w-3 mr-1"}):e.jsx(cn,{className:"h-3 w-3 mr-1"}),V.status]})]})}),e.jsxs(Ee,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Vi,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Plan Name"})]}),e.jsx("p",{className:"text-lg font-semibold text-blue-900",children:V.planName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vs,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Price"})]}),e.jsxs("p",{className:"text-lg font-semibold text-blue-900",children:["",V.price]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ps,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Days Remaining"})]}),e.jsxs("p",{className:`text-lg font-semibold ${V.daysRemaining<=7?"text-red-600":V.daysRemaining<=30?"text-orange-600":"text-green-600"}`,children:[V.daysRemaining," days"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qs,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Expires On"})]}),e.jsx("p",{className:"text-lg font-semibold text-blue-900",children:Z(V.endDate)})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-blue-800",children:[e.jsx(Ps,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm",children:["Started on ",Z(V.startDate)]})]}),V.daysRemaining<=7&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2 text-red-700",children:[e.jsx(cn,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Your subscription expires soon! Contact support to renew."})]})]})]})]}),!V&&e.jsxs(_e,{className:"bg-gradient-to-r from-orange-50 to-red-50 border-orange-200 rounded-xl",children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center space-x-2 text-orange-900",children:[e.jsx(cn,{className:"h-5 w-5"}),e.jsx("span",{children:"No Active Subscription"})]}),e.jsx(et,{className:"text-orange-700",children:"You don't have an active subscription plan"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-800 mb-2",children:"Contact your administrator to get a subscription plan assigned to your account."}),e.jsx("p",{className:"text-sm text-orange-600",children:"Without a subscription, you may have limited access to certain features."})]}),e.jsx(F,{variant:"outline",className:"border-orange-300 text-orange-700 hover:bg-orange-100",children:"Contact Support"})]})})]}),e.jsxs(_e,{className:"bg-white/40 backdrop-blur-xl border-white/30 rounded-xl",children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Be,{className:"flex items-center space-x-2",children:[e.jsx(vs,{className:"h-5 w-5"}),e.jsx("span",{children:"Your Parking Rates"})]}),e.jsx(et,{children:"Current rates assigned to your account. You can update these rates anytime."})]}),e.jsxs(F,{variant:"outline",onClick:()=>v(!0),className:"bg-white/50 backdrop-blur",children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Edit Rates"]})]})}),e.jsx(Ee,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"2-Wheeler Rates"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 2 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_2wheeler.upTo2Hours]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 6 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_2wheeler.upTo6Hours]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 12 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_2wheeler.upTo12Hours]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 24 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_2wheeler.upTo24Hours]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-sm text-muted-foreground",children:"4-Wheeler Rates"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 2 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_4wheeler.upTo2Hours]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 6 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_4wheeler.upTo6Hours]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 12 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_4wheeler.upTo12Hours]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:"Up to 24 hours"}),e.jsxs("span",{className:"font-medium",children:["",c.rates_4wheeler.upTo24Hours]})]})]})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(_e,{className:"bg-white/40 backdrop-blur-xl border-white/30 rounded-xl",children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Recent Activity"}),e.jsx(et,{children:"Latest system events and updates"})]}),e.jsx(Ee,{children:e.jsx("div",{className:"space-y-4",children:P.length>0?P.map(_=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${_.icon==="green"?"bg-green-500":_.icon==="blue"?"bg-blue-500":_.icon==="orange"?"bg-orange-500":"bg-gray-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:_.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:_.description})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:_.timeAgo})]},_.id)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No recent activity"})})})})]})}),e.jsxs(_e,{className:"bg-white/40 backdrop-blur-xl border-white/30 rounded-xl",children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Your Locations"}),e.jsx(et,{children:"Manage and monitor your parking locations"})]}),e.jsx(Ee,{children:N?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading locations..."})}):b?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-red-500",children:["Error: ",b]})}):!y?.assignedLocations||y.assignedLocations.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[e.jsx(rs,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No locations found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your account has no assigned locations yet. Contact your administrator or create sample data for testing."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Contact your administrator to assign parking locations to your account."})]}):e.jsx("div",{className:"space-y-4",children:y?.assignedLocations.map((_,L)=>{const C=L%3===0?"text-blue-500":L%3===1?"text-green-500":"text-orange-500",T=_.status==="active"?"bg-green-50 text-green-700":"bg-red-50 text-red-700";return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(rs,{className:`h-5 w-5 ${C}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:_.locationName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:_.address}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[_.totalSlots," slots  ",_.occupancyRate,"% occupied"]}),_.attendants&&_.attendants.length>0&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[_.attendants.length," attendant(s) assigned"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Je,{variant:"outline",className:T,children:_.status}),e.jsx(F,{variant:"ghost",size:"sm",children:e.jsx(os,{className:"h-4 w-4"})})]})]},_.locationId)})})})]}),e.jsx(bt,{open:f,onOpenChange:v,children:e.jsxs(yt,{className:"max-w-2xl",children:[e.jsxs(wt,{children:[e.jsx(jt,{children:"Edit Parking Rates"}),e.jsx(At,{children:"Update your parking rates for different vehicle types and durations"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"2-Wheeler Rates"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"2wheeler-2h",children:"Up to 2 hours"}),e.jsx(ge,{id:"2wheeler-2h",type:"number",value:c.rates_2wheeler.upTo2Hours,onChange:_=>ae("2wheeler","upTo2Hours",_.target.value),className:"pl-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"2wheeler-6h",children:"Up to 6 hours"}),e.jsx(ge,{id:"2wheeler-6h",type:"number",value:c.rates_2wheeler.upTo6Hours,onChange:_=>ae("2wheeler","upTo6Hours",_.target.value),className:"pl-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"2wheeler-12h",children:"Up to 12 hours"}),e.jsx(ge,{id:"2wheeler-12h",type:"number",value:c.rates_2wheeler.upTo12Hours,onChange:_=>ae("2wheeler","upTo12Hours",_.target.value),className:"pl-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"2wheeler-24h",children:"Up to 24 hours"}),e.jsx(ge,{id:"2wheeler-24h",type:"number",value:c.rates_2wheeler.upTo24Hours,onChange:_=>ae("2wheeler","upTo24Hours",_.target.value),className:"pl-8"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"4-Wheeler Rates"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"4wheeler-2h",children:"Up to 2 hours"}),e.jsx(ge,{id:"4wheeler-2h",type:"number",value:c.rates_4wheeler.upTo2Hours,onChange:_=>ae("4wheeler","upTo2Hours",_.target.value),className:"pl-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"4wheeler-6h",children:"Up to 6 hours"}),e.jsx(ge,{id:"4wheeler-6h",type:"number",value:c.rates_4wheeler.upTo6Hours,onChange:_=>ae("4wheeler","upTo6Hours",_.target.value),className:"pl-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"4wheeler-12h",children:"Up to 12 hours"}),e.jsx(ge,{id:"4wheeler-12h",type:"number",value:c.rates_4wheeler.upTo12Hours,onChange:_=>ae("4wheeler","upTo12Hours",_.target.value),className:"pl-8"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"4wheeler-24h",children:"Up to 24 hours"}),e.jsx(ge,{id:"4wheeler-24h",type:"number",value:c.rates_4wheeler.upTo24Hours,onChange:_=>ae("4wheeler","upTo24Hours",_.target.value),className:"pl-8"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(F,{variant:"outline",onClick:()=>v(!1),disabled:m,children:"Cancel"}),e.jsx(F,{onClick:G,disabled:m,children:m?"Saving...":"Save Rates"})]})]})]})})]})}),Yr=({className:a,...t})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:ce("mx-auto flex w-full justify-center",a),...t});Yr.displayName="Pagination";const Gr=l.forwardRef(({className:a,...t},s)=>e.jsx("ul",{ref:s,className:ce("flex flex-row items-center gap-1",a),...t}));Gr.displayName="PaginationContent";const Et=l.forwardRef(({className:a,...t},s)=>e.jsx("li",{ref:s,className:ce("",a),...t}));Et.displayName="PaginationItem";const $a=({className:a,isActive:t,size:s="icon",...r})=>e.jsx("a",{"aria-current":t?"page":void 0,className:ce(Un({variant:t?"outline":"ghost",size:s}),a),...r});$a.displayName="PaginationLink";const Zr=({className:a,...t})=>e.jsxs($a,{"aria-label":"Go to previous page",size:"default",className:ce("gap-1 pl-2.5",a),...t,children:[e.jsx(ti,{className:"h-4 w-4"}),e.jsx("span",{children:"Previous"})]});Zr.displayName="PaginationPrevious";const Kr=({className:a,...t})=>e.jsxs($a,{"aria-label":"Go to next page",size:"default",className:ce("gap-1 pr-2.5",a),...t,children:[e.jsx("span",{children:"Next"}),e.jsx(On,{className:"h-4 w-4"})]});Kr.displayName="PaginationNext";const Qr=({className:a,...t})=>e.jsxs("span",{"aria-hidden":!0,className:ce("flex h-9 w-9 items-center justify-center",a),...t,children:[e.jsx(yo,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});Qr.displayName="PaginationEllipsis";const Eu=l.memo(function(){const{profile:t,user:s}=ft(),r=t?.role==="super_admin",n=t?.role==="contractor",o=t?.role==="attendant",[i,c]=l.useState([]),[d,u]=l.useState(!0),[h,m]=l.useState(null),[p,f]=l.useState(!1),[v,y]=l.useState(null),[w,N]=l.useState([]),[g,b]=l.useState([]),[A,P]=l.useState(null),[E,V]=l.useState(!1),[M,O]=l.useState({user_name:"",email:"",password:"",phone_number:"",location_id:"none",contractor_id:"",status:"active"}),[I,ee]=l.useState({page:1,pageSize:10,totalPages:0,totalCount:0}),[G,ae]=l.useState(""),[$,Y]=l.useState(""),[Z,_]=l.useState(!1),[L,C]=l.useState("created_on"),[T,H]=l.useState("desc"),x=l.useRef(!1),{toast:S}=Tt(),q=l.useMemo(()=>({totalAttendants:I.totalCount,activeAttendants:i.filter(K=>K.status==="active").length,assignedLocations:i.filter(K=>K.location_id).length,averageHours:0}),[i,I.totalCount]),U=async(K=I.page,Ne=G,Ve=L,Ge=T)=>{try{u(!0),console.log("Fetching data...",{page:K,searchTerm:Ne,sort:Ve,order:Ge});const j={page:K,pageSize:I.pageSize,search:Ne,sortBy:Ve,sortOrder:Ge};console.log("Fetching attendants with params:",j);let R;if(t?.role==="contractor"&&s?.id){const{AuthAPI:ve}=await Ye(async()=>{const{AuthAPI:ct}=await Promise.resolve().then(()=>Bt);return{AuthAPI:ct}},void 0);let Te=ve.getContractor();if(Te)P(Te);else try{Te=await kt.getContractorByUserId(s.id),Te&&ve.setContractor(Te)}catch(ct){console.error("Failed to fetch contractor data:",ct),Te=null}R=await oa.getAttendantsByContractor(s.id,j),P(Te)}else t?.role==="attendant"&&s?.id?(R=await oa.getAttendantByUserId(s.id),R={data:R?[R]:[],count:R?1:0,page:1,pageSize:1,totalPages:1}):R=await oa.getAllAttendants(j);let W,me;n&&s?.id?(W=Promise.resolve([]),me=es.getContractorLocations(s.id)):(W=Ot.getAllContractors(),me=es.getAllLocations());const[se,re]=await Promise.all([W,me]);console.log("Attendants result:",R),console.log("Contractors:",se),console.log("Locations:",re),c(R.data),N(se),b(re),ee(ve=>({...ve,page:R.page,totalPages:R.totalPages,totalCount:R.count}))}catch(j){console.error("Error fetching data:",j),S({variant:"destructive",title:"Error",description:j?.message||"Failed to load attendants"})}finally{u(!1)}};l.useEffect(()=>{t&&s&&!x.current&&(console.log("Attendants: Initial data fetch triggered"),x.current=!0,U())},[t?.role,s?.id]),l.useEffect(()=>{const K=setTimeout(()=>{$!==G&&Q($)},500);return()=>clearTimeout(K)},[$]);const de=K=>{ee(Ne=>({...Ne,page:K})),U(K,G,L,T)},Q=async K=>{ae(K),ee(Ne=>({...Ne,page:1})),_(!0);try{await U(1,K,L,T)}finally{_(!1)}},z=K=>{const Ne=L===K&&T==="desc"?"asc":"desc";C(K),H(Ne),ee(Ve=>({...Ve,page:1})),U(1,G,K,Ne)},D=K=>{ee(Ne=>({...Ne,pageSize:K,page:1})),U(1,G,L,T)},X=async()=>{y(null);let K="";if(n&&s){const{AuthAPI:Ne}=await Ye(async()=>{const{AuthAPI:Ge}=await Promise.resolve().then(()=>Bt);return{AuthAPI:Ge}},void 0),Ve=Ne.getContractor();if(Ve&&Ve.id)K=Ve.id,P(Ve);else if(A&&A.id)K=A.id;else try{const Ge=await kt.getContractorByUserId(s.id);Ge&&Ge.id&&(K=Ge.id,P(Ge))}catch(Ge){console.error("Failed to fetch contractor data:",Ge)}}O({user_name:"",email:"",password:"",phone_number:"",location_id:"none",contractor_id:K,status:"active"}),f(!0)},B=K=>{y(K),O({user_name:K.profiles?.user_name||"",email:K.profiles?.email||"",phone_number:K.profiles?.phone_number||"",location_id:K.location_id||"none",contractor_id:K.parking_locations?.contractors?.company_name&&w.find(Ne=>Ne.company_name===K.parking_locations?.contractors?.company_name)?.id||"",status:K.status||"active"}),f(!0)},oe=async()=>{try{if(!M.user_name||!M.email){S({variant:"destructive",title:"Validation",description:"Please fill all required fields"});return}if(n&&s&&!M.contractor_id){const{AuthAPI:Ne}=await Ye(async()=>{const{AuthAPI:Ge}=await Promise.resolve().then(()=>Bt);return{AuthAPI:Ge}},void 0),Ve=Ne.getContractor();if(Ve&&Ve.id)O({...M,contractor_id:Ve.id});else if(A&&A.id)O({...M,contractor_id:A.id});else{S({variant:"destructive",title:"Error",description:"Contractor information not found. Please refresh the page."});return}}if(!M.contractor_id){S({variant:"destructive",title:"Validation",description:"Contractor is required"});return}V(!0);const K={...M,location_id:M.location_id==="none"?"":M.location_id};if(n&&s&&!v&&K.location_id){const{AuthAPI:Ne}=await Ye(async()=>{const{AuthAPI:Ge}=await Promise.resolve().then(()=>Bt);return{AuthAPI:Ge}},void 0),Ve=Ne.getContractor()||A;if(Ve){const Ge=i.filter(R=>R.location_id===K.location_id).length,j=Ve.allowed_attendants_per_location||0;if(Ge>=j){S({variant:"destructive",title:"Limit Reached",description:`You have reached the maximum limit of ${j} attendants per location. Please contact admin to increase your limit.`}),V(!1);return}}}if(v){console.log("Updating attendant with data:",K);const Ne=await Ot.updateAttendant(v.id,K);console.log("Updated attendant result:",Ne),S({title:"Updated",description:"Attendant updated"})}else{if(!M.password){S({variant:"destructive",title:"Validation",description:"Password is required for new attendants"}),V(!1);return}console.log("Creating attendant with data:",K),await Ot.createAttendant(K),S({title:"Created",description:"Attendant created successfully"})}f(!1),y(null),console.log("Refreshing data after update..."),await U()}catch(K){console.error("Error saving attendant:",K),S({variant:"destructive",title:"Error",description:K?.message||"Failed to save"})}finally{V(!1)}},Ae=async K=>{try{m(K),await Ot.deleteAttendant(K),S({title:"Deleted",description:"Attendant deleted"}),U()}catch(Ne){S({variant:"destructive",title:"Error",description:Ne?.message||"Failed to delete"})}finally{m(null)}},Ce=l.useMemo(()=>{if(n&&s)try{const{AuthAPI:K}=require("@/services/authApi");return K.getContractor()||A}catch{return A}return A},[n,s,A]),Ie=l.useMemo(()=>n&&Ce?g.filter(K=>K.contractor_id===Ce.id):M.contractor_id?g.filter(K=>K.contractor_id===M.contractor_id):[],[M.contractor_id,g,n,Ce]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Attendants"}),e.jsx("p",{className:"text-muted-foreground",children:t?.role==="attendant"?"View your profile and assignment details":"Manage on-site staff and their assignments"})]}),(r||n)&&e.jsxs(F,{onClick:X,children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Attendant"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(Pe,{title:"Total Attendants",value:q.totalAttendants,description:"Registered staff",icon:Wt,variant:"info"}),e.jsx(Pe,{title:"Active Attendants",value:q.activeAttendants,description:"Currently working",icon:Rt,variant:"success"}),e.jsx(Pe,{title:"Assigned Locations",value:q.assignedLocations,description:"Active assignments",icon:rs,variant:"warning"}),e.jsx(Pe,{title:"Average Hours",value:`${q.averageHours}h`,description:"Per day",icon:qs,variant:"default"})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Be,{children:[t?.role==="attendant"?"Your Profile":"Attendant List",G&&e.jsxs("span",{className:"ml-2 text-sm font-normal text-muted-foreground",children:['(Search results for "',G,'")']})]}),e.jsx(et,{children:t?.role==="attendant"?"View your profile and assignment details":"View and manage all staff members"})]}),t?.role!=="attendant"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx(ua,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search attendants...",value:$,onChange:K=>Y(K.target.value),className:"pl-8 pr-8 w-full sm:w-64",disabled:Z}),Z?e.jsx("div",{className:"absolute right-2 top-2.5 h-4 w-4 animate-spin rounded-full border-2 border-gray-300 border-t-blue-600"}):$?e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>{Y(""),Q("")},className:"absolute right-1 top-1 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Ds,{className:"h-3 w-3"})}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show:"}),e.jsxs(Lt,{value:I.pageSize.toString(),onValueChange:K=>D(Number(K)),children:[e.jsx(Ct,{className:"w-20",children:e.jsx(Mt,{})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"5",children:"5"}),e.jsx($e,{value:"10",children:"10"}),e.jsx($e,{value:"20",children:"20"}),e.jsx($e,{value:"50",children:"50"})]})]})]})]})]})}),e.jsxs(Ee,{children:[d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-parkflow-blue mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading attendants..."})]}):i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Wt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No attendants found"}),!r&&e.jsx("p",{className:"text-muted-foreground",children:"Your account has no attendants yet."}),(r||n)&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Get started by adding your first attendant"}),e.jsxs(F,{onClick:X,children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add First Attendant"]})]})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Hr,{children:[e.jsx(qr,{children:e.jsxs(Bs,{children:[e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>z("profiles.user_name"),className:"h-auto p-0 font-semibold",children:["Name",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>z("profiles.email"),className:"h-auto p-0 font-semibold",children:["Email",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),e.jsx(tt,{children:"Phone"}),e.jsx(tt,{children:"Location"}),e.jsx(tt,{children:"Contractor"}),e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>z("status"),className:"h-auto p-0 font-semibold",children:["Status",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),(r||n||o)&&e.jsx(tt,{children:"Actions"})]})}),e.jsx(Wr,{children:i.map(K=>e.jsxs(Bs,{children:[e.jsx(st,{className:"font-medium",children:K.profiles?.user_name||"-"}),e.jsx(st,{children:K.profiles?.email||"-"}),e.jsx(st,{children:K.profiles?.phone_number||"-"}),e.jsx(st,{children:K.parking_locations?.locations_name||"Not assigned"}),e.jsx(st,{children:K.parking_locations?.contractors?.company_name||"-"}),e.jsx(st,{children:e.jsx(Je,{variant:K.status==="active"?"default":"secondary",children:K.status||"inactive"})}),(r||n||o)&&e.jsx(st,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>B(K),disabled:h!==null,children:e.jsx(ha,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>Ae(K.id),disabled:h!==null,children:h===K.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):e.jsx(As,{className:"h-4 w-4"})})]})})]},K.id))})]})}),t?.role!=="attendant"&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-4 border-t bg-gray-50/50",children:[e.jsxs("div",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",(I.page-1)*I.pageSize+1," to ",Math.min(I.page*I.pageSize,I.totalCount)," of ",I.totalCount," results",e.jsx("br",{}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Page ",I.page," of ",I.totalPages," | Page Size: ",I.pageSize]})]}),I.totalPages>1&&e.jsx(Yr,{children:e.jsxs(Gr,{children:[e.jsx(Et,{children:e.jsx(Zr,{onClick:()=>de(I.page-1),className:I.page===1?"pointer-events-none opacity-50":"cursor-pointer hover:bg-gray-100"})}),Array.from({length:Math.min(5,I.totalPages)},(K,Ne)=>{let Ve;return I.totalPages<=5||I.page<=3?Ve=Ne+1:I.page>=I.totalPages-2?Ve=I.totalPages-4+Ne:Ve=I.page-2+Ne,e.jsx(Et,{children:e.jsx($a,{onClick:()=>de(Ve),isActive:I.page===Ve,className:"cursor-pointer hover:bg-gray-100",children:Ve})},Ve)}),I.totalPages>5&&I.page<I.totalPages-2&&e.jsx(Et,{children:e.jsx(Qr,{})}),e.jsx(Et,{children:e.jsx(Kr,{onClick:()=>de(I.page+1),className:I.page===I.totalPages?"pointer-events-none opacity-50":"cursor-pointer hover:bg-gray-100"})})]})})]})]})]}),e.jsx(bt,{open:p,onOpenChange:f,children:e.jsxs(yt,{className:"max-w-2xl",children:[e.jsxs(wt,{children:[e.jsx(jt,{children:v?"Edit Attendant":"Add Attendant"}),e.jsxs(At,{children:[v?"Update attendant information":"Create a new attendant account",n&&Ce&&!v&&M.location_id&&M.location_id!=="none"&&(()=>{const K=i.filter(Ne=>Ne.location_id===M.location_id).length;return e.jsxs("span",{className:"block mt-1 text-xs",children:["Attendants at this location: ",K," / ",Ce.allowed_attendants_per_location||0," allowed",K>=(Ce.allowed_attendants_per_location||0)&&e.jsx("span",{className:"text-red-500 ml-2",children:"(Limit reached for this location)"})]})})()]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"user_name",children:"Full Name *"}),e.jsx(ge,{id:"user_name",value:M.user_name||"",onChange:K=>O({...M,user_name:K.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",children:"Email *"}),e.jsx(ge,{id:"email",type:"email",value:M.email||"",onChange:K=>O({...M,email:K.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(ge,{id:"phone_number",value:M.phone_number||"",onChange:K=>O({...M,phone_number:K.target.value}),placeholder:"Enter phone number"})]}),!v&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",children:"Password *"}),e.jsx(ge,{id:"password",type:"password",value:M.password||"",onChange:K=>O({...M,password:K.target.value}),placeholder:"Enter password"})]}),r&&e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(te,{children:"Contractor *"}),e.jsxs(Lt,{value:M.contractor_id||"",onValueChange:K=>O({...M,contractor_id:K,location_id:""}),children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select contractor"})}),e.jsx(Pt,{children:w.length===0?e.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No contractors found"}):w.map(K=>e.jsx($e,{value:K.id,children:K.company_name||K.profiles?.user_name||K.profiles?.email},K.id))})]})]}),n&&Ce&&e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(te,{children:"Contractor"}),e.jsx(ge,{value:Ce.company_name||Ce.profiles?.user_name||"Your Account",disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Assigned Location"}),e.jsxs(Lt,{value:M.location_id||"none",onValueChange:K=>O({...M,location_id:K==="none"?"":K}),children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select location (optional)"})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"none",children:"No location assigned"}),Ie.map(K=>e.jsxs($e,{value:K.id,children:[K.locations_name," - ",K.address]},K.id))]})]}),M.contractor_id&&Ie.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No locations available for selected contractor"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Status"}),e.jsxs(Lt,{value:M.status||"active",onValueChange:K=>O({...M,status:K}),children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select status"})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"active",children:"Active"}),e.jsx($e,{value:"inactive",children:"Inactive"})]})]})]})]}),e.jsxs(Kn,{children:[e.jsx(F,{variant:"outline",onClick:()=>f(!1),disabled:E,children:"Cancel"}),e.jsx(F,{onClick:oe,disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),v?"Updating...":"Creating..."]}):v?"Update":"Create"})]})]})})]})});function xg(){const{profile:a}=ft();if(!a)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})});switch(a.role){case"super_admin":return e.jsx(hg,{});case"contractor":return e.jsx(fg,{});case"attendant":return e.jsx(Eu,{});default:return e.jsx("div",{className:"text-center py-12",children:e.jsxs("h2",{className:"text-xl font-semibold text-muted-foreground",children:["Invalid role: ",a.role]})})}}var Jr=a=>a.type==="checkbox",_a=a=>a instanceof Date,Vt=a=>a==null;const Ru=a=>typeof a=="object";var pt=a=>!Vt(a)&&!Array.isArray(a)&&Ru(a)&&!_a(a),gg=a=>pt(a)&&a.target?Jr(a.target)?a.target.checked:a.target.value:a,vg=a=>a.substring(0,a.search(/\.\d+(\.|$)/))||a,yg=(a,t)=>a.has(vg(t)),bg=a=>{const t=a.constructor&&a.constructor.prototype;return pt(t)&&t.hasOwnProperty("isPrototypeOf")},ki=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function St(a){let t;const s=Array.isArray(a),r=typeof FileList<"u"?a instanceof FileList:!1;if(a instanceof Date)t=new Date(a);else if(!(ki&&(a instanceof Blob||r))&&(s||pt(a)))if(t=s?[]:{},!s&&!bg(a))t=a;else for(const n in a)a.hasOwnProperty(n)&&(t[n]=St(a[n]));else return a;return t}var Jn=a=>/^\w*$/.test(a),vt=a=>a===void 0,Ci=a=>Array.isArray(a)?a.filter(Boolean):[],Pi=a=>Ci(a.replace(/["|']|\]/g,"").split(/\.|\[/)),we=(a,t,s)=>{if(!t||!pt(a))return s;const r=(Jn(t)?[t]:Pi(t)).reduce((n,o)=>Vt(n)?n:n[o],a);return vt(r)||r===a?vt(a[t])?s:a[t]:r},Ns=a=>typeof a=="boolean",at=(a,t,s)=>{let r=-1;const n=Jn(t)?[t]:Pi(t),o=n.length,i=o-1;for(;++r<o;){const c=n[r];let d=s;if(r!==i){const u=a[c];d=pt(u)||Array.isArray(u)?u:isNaN(+n[r+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;a[c]=d,a=a[c]}};const al={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},xs={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ls={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},wg=le.createContext(null);wg.displayName="HookFormContext";var jg=(a,t,s,r=!0)=>{const n={defaultValues:t._defaultValues};for(const o in a)Object.defineProperty(n,o,{get:()=>{const i=o;return t._proxyFormState[i]!==xs.all&&(t._proxyFormState[i]=!r||xs.all),a[i]}});return n};const Ng=typeof window<"u"?le.useLayoutEffect:le.useEffect;var Cs=a=>typeof a=="string",_g=(a,t,s,r,n)=>Cs(a)?(r&&t.watch.add(a),we(s,a,n)):Array.isArray(a)?a.map(o=>(r&&t.watch.add(o),we(s,o))):(r&&(t.watchAll=!0),s),Io=a=>Vt(a)||!Ru(a);function Zs(a,t,s=new WeakSet){if(Io(a)||Io(t))return a===t;if(_a(a)&&_a(t))return a.getTime()===t.getTime();const r=Object.keys(a),n=Object.keys(t);if(r.length!==n.length)return!1;if(s.has(a)||s.has(t))return!0;s.add(a),s.add(t);for(const o of r){const i=a[o];if(!n.includes(o))return!1;if(o!=="ref"){const c=t[o];if(_a(i)&&_a(c)||pt(i)&&pt(c)||Array.isArray(i)&&Array.isArray(c)?!Zs(i,c,s):i!==c)return!1}}return!0}var Tu=(a,t,s,r,n)=>t?{...s[a],types:{...s[a]&&s[a].types?s[a].types:{},[r]:n||!0}}:{},jr=a=>Array.isArray(a)?a:[a],rl=()=>{let a=[];return{get observers(){return a},next:n=>{for(const o of a)o.next&&o.next(n)},subscribe:n=>(a.push(n),{unsubscribe:()=>{a=a.filter(o=>o!==n)}}),unsubscribe:()=>{a=[]}}},Ht=a=>pt(a)&&!Object.keys(a).length,Ai=a=>a.type==="file",gs=a=>typeof a=="function",yn=a=>{if(!ki)return!1;const t=a?a.ownerDocument:0;return a instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Du=a=>a.type==="select-multiple",Ei=a=>a.type==="radio",Sg=a=>Ei(a)||Jr(a),co=a=>yn(a)&&a.isConnected;function kg(a,t){const s=t.slice(0,-1).length;let r=0;for(;r<s;)a=vt(a)?r++:a[t[r++]];return a}function Cg(a){for(const t in a)if(a.hasOwnProperty(t)&&!vt(a[t]))return!1;return!0}function gt(a,t){const s=Array.isArray(t)?t:Jn(t)?[t]:Pi(t),r=s.length===1?a:kg(a,s),n=s.length-1,o=s[n];return r&&delete r[o],n!==0&&(pt(r)&&Ht(r)||Array.isArray(r)&&Cg(r))&&gt(a,s.slice(0,-1)),a}var Iu=a=>{for(const t in a)if(gs(a[t]))return!0;return!1};function bn(a,t={}){const s=Array.isArray(a);if(pt(a)||s)for(const r in a)Array.isArray(a[r])||pt(a[r])&&!Iu(a[r])?(t[r]=Array.isArray(a[r])?[]:{},bn(a[r],t[r])):Vt(a[r])||(t[r]=!0);return t}function Ou(a,t,s){const r=Array.isArray(a);if(pt(a)||r)for(const n in a)Array.isArray(a[n])||pt(a[n])&&!Iu(a[n])?vt(t)||Io(s[n])?s[n]=Array.isArray(a[n])?bn(a[n],[]):{...bn(a[n])}:Ou(a[n],Vt(t)?{}:t[n],s[n]):s[n]=!Zs(a[n],t[n]);return s}var pr=(a,t)=>Ou(a,t,bn(t));const nl={value:!1,isValid:!1},ol={value:!0,isValid:!0};var Lu=a=>{if(Array.isArray(a)){if(a.length>1){const t=a.filter(s=>s&&s.checked&&!s.disabled).map(s=>s.value);return{value:t,isValid:!!t.length}}return a[0].checked&&!a[0].disabled?a[0].attributes&&!vt(a[0].attributes.value)?vt(a[0].value)||a[0].value===""?ol:{value:a[0].value,isValid:!0}:ol:nl}return nl},Mu=(a,{valueAsNumber:t,valueAsDate:s,setValueAs:r})=>vt(a)?a:t?a===""?NaN:a&&+a:s&&Cs(a)?new Date(a):r?r(a):a;const il={isValid:!1,value:null};var Fu=a=>Array.isArray(a)?a.reduce((t,s)=>s&&s.checked&&!s.disabled?{isValid:!0,value:s.value}:t,il):il;function ll(a){const t=a.ref;return Ai(t)?t.files:Ei(t)?Fu(a.refs).value:Du(t)?[...t.selectedOptions].map(({value:s})=>s):Jr(t)?Lu(a.refs).value:Mu(vt(t.value)?a.ref.value:t.value,a)}var Pg=(a,t,s,r)=>{const n={};for(const o of a){const i=we(t,o);i&&at(n,o,i._f)}return{criteriaMode:s,names:[...a],fields:n,shouldUseNativeValidation:r}},wn=a=>a instanceof RegExp,fr=a=>vt(a)?a:wn(a)?a.source:pt(a)?wn(a.value)?a.value.source:a.value:a,cl=a=>({isOnSubmit:!a||a===xs.onSubmit,isOnBlur:a===xs.onBlur,isOnChange:a===xs.onChange,isOnAll:a===xs.all,isOnTouch:a===xs.onTouched});const dl="AsyncFunction";var Ag=a=>!!a&&!!a.validate&&!!(gs(a.validate)&&a.validate.constructor.name===dl||pt(a.validate)&&Object.values(a.validate).find(t=>t.constructor.name===dl)),Eg=a=>a.mount&&(a.required||a.min||a.max||a.maxLength||a.minLength||a.pattern||a.validate),ul=(a,t,s)=>!s&&(t.watchAll||t.watch.has(a)||[...t.watch].some(r=>a.startsWith(r)&&/^\.\w+/.test(a.slice(r.length))));const Nr=(a,t,s,r)=>{for(const n of s||Object.keys(a)){const o=we(a,n);if(o){const{_f:i,...c}=o;if(i){if(i.refs&&i.refs[0]&&t(i.refs[0],n)&&!r)return!0;if(i.ref&&t(i.ref,i.name)&&!r)return!0;if(Nr(c,t))break}else if(pt(c)&&Nr(c,t))break}}};function hl(a,t,s){const r=we(a,s);if(r||Jn(s))return{error:r,name:s};const n=s.split(".");for(;n.length;){const o=n.join("."),i=we(t,o),c=we(a,o);if(i&&!Array.isArray(i)&&s!==o)return{name:s};if(c&&c.type)return{name:o,error:c};if(c&&c.root&&c.root.type)return{name:`${o}.root`,error:c.root};n.pop()}return{name:s}}var Rg=(a,t,s,r)=>{s(a);const{name:n,...o}=a;return Ht(o)||Object.keys(o).length>=Object.keys(t).length||Object.keys(o).find(i=>t[i]===(!r||xs.all))},Tg=(a,t,s)=>!a||!t||a===t||jr(a).some(r=>r&&(s?r===t:r.startsWith(t)||t.startsWith(r))),Dg=(a,t,s,r,n)=>n.isOnAll?!1:!s&&n.isOnTouch?!(t||a):(s?r.isOnBlur:n.isOnBlur)?!a:(s?r.isOnChange:n.isOnChange)?a:!0,Ig=(a,t)=>!Ci(we(a,t)).length&&gt(a,t),Og=(a,t,s)=>{const r=jr(we(a,s));return at(r,"root",t[s]),at(a,s,r),a},un=a=>Cs(a);function ml(a,t,s="validate"){if(un(a)||Array.isArray(a)&&a.every(un)||Ns(a)&&!a)return{type:s,message:un(a)?a:"",ref:t}}var Ba=a=>pt(a)&&!wn(a)?a:{value:a,message:""},pl=async(a,t,s,r,n,o)=>{const{ref:i,refs:c,required:d,maxLength:u,minLength:h,min:m,max:p,pattern:f,validate:v,name:y,valueAsNumber:w,mount:N}=a._f,g=we(s,y);if(!N||t.has(y))return{};const b=c?c[0]:i,A=G=>{n&&b.reportValidity&&(b.setCustomValidity(Ns(G)?"":G||""),b.reportValidity())},P={},E=Ei(i),V=Jr(i),M=E||V,O=(w||Ai(i))&&vt(i.value)&&vt(g)||yn(i)&&i.value===""||g===""||Array.isArray(g)&&!g.length,I=Tu.bind(null,y,r,P),ee=(G,ae,$,Y=Ls.maxLength,Z=Ls.minLength)=>{const _=G?ae:$;P[y]={type:G?Y:Z,message:_,ref:i,...I(G?Y:Z,_)}};if(o?!Array.isArray(g)||!g.length:d&&(!M&&(O||Vt(g))||Ns(g)&&!g||V&&!Lu(c).isValid||E&&!Fu(c).isValid)){const{value:G,message:ae}=un(d)?{value:!!d,message:d}:Ba(d);if(G&&(P[y]={type:Ls.required,message:ae,ref:b,...I(Ls.required,ae)},!r))return A(ae),P}if(!O&&(!Vt(m)||!Vt(p))){let G,ae;const $=Ba(p),Y=Ba(m);if(!Vt(g)&&!isNaN(g)){const Z=i.valueAsNumber||g&&+g;Vt($.value)||(G=Z>$.value),Vt(Y.value)||(ae=Z<Y.value)}else{const Z=i.valueAsDate||new Date(g),_=T=>new Date(new Date().toDateString()+" "+T),L=i.type=="time",C=i.type=="week";Cs($.value)&&g&&(G=L?_(g)>_($.value):C?g>$.value:Z>new Date($.value)),Cs(Y.value)&&g&&(ae=L?_(g)<_(Y.value):C?g<Y.value:Z<new Date(Y.value))}if((G||ae)&&(ee(!!G,$.message,Y.message,Ls.max,Ls.min),!r))return A(P[y].message),P}if((u||h)&&!O&&(Cs(g)||o&&Array.isArray(g))){const G=Ba(u),ae=Ba(h),$=!Vt(G.value)&&g.length>+G.value,Y=!Vt(ae.value)&&g.length<+ae.value;if(($||Y)&&(ee($,G.message,ae.message),!r))return A(P[y].message),P}if(f&&!O&&Cs(g)){const{value:G,message:ae}=Ba(f);if(wn(G)&&!g.match(G)&&(P[y]={type:Ls.pattern,message:ae,ref:i,...I(Ls.pattern,ae)},!r))return A(ae),P}if(v){if(gs(v)){const G=await v(g,s),ae=ml(G,b);if(ae&&(P[y]={...ae,...I(Ls.validate,ae.message)},!r))return A(ae.message),P}else if(pt(v)){let G={};for(const ae in v){if(!Ht(G)&&!r)break;const $=ml(await v[ae](g,s),b,ae);$&&(G={...$,...I(ae,$.message)},A($.message),r&&(P[y]=G))}if(!Ht(G)&&(P[y]={ref:b,...G},!r))return P}}return A(!0),P};const Lg={mode:xs.onSubmit,reValidateMode:xs.onChange,shouldFocusError:!0};function Mg(a={}){let t={...Lg,...a},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:gs(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},r={},n=pt(t.defaultValues)||pt(t.values)?St(t.defaultValues||t.values)||{}:{},o=t.shouldUnregister?{}:St(n),i={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},d,u=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let m={...h};const p={array:rl(),state:rl()},f=t.criteriaMode===xs.all,v=j=>R=>{clearTimeout(u),u=setTimeout(j,R)},y=async j=>{if(!t.disabled&&(h.isValid||m.isValid||j)){const R=t.resolver?Ht((await V()).errors):await O(r,!0);R!==s.isValid&&p.state.next({isValid:R})}},w=(j,R)=>{!t.disabled&&(h.isValidating||h.validatingFields||m.isValidating||m.validatingFields)&&((j||Array.from(c.mount)).forEach(W=>{W&&(R?at(s.validatingFields,W,R):gt(s.validatingFields,W))}),p.state.next({validatingFields:s.validatingFields,isValidating:!Ht(s.validatingFields)}))},N=(j,R=[],W,me,se=!0,re=!0)=>{if(me&&W&&!t.disabled){if(i.action=!0,re&&Array.isArray(we(r,j))){const ve=W(we(r,j),me.argA,me.argB);se&&at(r,j,ve)}if(re&&Array.isArray(we(s.errors,j))){const ve=W(we(s.errors,j),me.argA,me.argB);se&&at(s.errors,j,ve),Ig(s.errors,j)}if((h.touchedFields||m.touchedFields)&&re&&Array.isArray(we(s.touchedFields,j))){const ve=W(we(s.touchedFields,j),me.argA,me.argB);se&&at(s.touchedFields,j,ve)}(h.dirtyFields||m.dirtyFields)&&(s.dirtyFields=pr(n,o)),p.state.next({name:j,isDirty:ee(j,R),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else at(o,j,R)},g=(j,R)=>{at(s.errors,j,R),p.state.next({errors:s.errors})},b=j=>{s.errors=j,p.state.next({errors:s.errors,isValid:!1})},A=(j,R,W,me)=>{const se=we(r,j);if(se){const re=we(o,j,vt(W)?we(n,j):W);vt(re)||me&&me.defaultChecked||R?at(o,j,R?re:ll(se._f)):$(j,re),i.mount&&y()}},P=(j,R,W,me,se)=>{let re=!1,ve=!1;const Te={name:j};if(!t.disabled){if(!W||me){(h.isDirty||m.isDirty)&&(ve=s.isDirty,s.isDirty=Te.isDirty=ee(),re=ve!==Te.isDirty);const Ze=Zs(we(n,j),R);ve=!!we(s.dirtyFields,j),Ze?gt(s.dirtyFields,j):at(s.dirtyFields,j,!0),Te.dirtyFields=s.dirtyFields,re=re||(h.dirtyFields||m.dirtyFields)&&ve!==!Ze}if(W){const Ze=we(s.touchedFields,j);Ze||(at(s.touchedFields,j,W),Te.touchedFields=s.touchedFields,re=re||(h.touchedFields||m.touchedFields)&&Ze!==W)}re&&se&&p.state.next(Te)}return re?Te:{}},E=(j,R,W,me)=>{const se=we(s.errors,j),re=(h.isValid||m.isValid)&&Ns(R)&&s.isValid!==R;if(t.delayError&&W?(d=v(()=>g(j,W)),d(t.delayError)):(clearTimeout(u),d=null,W?at(s.errors,j,W):gt(s.errors,j)),(W?!Zs(se,W):se)||!Ht(me)||re){const ve={...me,...re&&Ns(R)?{isValid:R}:{},errors:s.errors,name:j};s={...s,...ve},p.state.next(ve)}},V=async j=>{w(j,!0);const R=await t.resolver(o,t.context,Pg(j||c.mount,r,t.criteriaMode,t.shouldUseNativeValidation));return w(j),R},M=async j=>{const{errors:R}=await V(j);if(j)for(const W of j){const me=we(R,W);me?at(s.errors,W,me):gt(s.errors,W)}else s.errors=R;return R},O=async(j,R,W={valid:!0})=>{for(const me in j){const se=j[me];if(se){const{_f:re,...ve}=se;if(re){const Te=c.array.has(re.name),Ze=se._f&&Ag(se._f);Ze&&h.validatingFields&&w([me],!0);const ct=await pl(se,c.disabled,o,f,t.shouldUseNativeValidation&&!R,Te);if(Ze&&h.validatingFields&&w([me]),ct[re.name]&&(W.valid=!1,R))break;!R&&(we(ct,re.name)?Te?Og(s.errors,ct,re.name):at(s.errors,re.name,ct[re.name]):gt(s.errors,re.name))}!Ht(ve)&&await O(ve,R,W)}}return W.valid},I=()=>{for(const j of c.unMount){const R=we(r,j);R&&(R._f.refs?R._f.refs.every(W=>!co(W)):!co(R._f.ref))&&Q(j)}c.unMount=new Set},ee=(j,R)=>!t.disabled&&(j&&R&&at(o,j,R),!Zs(T(),n)),G=(j,R,W)=>_g(j,c,{...i.mount?o:vt(R)?n:Cs(j)?{[j]:R}:R},W,R),ae=j=>Ci(we(i.mount?o:n,j,t.shouldUnregister?we(n,j,[]):[])),$=(j,R,W={})=>{const me=we(r,j);let se=R;if(me){const re=me._f;re&&(!re.disabled&&at(o,j,Mu(R,re)),se=yn(re.ref)&&Vt(R)?"":R,Du(re.ref)?[...re.ref.options].forEach(ve=>ve.selected=se.includes(ve.value)):re.refs?Jr(re.ref)?re.refs.forEach(ve=>{(!ve.defaultChecked||!ve.disabled)&&(Array.isArray(se)?ve.checked=!!se.find(Te=>Te===ve.value):ve.checked=se===ve.value||!!se)}):re.refs.forEach(ve=>ve.checked=ve.value===se):Ai(re.ref)?re.ref.value="":(re.ref.value=se,re.ref.type||p.state.next({name:j,values:St(o)})))}(W.shouldDirty||W.shouldTouch)&&P(j,se,W.shouldTouch,W.shouldDirty,!0),W.shouldValidate&&C(j)},Y=(j,R,W)=>{for(const me in R){if(!R.hasOwnProperty(me))return;const se=R[me],re=j+"."+me,ve=we(r,re);(c.array.has(j)||pt(se)||ve&&!ve._f)&&!_a(se)?Y(re,se,W):$(re,se,W)}},Z=(j,R,W={})=>{const me=we(r,j),se=c.array.has(j),re=St(R);at(o,j,re),se?(p.array.next({name:j,values:St(o)}),(h.isDirty||h.dirtyFields||m.isDirty||m.dirtyFields)&&W.shouldDirty&&p.state.next({name:j,dirtyFields:pr(n,o),isDirty:ee(j,re)})):me&&!me._f&&!Vt(re)?Y(j,re,W):$(j,re,W),ul(j,c)&&p.state.next({...s,name:j}),p.state.next({name:i.mount?j:void 0,values:St(o)})},_=async j=>{i.mount=!0;const R=j.target;let W=R.name,me=!0;const se=we(r,W),re=Ze=>{me=Number.isNaN(Ze)||_a(Ze)&&isNaN(Ze.getTime())||Zs(Ze,we(o,W,Ze))},ve=cl(t.mode),Te=cl(t.reValidateMode);if(se){let Ze,ct;const ne=R.type?ll(se._f):gg(j),fe=j.type===al.BLUR||j.type===al.FOCUS_OUT,xe=!Eg(se._f)&&!t.resolver&&!we(s.errors,W)&&!se._f.deps||Dg(fe,we(s.touchedFields,W),s.isSubmitted,Te,ve),Re=ul(W,c,fe);at(o,W,ne),fe?(se._f.onBlur&&se._f.onBlur(j),d&&d(0)):se._f.onChange&&se._f.onChange(j);const qe=P(W,ne,fe),Ue=!Ht(qe)||Re;if(!fe&&p.state.next({name:W,type:j.type,values:St(o)}),xe)return(h.isValid||m.isValid)&&(t.mode==="onBlur"?fe&&y():fe||y()),Ue&&p.state.next({name:W,...Re?{}:qe});if(!fe&&Re&&p.state.next({...s}),t.resolver){const{errors:xt}=await V([W]);if(re(ne),me){const Qt=hl(s.errors,r,W),ys=hl(xt,r,Qt.name||W);Ze=ys.error,W=ys.name,ct=Ht(xt)}}else w([W],!0),Ze=(await pl(se,c.disabled,o,f,t.shouldUseNativeValidation))[W],w([W]),re(ne),me&&(Ze?ct=!1:(h.isValid||m.isValid)&&(ct=await O(r,!0)));me&&(se._f.deps&&C(se._f.deps),E(W,ct,Ze,qe))}},L=(j,R)=>{if(we(s.errors,R)&&j.focus)return j.focus(),1},C=async(j,R={})=>{let W,me;const se=jr(j);if(t.resolver){const re=await M(vt(j)?j:se);W=Ht(re),me=j?!se.some(ve=>we(re,ve)):W}else j?(me=(await Promise.all(se.map(async re=>{const ve=we(r,re);return await O(ve&&ve._f?{[re]:ve}:ve)}))).every(Boolean),!(!me&&!s.isValid)&&y()):me=W=await O(r);return p.state.next({...!Cs(j)||(h.isValid||m.isValid)&&W!==s.isValid?{}:{name:j},...t.resolver||!j?{isValid:W}:{},errors:s.errors}),R.shouldFocus&&!me&&Nr(r,L,j?se:c.mount),me},T=j=>{const R={...i.mount?o:n};return vt(j)?R:Cs(j)?we(R,j):j.map(W=>we(R,W))},H=(j,R)=>({invalid:!!we((R||s).errors,j),isDirty:!!we((R||s).dirtyFields,j),error:we((R||s).errors,j),isValidating:!!we(s.validatingFields,j),isTouched:!!we((R||s).touchedFields,j)}),x=j=>{j&&jr(j).forEach(R=>gt(s.errors,R)),p.state.next({errors:j?s.errors:{}})},S=(j,R,W)=>{const me=(we(r,j,{_f:{}})._f||{}).ref,se=we(s.errors,j)||{},{ref:re,message:ve,type:Te,...Ze}=se;at(s.errors,j,{...Ze,...R,ref:me}),p.state.next({name:j,errors:s.errors,isValid:!1}),W&&W.shouldFocus&&me&&me.focus&&me.focus()},q=(j,R)=>gs(j)?p.state.subscribe({next:W=>"values"in W&&j(G(void 0,R),W)}):G(j,R,!0),U=j=>p.state.subscribe({next:R=>{Tg(j.name,R.name,j.exact)&&Rg(R,j.formState||h,Ne,j.reRenderRoot)&&j.callback({values:{...o},...s,...R,defaultValues:n})}}).unsubscribe,de=j=>(i.mount=!0,m={...m,...j.formState},U({...j,formState:m})),Q=(j,R={})=>{for(const W of j?jr(j):c.mount)c.mount.delete(W),c.array.delete(W),R.keepValue||(gt(r,W),gt(o,W)),!R.keepError&&gt(s.errors,W),!R.keepDirty&&gt(s.dirtyFields,W),!R.keepTouched&&gt(s.touchedFields,W),!R.keepIsValidating&&gt(s.validatingFields,W),!t.shouldUnregister&&!R.keepDefaultValue&&gt(n,W);p.state.next({values:St(o)}),p.state.next({...s,...R.keepDirty?{isDirty:ee()}:{}}),!R.keepIsValid&&y()},z=({disabled:j,name:R})=>{(Ns(j)&&i.mount||j||c.disabled.has(R))&&(j?c.disabled.add(R):c.disabled.delete(R))},D=(j,R={})=>{let W=we(r,j);const me=Ns(R.disabled)||Ns(t.disabled);return at(r,j,{...W||{},_f:{...W&&W._f?W._f:{ref:{name:j}},name:j,mount:!0,...R}}),c.mount.add(j),W?z({disabled:Ns(R.disabled)?R.disabled:t.disabled,name:j}):A(j,!0,R.value),{...me?{disabled:R.disabled||t.disabled}:{},...t.progressive?{required:!!R.required,min:fr(R.min),max:fr(R.max),minLength:fr(R.minLength),maxLength:fr(R.maxLength),pattern:fr(R.pattern)}:{},name:j,onChange:_,onBlur:_,ref:se=>{if(se){D(j,R),W=we(r,j);const re=vt(se.value)&&se.querySelectorAll&&se.querySelectorAll("input,select,textarea")[0]||se,ve=Sg(re),Te=W._f.refs||[];if(ve?Te.find(Ze=>Ze===re):re===W._f.ref)return;at(r,j,{_f:{...W._f,...ve?{refs:[...Te.filter(co),re,...Array.isArray(we(n,j))?[{}]:[]],ref:{type:re.type,name:j}}:{ref:re}}}),A(j,!1,void 0,re)}else W=we(r,j,{}),W._f&&(W._f.mount=!1),(t.shouldUnregister||R.shouldUnregister)&&!(yg(c.array,j)&&i.action)&&c.unMount.add(j)}}},X=()=>t.shouldFocusError&&Nr(r,L,c.mount),B=j=>{Ns(j)&&(p.state.next({disabled:j}),Nr(r,(R,W)=>{const me=we(r,W);me&&(R.disabled=me._f.disabled||j,Array.isArray(me._f.refs)&&me._f.refs.forEach(se=>{se.disabled=me._f.disabled||j}))},0,!1))},oe=(j,R)=>async W=>{let me;W&&(W.preventDefault&&W.preventDefault(),W.persist&&W.persist());let se=St(o);if(p.state.next({isSubmitting:!0}),t.resolver){const{errors:re,values:ve}=await V();s.errors=re,se=St(ve)}else await O(r);if(c.disabled.size)for(const re of c.disabled)gt(se,re);if(gt(s.errors,"root"),Ht(s.errors)){p.state.next({errors:{}});try{await j(se,W)}catch(re){me=re}}else R&&await R({...s.errors},W),X(),setTimeout(X);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ht(s.errors)&&!me,submitCount:s.submitCount+1,errors:s.errors}),me)throw me},Ae=(j,R={})=>{we(r,j)&&(vt(R.defaultValue)?Z(j,St(we(n,j))):(Z(j,R.defaultValue),at(n,j,St(R.defaultValue))),R.keepTouched||gt(s.touchedFields,j),R.keepDirty||(gt(s.dirtyFields,j),s.isDirty=R.defaultValue?ee(j,St(we(n,j))):ee()),R.keepError||(gt(s.errors,j),h.isValid&&y()),p.state.next({...s}))},Ce=(j,R={})=>{const W=j?St(j):n,me=St(W),se=Ht(j),re=se?n:me;if(R.keepDefaultValues||(n=W),!R.keepValues){if(R.keepDirtyValues){const ve=new Set([...c.mount,...Object.keys(pr(n,o))]);for(const Te of Array.from(ve))we(s.dirtyFields,Te)?at(re,Te,we(o,Te)):Z(Te,we(re,Te))}else{if(ki&&vt(j))for(const ve of c.mount){const Te=we(r,ve);if(Te&&Te._f){const Ze=Array.isArray(Te._f.refs)?Te._f.refs[0]:Te._f.ref;if(yn(Ze)){const ct=Ze.closest("form");if(ct){ct.reset();break}}}}if(R.keepFieldsRef)for(const ve of c.mount)Z(ve,we(re,ve));else r={}}o=t.shouldUnregister?R.keepDefaultValues?St(n):{}:St(re),p.array.next({values:{...re}}),p.state.next({values:{...re}})}c={mount:R.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},i.mount=!h.isValid||!!R.keepIsValid||!!R.keepDirtyValues,i.watch=!!t.shouldUnregister,p.state.next({submitCount:R.keepSubmitCount?s.submitCount:0,isDirty:se?!1:R.keepDirty?s.isDirty:!!(R.keepDefaultValues&&!Zs(j,n)),isSubmitted:R.keepIsSubmitted?s.isSubmitted:!1,dirtyFields:se?{}:R.keepDirtyValues?R.keepDefaultValues&&o?pr(n,o):s.dirtyFields:R.keepDefaultValues&&j?pr(n,j):R.keepDirty?s.dirtyFields:{},touchedFields:R.keepTouched?s.touchedFields:{},errors:R.keepErrors?s.errors:{},isSubmitSuccessful:R.keepIsSubmitSuccessful?s.isSubmitSuccessful:!1,isSubmitting:!1})},Ie=(j,R)=>Ce(gs(j)?j(o):j,R),K=(j,R={})=>{const W=we(r,j),me=W&&W._f;if(me){const se=me.refs?me.refs[0]:me.ref;se.focus&&(se.focus(),R.shouldSelect&&gs(se.select)&&se.select())}},Ne=j=>{s={...s,...j}},Ge={control:{register:D,unregister:Q,getFieldState:H,handleSubmit:oe,setError:S,_subscribe:U,_runSchema:V,_focusError:X,_getWatch:G,_getDirty:ee,_setValid:y,_setFieldArray:N,_setDisabledField:z,_setErrors:b,_getFieldArray:ae,_reset:Ce,_resetDefaultValues:()=>gs(t.defaultValues)&&t.defaultValues().then(j=>{Ie(j,t.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:I,_disableForm:B,_subjects:p,_proxyFormState:h,get _fields(){return r},get _formValues(){return o},get _state(){return i},set _state(j){i=j},get _defaultValues(){return n},get _names(){return c},set _names(j){c=j},get _formState(){return s},get _options(){return t},set _options(j){t={...t,...j}}},subscribe:de,trigger:C,register:D,handleSubmit:oe,watch:q,setValue:Z,getValues:T,reset:Ie,resetField:Ae,clearErrors:x,unregister:Q,setError:S,setFocus:K,getFieldState:H};return{...Ge,formControl:Ge}}function Fg(a={}){const t=le.useRef(void 0),s=le.useRef(void 0),[r,n]=le.useState({isDirty:!1,isValidating:!1,isLoading:gs(a.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1,isReady:!1,defaultValues:gs(a.defaultValues)?void 0:a.defaultValues});if(!t.current)if(a.formControl)t.current={...a.formControl,formState:r},a.defaultValues&&!gs(a.defaultValues)&&a.formControl.reset(a.defaultValues,a.resetOptions);else{const{formControl:i,...c}=Mg(a);t.current={...c,formState:r}}const o=t.current.control;return o._options=a,Ng(()=>{const i=o._subscribe({formState:o._proxyFormState,callback:()=>n({...o._formState}),reRenderRoot:!0});return n(c=>({...c,isReady:!0})),o._formState.isReady=!0,i},[o]),le.useEffect(()=>o._disableForm(a.disabled),[o,a.disabled]),le.useEffect(()=>{a.mode&&(o._options.mode=a.mode),a.reValidateMode&&(o._options.reValidateMode=a.reValidateMode)},[o,a.mode,a.reValidateMode]),le.useEffect(()=>{a.errors&&(o._setErrors(a.errors),o._focusError())},[o,a.errors]),le.useEffect(()=>{a.shouldUnregister&&o._subjects.state.next({values:o._getWatch()})},[o,a.shouldUnregister]),le.useEffect(()=>{if(o._proxyFormState.isDirty){const i=o._getDirty();i!==r.isDirty&&o._subjects.state.next({isDirty:i})}},[o,r.isDirty]),le.useEffect(()=>{a.values&&!Zs(a.values,s.current)?(o._reset(a.values,{keepFieldsRef:!0,...o._options.resetOptions}),s.current=a.values,n(i=>({...i}))):o._resetDefaultValues()},[o,a.values]),le.useEffect(()=>{o._state.mount||(o._setValid(),o._state.mount=!0),o._state.watch&&(o._state.watch=!1,o._subjects.state.next({...o._formState})),o._removeUnmounted()}),t.current.formState=jg(r,o),t.current}const fl=(a,t,s)=>{if(a&&"reportValidity"in a){const r=we(s,t);a.setCustomValidity(r&&r.message||""),a.reportValidity()}},$u=(a,t)=>{for(const s in t.fields){const r=t.fields[s];r&&r.ref&&"reportValidity"in r.ref?fl(r.ref,s,a):r.refs&&r.refs.forEach(n=>fl(n,s,a))}},$g=(a,t)=>{t.shouldUseNativeValidation&&$u(a,t);const s={};for(const r in a){const n=we(t.fields,r),o=Object.assign(a[r]||{},{ref:n&&n.ref});if(Vg(t.names||Object.keys(a),r)){const i=Object.assign({},we(s,r));at(i,"root",o),at(s,r,i)}else at(s,r,o)}return s},Vg=(a,t)=>a.some(s=>s.startsWith(t+"."));var Ug=function(a,t){for(var s={};a.length;){var r=a[0],n=r.code,o=r.message,i=r.path.join(".");if(!s[i])if("unionErrors"in r){var c=r.unionErrors[0].errors[0];s[i]={message:c.message,type:c.code}}else s[i]={message:o,type:n};if("unionErrors"in r&&r.unionErrors.forEach(function(h){return h.errors.forEach(function(m){return a.push(m)})}),t){var d=s[i].types,u=d&&d[r.code];s[i]=Tu(i,t,s,n,u?[].concat(u,r.message):r.message)}a.shift()}return s},zg=function(a,t,s){return s===void 0&&(s={}),function(r,n,o){try{return Promise.resolve(function(i,c){try{var d=Promise.resolve(a[s.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(u){return o.shouldUseNativeValidation&&$u({},o),{errors:{},values:s.raw?r:u}})}catch(u){return c(u)}return d&&d.then?d.then(void 0,c):d}(0,function(i){if(function(c){return Array.isArray(c?.errors)}(i))return{values:{},errors:$g(Ug(i.errors,!o.shouldUseNativeValidation&&o.criteriaMode==="all"),o)};throw i}))}catch(i){return Promise.reject(i)}}},Xe;(function(a){a.assertEqual=n=>{};function t(n){}a.assertIs=t;function s(n){throw new Error}a.assertNever=s,a.arrayToEnum=n=>{const o={};for(const i of n)o[i]=i;return o},a.getValidEnumValues=n=>{const o=a.objectKeys(n).filter(c=>typeof n[n[c]]!="number"),i={};for(const c of o)i[c]=n[c];return a.objectValues(i)},a.objectValues=n=>a.objectKeys(n).map(function(o){return n[o]}),a.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{const o=[];for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&o.push(i);return o},a.find=(n,o)=>{for(const i of n)if(o(i))return i},a.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&Number.isFinite(n)&&Math.floor(n)===n;function r(n,o=" | "){return n.map(i=>typeof i=="string"?`'${i}'`:i).join(o)}a.joinValues=r,a.jsonStringifyReplacer=(n,o)=>typeof o=="bigint"?o.toString():o})(Xe||(Xe={}));var xl;(function(a){a.mergeShapes=(t,s)=>({...t,...s})})(xl||(xl={}));const je=Xe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Gs=a=>{switch(typeof a){case"undefined":return je.undefined;case"string":return je.string;case"number":return Number.isNaN(a)?je.nan:je.number;case"boolean":return je.boolean;case"function":return je.function;case"bigint":return je.bigint;case"symbol":return je.symbol;case"object":return Array.isArray(a)?je.array:a===null?je.null:a.then&&typeof a.then=="function"&&a.catch&&typeof a.catch=="function"?je.promise:typeof Map<"u"&&a instanceof Map?je.map:typeof Set<"u"&&a instanceof Set?je.set:typeof Date<"u"&&a instanceof Date?je.date:je.object;default:return je.unknown}},he=Xe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Hs extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=t}format(t){const s=t||function(o){return o.message},r={_errors:[]},n=o=>{for(const i of o.issues)if(i.code==="invalid_union")i.unionErrors.map(n);else if(i.code==="invalid_return_type")n(i.returnTypeError);else if(i.code==="invalid_arguments")n(i.argumentsError);else if(i.path.length===0)r._errors.push(s(i));else{let c=r,d=0;for(;d<i.path.length;){const u=i.path[d];d===i.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(s(i))):c[u]=c[u]||{_errors:[]},c=c[u],d++}}};return n(this),r}static assert(t){if(!(t instanceof Hs))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Xe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=s=>s.message){const s={},r=[];for(const n of this.issues)if(n.path.length>0){const o=n.path[0];s[o]=s[o]||[],s[o].push(t(n))}else r.push(t(n));return{formErrors:r,fieldErrors:s}}get formErrors(){return this.flatten()}}Hs.create=a=>new Hs(a);const Oo=(a,t)=>{let s;switch(a.code){case he.invalid_type:a.received===je.undefined?s="Required":s=`Expected ${a.expected}, received ${a.received}`;break;case he.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(a.expected,Xe.jsonStringifyReplacer)}`;break;case he.unrecognized_keys:s=`Unrecognized key(s) in object: ${Xe.joinValues(a.keys,", ")}`;break;case he.invalid_union:s="Invalid input";break;case he.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${Xe.joinValues(a.options)}`;break;case he.invalid_enum_value:s=`Invalid enum value. Expected ${Xe.joinValues(a.options)}, received '${a.received}'`;break;case he.invalid_arguments:s="Invalid function arguments";break;case he.invalid_return_type:s="Invalid function return type";break;case he.invalid_date:s="Invalid date";break;case he.invalid_string:typeof a.validation=="object"?"includes"in a.validation?(s=`Invalid input: must include "${a.validation.includes}"`,typeof a.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?s=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?s=`Invalid input: must end with "${a.validation.endsWith}"`:Xe.assertNever(a.validation):a.validation!=="regex"?s=`Invalid ${a.validation}`:s="Invalid";break;case he.too_small:a.type==="array"?s=`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:a.type==="string"?s=`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:a.type==="number"?s=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="bigint"?s=`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:a.type==="date"?s=`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:s="Invalid input";break;case he.too_big:a.type==="array"?s=`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:a.type==="string"?s=`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:a.type==="number"?s=`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="bigint"?s=`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:a.type==="date"?s=`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:s="Invalid input";break;case he.custom:s="Invalid input";break;case he.invalid_intersection_types:s="Intersection results could not be merged";break;case he.not_multiple_of:s=`Number must be a multiple of ${a.multipleOf}`;break;case he.not_finite:s="Number must be finite";break;default:s=t.defaultError,Xe.assertNever(a)}return{message:s}};let Bg=Oo;function Hg(){return Bg}const qg=a=>{const{data:t,path:s,errorMaps:r,issueData:n}=a,o=[...s,...n.path||[]],i={...n,path:o};if(n.message!==void 0)return{...n,path:o,message:n.message};let c="";const d=r.filter(u=>!!u).slice().reverse();for(const u of d)c=u(i,{data:t,defaultError:c}).message;return{...n,path:o,message:c}};function ye(a,t){const s=Hg(),r=qg({issueData:t,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,s,s===Oo?void 0:Oo].filter(n=>!!n)});a.common.issues.push(r)}class Zt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,s){const r=[];for(const n of s){if(n.status==="aborted")return Le;n.status==="dirty"&&t.dirty(),r.push(n.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,s){const r=[];for(const n of s){const o=await n.key,i=await n.value;r.push({key:o,value:i})}return Zt.mergeObjectSync(t,r)}static mergeObjectSync(t,s){const r={};for(const n of s){const{key:o,value:i}=n;if(o.status==="aborted"||i.status==="aborted")return Le;o.status==="dirty"&&t.dirty(),i.status==="dirty"&&t.dirty(),o.value!=="__proto__"&&(typeof i.value<"u"||n.alwaysSet)&&(r[o.value]=i.value)}return{status:t.value,value:r}}}const Le=Object.freeze({status:"aborted"}),vr=a=>({status:"dirty",value:a}),ls=a=>({status:"valid",value:a}),gl=a=>a.status==="aborted",vl=a=>a.status==="dirty",nr=a=>a.status==="valid",jn=a=>typeof Promise<"u"&&a instanceof Promise;var Se;(function(a){a.errToObj=t=>typeof t=="string"?{message:t}:t||{},a.toString=t=>typeof t=="string"?t:t?.message})(Se||(Se={}));class ma{constructor(t,s,r,n){this._cachedPath=[],this.parent=t,this.data=s,this._path=r,this._key=n}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const yl=(a,t)=>{if(nr(t))return{success:!0,data:t.value};if(!a.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Hs(a.common.issues);return this._error=s,this._error}}};function He(a){if(!a)return{};const{errorMap:t,invalid_type_error:s,required_error:r,description:n}=a;if(t&&(s||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:n}:{errorMap:(i,c)=>{const{message:d}=a;return i.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??r??c.defaultError}:i.code!=="invalid_type"?{message:c.defaultError}:{message:d??s??c.defaultError}},description:n}}class Ke{get description(){return this._def.description}_getType(t){return Gs(t.data)}_getOrReturnCtx(t,s){return s||{common:t.parent.common,data:t.data,parsedType:Gs(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Zt,ctx:{common:t.parent.common,data:t.data,parsedType:Gs(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const s=this._parse(t);if(jn(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(t){const s=this._parse(t);return Promise.resolve(s)}parse(t,s){const r=this.safeParse(t,s);if(r.success)return r.data;throw r.error}safeParse(t,s){const r={common:{issues:[],async:s?.async??!1,contextualErrorMap:s?.errorMap},path:s?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Gs(t)},n=this._parseSync({data:t,path:r.path,parent:r});return yl(r,n)}"~validate"(t){const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Gs(t)};if(!this["~standard"].async)try{const r=this._parseSync({data:t,path:[],parent:s});return nr(r)?{value:r.value}:{issues:s.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:s}).then(r=>nr(r)?{value:r.value}:{issues:s.common.issues})}async parseAsync(t,s){const r=await this.safeParseAsync(t,s);if(r.success)return r.data;throw r.error}async safeParseAsync(t,s){const r={common:{issues:[],contextualErrorMap:s?.errorMap,async:!0},path:s?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Gs(t)},n=this._parse({data:t,path:r.path,parent:r}),o=await(jn(n)?n:Promise.resolve(n));return yl(r,o)}refine(t,s){const r=n=>typeof s=="string"||typeof s>"u"?{message:s}:typeof s=="function"?s(n):s;return this._refinement((n,o)=>{const i=t(n),c=()=>o.addIssue({code:he.custom,...r(n)});return typeof Promise<"u"&&i instanceof Promise?i.then(d=>d?!0:(c(),!1)):i?!0:(c(),!1)})}refinement(t,s){return this._refinement((r,n)=>t(r)?!0:(n.addIssue(typeof s=="function"?s(r,n):s),!1))}_refinement(t){return new lr({schema:this,typeName:Me.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:s=>this["~validate"](s)}}optional(){return la.create(this,this._def)}nullable(){return cr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Es.create(this)}promise(){return kn.create(this,this._def)}or(t){return _n.create([this,t],this._def)}and(t){return Sn.create(this,t,this._def)}transform(t){return new lr({...He(this._def),schema:this,typeName:Me.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const s=typeof t=="function"?t:()=>t;return new Mo({...He(this._def),innerType:this,defaultValue:s,typeName:Me.ZodDefault})}brand(){return new pv({typeName:Me.ZodBranded,type:this,...He(this._def)})}catch(t){const s=typeof t=="function"?t:()=>t;return new Fo({...He(this._def),innerType:this,catchValue:s,typeName:Me.ZodCatch})}describe(t){const s=this.constructor;return new s({...this._def,description:t})}pipe(t){return Ri.create(this,t)}readonly(){return $o.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Wg=/^c[^\s-]{8,}$/i,Yg=/^[0-9a-z]+$/,Gg=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Zg=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Kg=/^[a-z0-9_-]{21}$/i,Qg=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Jg=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Xg=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ev="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let uo;const tv=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sv=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,av=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,rv=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,nv=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ov=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Vu="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",iv=new RegExp(`^${Vu}$`);function Uu(a){let t="[0-5]\\d";a.precision?t=`${t}\\.\\d{${a.precision}}`:a.precision==null&&(t=`${t}(\\.\\d+)?`);const s=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${s}`}function lv(a){return new RegExp(`^${Uu(a)}$`)}function cv(a){let t=`${Vu}T${Uu(a)}`;const s=[];return s.push(a.local?"Z?":"Z"),a.offset&&s.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${s.join("|")})`,new RegExp(`^${t}$`)}function dv(a,t){return!!((t==="v4"||!t)&&tv.test(a)||(t==="v6"||!t)&&av.test(a))}function uv(a,t){if(!Qg.test(a))return!1;try{const[s]=a.split(".");if(!s)return!1;const r=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),n=JSON.parse(atob(r));return!(typeof n!="object"||n===null||"typ"in n&&n?.typ!=="JWT"||!n.alg||t&&n.alg!==t)}catch{return!1}}function hv(a,t){return!!((t==="v4"||!t)&&sv.test(a)||(t==="v6"||!t)&&rv.test(a))}class aa extends Ke{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==je.string){const o=this._getOrReturnCtx(t);return ye(o,{code:he.invalid_type,expected:je.string,received:o.parsedType}),Le}const r=new Zt;let n;for(const o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(n=this._getOrReturnCtx(t,n),ye(n,{code:he.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="max")t.data.length>o.value&&(n=this._getOrReturnCtx(t,n),ye(n,{code:he.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),r.dirty());else if(o.kind==="length"){const i=t.data.length>o.value,c=t.data.length<o.value;(i||c)&&(n=this._getOrReturnCtx(t,n),i?ye(n,{code:he.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&ye(n,{code:he.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),r.dirty())}else if(o.kind==="email")Xg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"email",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="emoji")uo||(uo=new RegExp(ev,"u")),uo.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"emoji",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="uuid")Zg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"uuid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="nanoid")Kg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"nanoid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid")Wg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"cuid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="cuid2")Yg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"cuid2",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="ulid")Gg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"ulid",code:he.invalid_string,message:o.message}),r.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{n=this._getOrReturnCtx(t,n),ye(n,{validation:"url",code:he.invalid_string,message:o.message}),r.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"regex",code:he.invalid_string,message:o.message}),r.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(n=this._getOrReturnCtx(t,n),ye(n,{code:he.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),r.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(n=this._getOrReturnCtx(t,n),ye(n,{code:he.invalid_string,validation:{startsWith:o.value},message:o.message}),r.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(n=this._getOrReturnCtx(t,n),ye(n,{code:he.invalid_string,validation:{endsWith:o.value},message:o.message}),r.dirty()):o.kind==="datetime"?cv(o).test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{code:he.invalid_string,validation:"datetime",message:o.message}),r.dirty()):o.kind==="date"?iv.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{code:he.invalid_string,validation:"date",message:o.message}),r.dirty()):o.kind==="time"?lv(o).test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{code:he.invalid_string,validation:"time",message:o.message}),r.dirty()):o.kind==="duration"?Jg.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"duration",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="ip"?dv(t.data,o.version)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"ip",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="jwt"?uv(t.data,o.alg)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"jwt",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="cidr"?hv(t.data,o.version)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"cidr",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="base64"?nv.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"base64",code:he.invalid_string,message:o.message}),r.dirty()):o.kind==="base64url"?ov.test(t.data)||(n=this._getOrReturnCtx(t,n),ye(n,{validation:"base64url",code:he.invalid_string,message:o.message}),r.dirty()):Xe.assertNever(o);return{status:r.value,value:t.data}}_regex(t,s,r){return this.refinement(n=>t.test(n),{validation:s,code:he.invalid_string,...Se.errToObj(r)})}_addCheck(t){return new aa({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Se.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Se.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Se.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Se.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Se.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Se.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Se.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Se.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Se.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Se.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Se.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Se.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Se.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1,...Se.errToObj(t?.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision,...Se.errToObj(t?.message)})}duration(t){return this._addCheck({kind:"duration",...Se.errToObj(t)})}regex(t,s){return this._addCheck({kind:"regex",regex:t,...Se.errToObj(s)})}includes(t,s){return this._addCheck({kind:"includes",value:t,position:s?.position,...Se.errToObj(s?.message)})}startsWith(t,s){return this._addCheck({kind:"startsWith",value:t,...Se.errToObj(s)})}endsWith(t,s){return this._addCheck({kind:"endsWith",value:t,...Se.errToObj(s)})}min(t,s){return this._addCheck({kind:"min",value:t,...Se.errToObj(s)})}max(t,s){return this._addCheck({kind:"max",value:t,...Se.errToObj(s)})}length(t,s){return this._addCheck({kind:"length",value:t,...Se.errToObj(s)})}nonempty(t){return this.min(1,Se.errToObj(t))}trim(){return new aa({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new aa({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new aa({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxLength(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}}aa.create=a=>new aa({checks:[],typeName:Me.ZodString,coerce:a?.coerce??!1,...He(a)});function mv(a,t){const s=(a.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,n=s>r?s:r,o=Number.parseInt(a.toFixed(n).replace(".","")),i=Number.parseInt(t.toFixed(n).replace(".",""));return o%i/10**n}class or extends Ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==je.number){const o=this._getOrReturnCtx(t);return ye(o,{code:he.invalid_type,expected:je.number,received:o.parsedType}),Le}let r;const n=new Zt;for(const o of this._def.checks)o.kind==="int"?Xe.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),ye(r,{code:he.invalid_type,expected:"integer",received:"float",message:o.message}),n.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),ye(r,{code:he.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),n.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),ye(r,{code:he.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),n.dirty()):o.kind==="multipleOf"?mv(t.data,o.value)!==0&&(r=this._getOrReturnCtx(t,r),ye(r,{code:he.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),ye(r,{code:he.not_finite,message:o.message}),n.dirty()):Xe.assertNever(o);return{status:n.value,value:t.data}}gte(t,s){return this.setLimit("min",t,!0,Se.toString(s))}gt(t,s){return this.setLimit("min",t,!1,Se.toString(s))}lte(t,s){return this.setLimit("max",t,!0,Se.toString(s))}lt(t,s){return this.setLimit("max",t,!1,Se.toString(s))}setLimit(t,s,r,n){return new or({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:r,message:Se.toString(n)}]})}_addCheck(t){return new or({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Se.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Se.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Se.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Se.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Se.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:Se.toString(s)})}finite(t){return this._addCheck({kind:"finite",message:Se.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Se.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Se.toString(t)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Xe.isInteger(t.value))}get isFinite(){let t=null,s=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(s===null||r.value>s)&&(s=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(s)&&Number.isFinite(t)}}or.create=a=>new or({checks:[],typeName:Me.ZodNumber,coerce:a?.coerce||!1,...He(a)});class Rr extends Ke{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==je.bigint)return this._getInvalidInput(t);let r;const n=new Zt;for(const o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(r=this._getOrReturnCtx(t,r),ye(r,{code:he.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(r=this._getOrReturnCtx(t,r),ye(r,{code:he.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),n.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),ye(r,{code:he.not_multiple_of,multipleOf:o.value,message:o.message}),n.dirty()):Xe.assertNever(o);return{status:n.value,value:t.data}}_getInvalidInput(t){const s=this._getOrReturnCtx(t);return ye(s,{code:he.invalid_type,expected:je.bigint,received:s.parsedType}),Le}gte(t,s){return this.setLimit("min",t,!0,Se.toString(s))}gt(t,s){return this.setLimit("min",t,!1,Se.toString(s))}lte(t,s){return this.setLimit("max",t,!0,Se.toString(s))}lt(t,s){return this.setLimit("max",t,!1,Se.toString(s))}setLimit(t,s,r,n){return new Rr({...this._def,checks:[...this._def.checks,{kind:t,value:s,inclusive:r,message:Se.toString(n)}]})}_addCheck(t){return new Rr({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Se.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Se.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Se.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Se.toString(t)})}multipleOf(t,s){return this._addCheck({kind:"multipleOf",value:t,message:Se.toString(s)})}get minValue(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t}get maxValue(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t}}Rr.create=a=>new Rr({checks:[],typeName:Me.ZodBigInt,coerce:a?.coerce??!1,...He(a)});class bl extends Ke{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==je.boolean){const r=this._getOrReturnCtx(t);return ye(r,{code:he.invalid_type,expected:je.boolean,received:r.parsedType}),Le}return ls(t.data)}}bl.create=a=>new bl({typeName:Me.ZodBoolean,coerce:a?.coerce||!1,...He(a)});class Nn extends Ke{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==je.date){const o=this._getOrReturnCtx(t);return ye(o,{code:he.invalid_type,expected:je.date,received:o.parsedType}),Le}if(Number.isNaN(t.data.getTime())){const o=this._getOrReturnCtx(t);return ye(o,{code:he.invalid_date}),Le}const r=new Zt;let n;for(const o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(n=this._getOrReturnCtx(t,n),ye(n,{code:he.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),r.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(n=this._getOrReturnCtx(t,n),ye(n,{code:he.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),r.dirty()):Xe.assertNever(o);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Nn({...this._def,checks:[...this._def.checks,t]})}min(t,s){return this._addCheck({kind:"min",value:t.getTime(),message:Se.toString(s)})}max(t,s){return this._addCheck({kind:"max",value:t.getTime(),message:Se.toString(s)})}get minDate(){let t=null;for(const s of this._def.checks)s.kind==="min"&&(t===null||s.value>t)&&(t=s.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const s of this._def.checks)s.kind==="max"&&(t===null||s.value<t)&&(t=s.value);return t!=null?new Date(t):null}}Nn.create=a=>new Nn({checks:[],coerce:a?.coerce||!1,typeName:Me.ZodDate,...He(a)});class wl extends Ke{_parse(t){if(this._getType(t)!==je.symbol){const r=this._getOrReturnCtx(t);return ye(r,{code:he.invalid_type,expected:je.symbol,received:r.parsedType}),Le}return ls(t.data)}}wl.create=a=>new wl({typeName:Me.ZodSymbol,...He(a)});class jl extends Ke{_parse(t){if(this._getType(t)!==je.undefined){const r=this._getOrReturnCtx(t);return ye(r,{code:he.invalid_type,expected:je.undefined,received:r.parsedType}),Le}return ls(t.data)}}jl.create=a=>new jl({typeName:Me.ZodUndefined,...He(a)});class Nl extends Ke{_parse(t){if(this._getType(t)!==je.null){const r=this._getOrReturnCtx(t);return ye(r,{code:he.invalid_type,expected:je.null,received:r.parsedType}),Le}return ls(t.data)}}Nl.create=a=>new Nl({typeName:Me.ZodNull,...He(a)});class _l extends Ke{constructor(){super(...arguments),this._any=!0}_parse(t){return ls(t.data)}}_l.create=a=>new _l({typeName:Me.ZodAny,...He(a)});class Sl extends Ke{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ls(t.data)}}Sl.create=a=>new Sl({typeName:Me.ZodUnknown,...He(a)});class pa extends Ke{_parse(t){const s=this._getOrReturnCtx(t);return ye(s,{code:he.invalid_type,expected:je.never,received:s.parsedType}),Le}}pa.create=a=>new pa({typeName:Me.ZodNever,...He(a)});class kl extends Ke{_parse(t){if(this._getType(t)!==je.undefined){const r=this._getOrReturnCtx(t);return ye(r,{code:he.invalid_type,expected:je.void,received:r.parsedType}),Le}return ls(t.data)}}kl.create=a=>new kl({typeName:Me.ZodVoid,...He(a)});class Es extends Ke{_parse(t){const{ctx:s,status:r}=this._processInputParams(t),n=this._def;if(s.parsedType!==je.array)return ye(s,{code:he.invalid_type,expected:je.array,received:s.parsedType}),Le;if(n.exactLength!==null){const i=s.data.length>n.exactLength.value,c=s.data.length<n.exactLength.value;(i||c)&&(ye(s,{code:i?he.too_big:he.too_small,minimum:c?n.exactLength.value:void 0,maximum:i?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(n.minLength!==null&&s.data.length<n.minLength.value&&(ye(s,{code:he.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),n.maxLength!==null&&s.data.length>n.maxLength.value&&(ye(s,{code:he.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),s.common.async)return Promise.all([...s.data].map((i,c)=>n.type._parseAsync(new ma(s,i,s.path,c)))).then(i=>Zt.mergeArray(r,i));const o=[...s.data].map((i,c)=>n.type._parseSync(new ma(s,i,s.path,c)));return Zt.mergeArray(r,o)}get element(){return this._def.type}min(t,s){return new Es({...this._def,minLength:{value:t,message:Se.toString(s)}})}max(t,s){return new Es({...this._def,maxLength:{value:t,message:Se.toString(s)}})}length(t,s){return new Es({...this._def,exactLength:{value:t,message:Se.toString(s)}})}nonempty(t){return this.min(1,t)}}Es.create=(a,t)=>new Es({type:a,minLength:null,maxLength:null,exactLength:null,typeName:Me.ZodArray,...He(t)});function Ha(a){if(a instanceof ht){const t={};for(const s in a.shape){const r=a.shape[s];t[s]=la.create(Ha(r))}return new ht({...a._def,shape:()=>t})}else return a instanceof Es?new Es({...a._def,type:Ha(a.element)}):a instanceof la?la.create(Ha(a.unwrap())):a instanceof cr?cr.create(Ha(a.unwrap())):a instanceof Ma?Ma.create(a.items.map(t=>Ha(t))):a}class ht extends Ke{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),s=Xe.objectKeys(t);return this._cached={shape:t,keys:s},this._cached}_parse(t){if(this._getType(t)!==je.object){const u=this._getOrReturnCtx(t);return ye(u,{code:he.invalid_type,expected:je.object,received:u.parsedType}),Le}const{status:r,ctx:n}=this._processInputParams(t),{shape:o,keys:i}=this._getCached(),c=[];if(!(this._def.catchall instanceof pa&&this._def.unknownKeys==="strip"))for(const u in n.data)i.includes(u)||c.push(u);const d=[];for(const u of i){const h=o[u],m=n.data[u];d.push({key:{status:"valid",value:u},value:h._parse(new ma(n,m,n.path,u)),alwaysSet:u in n.data})}if(this._def.catchall instanceof pa){const u=this._def.unknownKeys;if(u==="passthrough")for(const h of c)d.push({key:{status:"valid",value:h},value:{status:"valid",value:n.data[h]}});else if(u==="strict")c.length>0&&(ye(n,{code:he.unrecognized_keys,keys:c}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const h of c){const m=n.data[h];d.push({key:{status:"valid",value:h},value:u._parse(new ma(n,m,n.path,h)),alwaysSet:h in n.data})}}return n.common.async?Promise.resolve().then(async()=>{const u=[];for(const h of d){const m=await h.key,p=await h.value;u.push({key:m,value:p,alwaysSet:h.alwaysSet})}return u}).then(u=>Zt.mergeObjectSync(r,u)):Zt.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(t){return Se.errToObj,new ht({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(s,r)=>{const n=this._def.errorMap?.(s,r).message??r.defaultError;return s.code==="unrecognized_keys"?{message:Se.errToObj(t).message??n}:{message:n}}}:{}})}strip(){return new ht({...this._def,unknownKeys:"strip"})}passthrough(){return new ht({...this._def,unknownKeys:"passthrough"})}extend(t){return new ht({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ht({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Me.ZodObject})}setKey(t,s){return this.augment({[t]:s})}catchall(t){return new ht({...this._def,catchall:t})}pick(t){const s={};for(const r of Xe.objectKeys(t))t[r]&&this.shape[r]&&(s[r]=this.shape[r]);return new ht({...this._def,shape:()=>s})}omit(t){const s={};for(const r of Xe.objectKeys(this.shape))t[r]||(s[r]=this.shape[r]);return new ht({...this._def,shape:()=>s})}deepPartial(){return Ha(this)}partial(t){const s={};for(const r of Xe.objectKeys(this.shape)){const n=this.shape[r];t&&!t[r]?s[r]=n:s[r]=n.optional()}return new ht({...this._def,shape:()=>s})}required(t){const s={};for(const r of Xe.objectKeys(this.shape))if(t&&!t[r])s[r]=this.shape[r];else{let o=this.shape[r];for(;o instanceof la;)o=o._def.innerType;s[r]=o}return new ht({...this._def,shape:()=>s})}keyof(){return zu(Xe.objectKeys(this.shape))}}ht.create=(a,t)=>new ht({shape:()=>a,unknownKeys:"strip",catchall:pa.create(),typeName:Me.ZodObject,...He(t)});ht.strictCreate=(a,t)=>new ht({shape:()=>a,unknownKeys:"strict",catchall:pa.create(),typeName:Me.ZodObject,...He(t)});ht.lazycreate=(a,t)=>new ht({shape:a,unknownKeys:"strip",catchall:pa.create(),typeName:Me.ZodObject,...He(t)});class _n extends Ke{_parse(t){const{ctx:s}=this._processInputParams(t),r=this._def.options;function n(o){for(const c of o)if(c.result.status==="valid")return c.result;for(const c of o)if(c.result.status==="dirty")return s.common.issues.push(...c.ctx.common.issues),c.result;const i=o.map(c=>new Hs(c.ctx.common.issues));return ye(s,{code:he.invalid_union,unionErrors:i}),Le}if(s.common.async)return Promise.all(r.map(async o=>{const i={...s,common:{...s.common,issues:[]},parent:null};return{result:await o._parseAsync({data:s.data,path:s.path,parent:i}),ctx:i}})).then(n);{let o;const i=[];for(const d of r){const u={...s,common:{...s.common,issues:[]},parent:null},h=d._parseSync({data:s.data,path:s.path,parent:u});if(h.status==="valid")return h;h.status==="dirty"&&!o&&(o={result:h,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(o)return s.common.issues.push(...o.ctx.common.issues),o.result;const c=i.map(d=>new Hs(d));return ye(s,{code:he.invalid_union,unionErrors:c}),Le}}get options(){return this._def.options}}_n.create=(a,t)=>new _n({options:a,typeName:Me.ZodUnion,...He(t)});function Lo(a,t){const s=Gs(a),r=Gs(t);if(a===t)return{valid:!0,data:a};if(s===je.object&&r===je.object){const n=Xe.objectKeys(t),o=Xe.objectKeys(a).filter(c=>n.indexOf(c)!==-1),i={...a,...t};for(const c of o){const d=Lo(a[c],t[c]);if(!d.valid)return{valid:!1};i[c]=d.data}return{valid:!0,data:i}}else if(s===je.array&&r===je.array){if(a.length!==t.length)return{valid:!1};const n=[];for(let o=0;o<a.length;o++){const i=a[o],c=t[o],d=Lo(i,c);if(!d.valid)return{valid:!1};n.push(d.data)}return{valid:!0,data:n}}else return s===je.date&&r===je.date&&+a==+t?{valid:!0,data:a}:{valid:!1}}class Sn extends Ke{_parse(t){const{status:s,ctx:r}=this._processInputParams(t),n=(o,i)=>{if(gl(o)||gl(i))return Le;const c=Lo(o.value,i.value);return c.valid?((vl(o)||vl(i))&&s.dirty(),{status:s.value,value:c.data}):(ye(r,{code:he.invalid_intersection_types}),Le)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([o,i])=>n(o,i)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Sn.create=(a,t,s)=>new Sn({left:a,right:t,typeName:Me.ZodIntersection,...He(s)});class Ma extends Ke{_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==je.array)return ye(r,{code:he.invalid_type,expected:je.array,received:r.parsedType}),Le;if(r.data.length<this._def.items.length)return ye(r,{code:he.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Le;!this._def.rest&&r.data.length>this._def.items.length&&(ye(r,{code:he.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const o=[...r.data].map((i,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new ma(r,i,r.path,c)):null}).filter(i=>!!i);return r.common.async?Promise.all(o).then(i=>Zt.mergeArray(s,i)):Zt.mergeArray(s,o)}get items(){return this._def.items}rest(t){return new Ma({...this._def,rest:t})}}Ma.create=(a,t)=>{if(!Array.isArray(a))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ma({items:a,typeName:Me.ZodTuple,rest:null,...He(t)})};class Cl extends Ke{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==je.map)return ye(r,{code:he.invalid_type,expected:je.map,received:r.parsedType}),Le;const n=this._def.keyType,o=this._def.valueType,i=[...r.data.entries()].map(([c,d],u)=>({key:n._parse(new ma(r,c,r.path,[u,"key"])),value:o._parse(new ma(r,d,r.path,[u,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of i){const u=await d.key,h=await d.value;if(u.status==="aborted"||h.status==="aborted")return Le;(u.status==="dirty"||h.status==="dirty")&&s.dirty(),c.set(u.value,h.value)}return{status:s.value,value:c}})}else{const c=new Map;for(const d of i){const u=d.key,h=d.value;if(u.status==="aborted"||h.status==="aborted")return Le;(u.status==="dirty"||h.status==="dirty")&&s.dirty(),c.set(u.value,h.value)}return{status:s.value,value:c}}}}Cl.create=(a,t,s)=>new Cl({valueType:t,keyType:a,typeName:Me.ZodMap,...He(s)});class Tr extends Ke{_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.parsedType!==je.set)return ye(r,{code:he.invalid_type,expected:je.set,received:r.parsedType}),Le;const n=this._def;n.minSize!==null&&r.data.size<n.minSize.value&&(ye(r,{code:he.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),s.dirty()),n.maxSize!==null&&r.data.size>n.maxSize.value&&(ye(r,{code:he.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),s.dirty());const o=this._def.valueType;function i(d){const u=new Set;for(const h of d){if(h.status==="aborted")return Le;h.status==="dirty"&&s.dirty(),u.add(h.value)}return{status:s.value,value:u}}const c=[...r.data.values()].map((d,u)=>o._parse(new ma(r,d,r.path,u)));return r.common.async?Promise.all(c).then(d=>i(d)):i(c)}min(t,s){return new Tr({...this._def,minSize:{value:t,message:Se.toString(s)}})}max(t,s){return new Tr({...this._def,maxSize:{value:t,message:Se.toString(s)}})}size(t,s){return this.min(t,s).max(t,s)}nonempty(t){return this.min(1,t)}}Tr.create=(a,t)=>new Tr({valueType:a,minSize:null,maxSize:null,typeName:Me.ZodSet,...He(t)});class Pl extends Ke{get schema(){return this._def.getter()}_parse(t){const{ctx:s}=this._processInputParams(t);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}Pl.create=(a,t)=>new Pl({getter:a,typeName:Me.ZodLazy,...He(t)});class Al extends Ke{_parse(t){if(t.data!==this._def.value){const s=this._getOrReturnCtx(t);return ye(s,{received:s.data,code:he.invalid_literal,expected:this._def.value}),Le}return{status:"valid",value:t.data}}get value(){return this._def.value}}Al.create=(a,t)=>new Al({value:a,typeName:Me.ZodLiteral,...He(t)});function zu(a,t){return new ir({values:a,typeName:Me.ZodEnum,...He(t)})}class ir extends Ke{_parse(t){if(typeof t.data!="string"){const s=this._getOrReturnCtx(t),r=this._def.values;return ye(s,{expected:Xe.joinValues(r),received:s.parsedType,code:he.invalid_type}),Le}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const s=this._getOrReturnCtx(t),r=this._def.values;return ye(s,{received:s.data,code:he.invalid_enum_value,options:r}),Le}return ls(t.data)}get options(){return this._def.values}get enum(){const t={};for(const s of this._def.values)t[s]=s;return t}get Values(){const t={};for(const s of this._def.values)t[s]=s;return t}get Enum(){const t={};for(const s of this._def.values)t[s]=s;return t}extract(t,s=this._def){return ir.create(t,{...this._def,...s})}exclude(t,s=this._def){return ir.create(this.options.filter(r=>!t.includes(r)),{...this._def,...s})}}ir.create=zu;class El extends Ke{_parse(t){const s=Xe.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==je.string&&r.parsedType!==je.number){const n=Xe.objectValues(s);return ye(r,{expected:Xe.joinValues(n),received:r.parsedType,code:he.invalid_type}),Le}if(this._cache||(this._cache=new Set(Xe.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const n=Xe.objectValues(s);return ye(r,{received:r.data,code:he.invalid_enum_value,options:n}),Le}return ls(t.data)}get enum(){return this._def.values}}El.create=(a,t)=>new El({values:a,typeName:Me.ZodNativeEnum,...He(t)});class kn extends Ke{unwrap(){return this._def.type}_parse(t){const{ctx:s}=this._processInputParams(t);if(s.parsedType!==je.promise&&s.common.async===!1)return ye(s,{code:he.invalid_type,expected:je.promise,received:s.parsedType}),Le;const r=s.parsedType===je.promise?s.data:Promise.resolve(s.data);return ls(r.then(n=>this._def.type.parseAsync(n,{path:s.path,errorMap:s.common.contextualErrorMap})))}}kn.create=(a,t)=>new kn({type:a,typeName:Me.ZodPromise,...He(t)});class lr extends Ke{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Me.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:s,ctx:r}=this._processInputParams(t),n=this._def.effect||null,o={addIssue:i=>{ye(r,i),i.fatal?s.abort():s.dirty()},get path(){return r.path}};if(o.addIssue=o.addIssue.bind(o),n.type==="preprocess"){const i=n.transform(r.data,o);if(r.common.async)return Promise.resolve(i).then(async c=>{if(s.value==="aborted")return Le;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?Le:d.status==="dirty"||s.value==="dirty"?vr(d.value):d});{if(s.value==="aborted")return Le;const c=this._def.schema._parseSync({data:i,path:r.path,parent:r});return c.status==="aborted"?Le:c.status==="dirty"||s.value==="dirty"?vr(c.value):c}}if(n.type==="refinement"){const i=c=>{const d=n.refinement(c,o);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Le:(c.status==="dirty"&&s.dirty(),i(c.value),{status:s.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?Le:(c.status==="dirty"&&s.dirty(),i(c.value).then(()=>({status:s.value,value:c.value}))))}if(n.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!nr(i))return Le;const c=n.transform(i.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>nr(i)?Promise.resolve(n.transform(i.value,o)).then(c=>({status:s.value,value:c})):Le);Xe.assertNever(n)}}lr.create=(a,t,s)=>new lr({schema:a,typeName:Me.ZodEffects,effect:t,...He(s)});lr.createWithPreprocess=(a,t,s)=>new lr({schema:t,effect:{type:"preprocess",transform:a},typeName:Me.ZodEffects,...He(s)});class la extends Ke{_parse(t){return this._getType(t)===je.undefined?ls(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}la.create=(a,t)=>new la({innerType:a,typeName:Me.ZodOptional,...He(t)});class cr extends Ke{_parse(t){return this._getType(t)===je.null?ls(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}cr.create=(a,t)=>new cr({innerType:a,typeName:Me.ZodNullable,...He(t)});class Mo extends Ke{_parse(t){const{ctx:s}=this._processInputParams(t);let r=s.data;return s.parsedType===je.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}Mo.create=(a,t)=>new Mo({innerType:a,typeName:Me.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...He(t)});class Fo extends Ke{_parse(t){const{ctx:s}=this._processInputParams(t),r={...s,common:{...s.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return jn(n)?n.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new Hs(r.common.issues)},input:r.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new Hs(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Fo.create=(a,t)=>new Fo({innerType:a,typeName:Me.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...He(t)});class Rl extends Ke{_parse(t){if(this._getType(t)!==je.nan){const r=this._getOrReturnCtx(t);return ye(r,{code:he.invalid_type,expected:je.nan,received:r.parsedType}),Le}return{status:"valid",value:t.data}}}Rl.create=a=>new Rl({typeName:Me.ZodNaN,...He(a)});class pv extends Ke{_parse(t){const{ctx:s}=this._processInputParams(t),r=s.data;return this._def.type._parse({data:r,path:s.path,parent:s})}unwrap(){return this._def.type}}class Ri extends Ke{_parse(t){const{status:s,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const o=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Le:o.status==="dirty"?(s.dirty(),vr(o.value)):this._def.out._parseAsync({data:o.value,path:r.path,parent:r})})();{const n=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return n.status==="aborted"?Le:n.status==="dirty"?(s.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:r.path,parent:r})}}static create(t,s){return new Ri({in:t,out:s,typeName:Me.ZodPipeline})}}class $o extends Ke{_parse(t){const s=this._def.innerType._parse(t),r=n=>(nr(n)&&(n.value=Object.freeze(n.value)),n);return jn(s)?s.then(n=>r(n)):r(s)}unwrap(){return this._def.innerType}}$o.create=(a,t)=>new $o({innerType:a,typeName:Me.ZodReadonly,...He(t)});ht.lazycreate;var Me;(function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"})(Me||(Me={}));const ya=aa.create,ws=or.create;pa.create;Es.create;const ho=ht.create;ht.strictCreate;_n.create;Sn.create;Ma.create;const fv=ir.create;kn.create;la.create;cr.create;const xv=ho({user_name:ya().min(2,"Name must be at least 2 characters"),email:ya().email("Invalid email address"),password:ya().optional(),confirm_password:ya().optional(),phone_number:ya().min(10,"Phone number must be at least 10 digits"),company_name:ya().min(2,"Company name must be at least 2 characters"),contact_number:ya().min(10,"Contact number must be at least 10 digits"),allowed_locations:ws().min(1,"Must allow at least 1 location"),allowed_attendants_per_location:ws().min(1,"Must allow at least 1 attendant per location"),status:fv(["active","inactive"]),rates_2wheeler:ho({upTo2Hours:ws().min(0),upTo6Hours:ws().min(0),upTo12Hours:ws().min(0),upTo24Hours:ws().min(0)}),rates_4wheeler:ho({upTo2Hours:ws().min(0),upTo6Hours:ws().min(0),upTo12Hours:ws().min(0),upTo24Hours:ws().min(0)})}).refine(a=>a.password&&a.confirm_password?a.password===a.confirm_password:!0,{message:"Passwords do not match",path:["confirm_password"]});function gv({isOpen:a,onClose:t,onSuccess:s,contractor:r,isEditing:n=!1}){const[o,i]=l.useState(!1),[c,d]=l.useState(!1),[u,h]=l.useState(!1),{toast:m}=Tt(),{register:p,handleSubmit:f,formState:{errors:v},setValue:y,watch:w,reset:N}=Fg({resolver:zg(xv),defaultValues:{password:"",confirm_password:"",allowed_locations:5,allowed_attendants_per_location:10,status:"active",rates_2wheeler:{upTo2Hours:2,upTo6Hours:5,upTo12Hours:8,upTo24Hours:12},rates_4wheeler:{upTo2Hours:5,upTo6Hours:10,upTo12Hours:18,upTo24Hours:30}}});l.useEffect(()=>{r&&n?N({user_name:r.profiles?.user_name||"",email:r.profiles?.email||"",phone_number:r.profiles?.phone_number||"",company_name:r.company_name||"",contact_number:r.contact_number||"",allowed_locations:r.allowed_locations||5,allowed_attendants_per_location:r.allowed_attendants_per_location||10,status:r.status||"active",rates_2wheeler:r.rates_2wheeler||{upTo2Hours:2,upTo6Hours:5,upTo12Hours:8,upTo24Hours:12},rates_4wheeler:r.rates_4wheeler||{upTo2Hours:5,upTo6Hours:10,upTo12Hours:18,upTo24Hours:30},password:"",confirm_password:""}):n||N({password:"",confirm_password:"",allowed_locations:5,allowed_attendants_per_location:10,status:"active",rates_2wheeler:{upTo2Hours:2,upTo6Hours:5,upTo12Hours:8,upTo24Hours:12},rates_4wheeler:{upTo2Hours:5,upTo6Hours:10,upTo12Hours:18,upTo24Hours:30}})},[r,n,N]);const g=async b=>{i(!0);try{const A={user_name:b.user_name,email:b.email,phone_number:b.phone_number,company_name:b.company_name,contact_number:b.contact_number,allowed_locations:b.allowed_locations,allowed_attendants_per_location:b.allowed_attendants_per_location,status:b.status,rates_2wheeler:{upTo2Hours:b.rates_2wheeler.upTo2Hours,upTo6Hours:b.rates_2wheeler.upTo6Hours,upTo12Hours:b.rates_2wheeler.upTo12Hours,upTo24Hours:b.rates_2wheeler.upTo24Hours},rates_4wheeler:{upTo2Hours:b.rates_4wheeler.upTo2Hours,upTo6Hours:b.rates_4wheeler.upTo6Hours,upTo12Hours:b.rates_4wheeler.upTo12Hours,upTo24Hours:b.rates_4wheeler.upTo24Hours}};if((!n||b.password)&&(A.password=b.password),n&&r){console.log("Updating contractor with data:",A);const P=await Ot.updateContractor(r.id,A);console.log("Updated contractor result:",P),m({title:"Success",description:"Contractor updated successfully"})}else{if(!b.password){m({title:"Error",description:"Password is required for new contractors",variant:"destructive"});return}console.log("Creating contractor with data:",A);const P=await Ot.createContractor(A);console.log("Created contractor result:",P),m({title:"Success",description:"Contractor created successfully"})}s?.(),N(),t()}catch(A){m({title:"Error",description:A.message||"Failed to save contractor",variant:"destructive"})}finally{i(!1)}};return e.jsx(bt,{open:a,onOpenChange:t,children:e.jsxs(yt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto w-[95vw] sm:w-full",children:[e.jsxs(wt,{children:[e.jsx(jt,{className:"text-lg sm:text-xl",children:n?"Edit Contractor":"Add New Contractor"}),e.jsx(At,{className:"text-sm",children:n?"Update contractor information and settings":"Create a new contractor account with parking management settings"})]}),e.jsxs("form",{onSubmit:f(g),className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Basic Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"user_name",children:"Full Name"}),e.jsx(ge,{id:"user_name",...p("user_name"),placeholder:"Enter full name"}),v.user_name&&e.jsx("p",{className:"text-sm text-destructive",children:v.user_name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",children:"Email"}),e.jsx(ge,{id:"email",type:"email",...p("email"),placeholder:"Enter email address"}),v.email&&e.jsx("p",{className:"text-sm text-destructive",children:v.email.message})]}),!n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"password",type:c?"text":"password",...p("password"),placeholder:"Enter password"}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6",onClick:()=>d(b=>!b),children:c?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]}),v.password&&e.jsx("p",{className:"text-sm text-destructive",children:v.password.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"confirm_password",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"confirm_password",type:u?"text":"password",...p("confirm_password"),placeholder:"Re-enter password"}),e.jsx(F,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6",onClick:()=>h(b=>!b),children:u?e.jsx(zs,{className:"h-4 w-4"}):e.jsx(os,{className:"h-4 w-4"})})]}),v.confirm_password&&e.jsx("p",{className:"text-sm text-destructive",children:v.confirm_password.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(ge,{id:"phone_number",...p("phone_number"),placeholder:"Enter phone number"}),v.phone_number&&e.jsx("p",{className:"text-sm text-destructive",children:v.phone_number.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"company_name",children:"Company Name"}),e.jsx(ge,{id:"company_name",...p("company_name"),placeholder:"Enter company name"}),v.company_name&&e.jsx("p",{className:"text-sm text-destructive",children:v.company_name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"contact_number",children:"Contact Number"}),e.jsx(ge,{id:"contact_number",...p("contact_number"),placeholder:"Enter contact number"}),v.contact_number&&e.jsx("p",{className:"text-sm text-destructive",children:v.contact_number.message})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Settings & Limits"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"status",children:"Status"}),e.jsxs(Lt,{onValueChange:b=>y("status",b),children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select status"})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"active",children:"Active"}),e.jsx($e,{value:"inactive",children:"Inactive"})]})]}),v.status&&e.jsx("p",{className:"text-sm text-destructive",children:v.status.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"allowed_locations",children:"Allowed Locations"}),e.jsx(ge,{id:"allowed_locations",type:"number",...p("allowed_locations",{valueAsNumber:!0}),placeholder:"Number of locations allowed"}),v.allowed_locations&&e.jsx("p",{className:"text-sm text-destructive",children:v.allowed_locations.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"allowed_attendants_per_location",children:"Attendants per Location"}),e.jsx(ge,{id:"allowed_attendants_per_location",type:"number",...p("allowed_attendants_per_location",{valueAsNumber:!0}),placeholder:"Attendants allowed per location"}),v.allowed_attendants_per_location&&e.jsx("p",{className:"text-sm text-destructive",children:v.allowed_attendants_per_location.message})]})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold",children:"Parking Rates"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"2-Wheeler Rates ()"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 2 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_2wheeler.upTo2Hours",{valueAsNumber:!0})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 6 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_2wheeler.upTo6Hours",{valueAsNumber:!0})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 12 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_2wheeler.upTo12Hours",{valueAsNumber:!0})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 24 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_2wheeler.upTo24Hours",{valueAsNumber:!0})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"4-Wheeler Rates ()"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 2 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_4wheeler.upTo2Hours",{valueAsNumber:!0})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 6 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_4wheeler.upTo6Hours",{valueAsNumber:!0})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 12 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_4wheeler.upTo12Hours",{valueAsNumber:!0})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm",children:"Up to 24 hours"}),e.jsx(ge,{type:"number",step:"0.01",...p("rates_4wheeler.upTo24Hours",{valueAsNumber:!0})})]})]})]})]})]}),e.jsxs(Kn,{children:[e.jsx(F,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(F,{type:"submit",disabled:o,children:o?"Saving...":n?"Update Contractor":"Create Contractor"})]})]})]})})}var Bu="AlertDialog",[vv,Pb]=Rs(Bu,[bc]),Ws=bc(),Hu=a=>{const{__scopeAlertDialog:t,...s}=a,r=Ws(t);return e.jsx(Jo,{...r,...s,modal:!0})};Hu.displayName=Bu;var yv="AlertDialogTrigger",bv=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=Ws(s);return e.jsx(mm,{...n,...r,ref:t})});bv.displayName=yv;var wv="AlertDialogPortal",qu=a=>{const{__scopeAlertDialog:t,...s}=a,r=Ws(t);return e.jsx(Xo,{...r,...s})};qu.displayName=wv;var jv="AlertDialogOverlay",Wu=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=Ws(s);return e.jsx(En,{...n,...r,ref:t})});Wu.displayName=jv;var Ya="AlertDialogContent",[Nv,_v]=vv(Ya),Sv=tc("AlertDialogContent"),Yu=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,children:r,...n}=a,o=Ws(s),i=l.useRef(null),c=rt(t,i),d=l.useRef(null);return e.jsx(pm,{contentName:Ya,titleName:Gu,docsSlug:"alert-dialog",children:e.jsx(Nv,{scope:s,cancelRef:d,children:e.jsxs(Rn,{role:"alertdialog",...o,...n,ref:c,onOpenAutoFocus:Oe(n.onOpenAutoFocus,u=>{u.preventDefault(),d.current?.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[e.jsx(Sv,{children:r}),e.jsx(Cv,{contentRef:i})]})})})});Yu.displayName=Ya;var Gu="AlertDialogTitle",Zu=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=Ws(s);return e.jsx(Ko,{...n,...r,ref:t})});Zu.displayName=Gu;var Ku="AlertDialogDescription",Qu=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=Ws(s);return e.jsx(Qo,{...n,...r,ref:t})});Qu.displayName=Ku;var kv="AlertDialogAction",Ju=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,n=Ws(s);return e.jsx(Zo,{...n,...r,ref:t})});Ju.displayName=kv;var Xu="AlertDialogCancel",eh=l.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,{cancelRef:n}=_v(Xu,s),o=Ws(s),i=rt(t,n);return e.jsx(Zo,{...o,...r,ref:i})});eh.displayName=Xu;var Cv=({contentRef:a})=>{const t=`\`${Ya}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ya}\` by passing a \`${Ku}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ya}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return l.useEffect(()=>{document.getElementById(a.current?.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},Pv=Hu,Av=qu,th=Wu,sh=Yu,ah=Ju,rh=eh,nh=Zu,oh=Qu;const Cn=Pv,Ev=Av,ih=l.forwardRef(({className:a,...t},s)=>e.jsx(th,{className:ce("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...t,ref:s}));ih.displayName=th.displayName;const Dr=l.forwardRef(({className:a,...t},s)=>e.jsxs(Ev,{children:[e.jsx(ih,{}),e.jsx(sh,{ref:s,className:ce("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...t})]}));Dr.displayName=sh.displayName;const Ir=({className:a,...t})=>e.jsx("div",{className:ce("flex flex-col space-y-2 text-center sm:text-left",a),...t});Ir.displayName="AlertDialogHeader";const Or=({className:a,...t})=>e.jsx("div",{className:ce("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t});Or.displayName="AlertDialogFooter";const Lr=l.forwardRef(({className:a,...t},s)=>e.jsx(nh,{ref:s,className:ce("text-lg font-semibold",a),...t}));Lr.displayName=nh.displayName;const Mr=l.forwardRef(({className:a,...t},s)=>e.jsx(oh,{ref:s,className:ce("text-sm text-muted-foreground",a),...t}));Mr.displayName=oh.displayName;const Fr=l.forwardRef(({className:a,...t},s)=>e.jsx(ah,{ref:s,className:ce(Un(),a),...t}));Fr.displayName=ah.displayName;const $r=l.forwardRef(({className:a,...t},s)=>e.jsx(rh,{ref:s,className:ce(Un({variant:"outline"}),"mt-2 sm:mt-0",a),...t}));$r.displayName=rh.displayName;function Rv({contractors:a,onEdit:t,onRefresh:s,onSort:r,sortBy:n,sortOrder:o,loading:i}){const[c,d]=l.useState(null),[u,h]=l.useState(!1),{toast:m}=Tt(),p=async()=>{if(c){h(!0);try{await Ot.deleteContractor(c.id),m({title:"Success",description:"Contractor deleted successfully"}),s()}catch(y){m({title:"Error",description:y.message||"Failed to delete contractor",variant:"destructive"})}finally{h(!1),d(null)}}},f=y=>y==="active"?e.jsx(Je,{className:"bg-success/10 text-success border-success/20",children:"Active"}):e.jsx(Je,{variant:"secondary",children:"Inactive"}),v=y=>n!==y?e.jsx(fs,{className:"h-4 w-4"}):o==="asc"?e.jsx(fs,{className:"h-4 w-4 rotate-180"}):e.jsx(fs,{className:"h-4 w-4"});return i?e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading contractors..."})]})}):a.length===0?e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ra,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No contractors found"}),e.jsx("p",{className:"text-muted-foreground",children:"Get started by adding your first contractor"})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs(Hr,{children:[e.jsx(qr,{children:e.jsxs(Bs,{children:[e.jsx(tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r?.("company_name"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Company"}),v("company_name")]})}),e.jsx(tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r?.("profiles.user_name"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Contact Person"}),v("profiles.user_name")]})}),e.jsx(tt,{children:"Contact Info"}),e.jsx(tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r?.("status"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Status"}),v("status")]})}),e.jsx(tt,{children:"Locations"}),e.jsx(tt,{children:"Attendants/Location"}),e.jsx(tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r?.("created_on"),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Joined"}),v("created_on")]})}),e.jsx(tt,{children:"Actions"})]})}),e.jsx(Wr,{children:a.map(y=>e.jsxs(Bs,{children:[e.jsx(st,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:y.company_name||"N/A"})]})}),e.jsx(st,{children:e.jsx("div",{children:e.jsx("div",{className:"font-medium",children:y.profiles?.user_name||"N/A"})})}),e.jsx(st,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(bo,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{children:y.profiles?.email||"N/A"})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm",children:[e.jsx(zi,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{children:y.contact_number||"N/A"})]})]})}),e.jsx(st,{children:f(y.status)}),e.jsx(st,{children:e.jsx(Je,{variant:"outline",children:y.allowed_locations})}),e.jsx(st,{children:e.jsx(Je,{variant:"outline",children:y.allowed_attendants_per_location})}),e.jsx(st,{children:e.jsx("div",{className:"text-sm text-muted-foreground",children:zt(y.created_on)})}),e.jsx(st,{children:e.jsxs(mn,{children:[e.jsx(pn,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"sm",children:e.jsx(yo,{className:"h-4 w-4"})})}),e.jsxs(Ar,{align:"end",children:[e.jsxs(Vs,{onClick:()=>t(y),children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(Vs,{onClick:()=>d(y),className:"text-destructive",children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]},y.id))})]})}),e.jsx("div",{className:"lg:hidden space-y-4",children:a.map(y=>e.jsx(_e,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ra,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:y.company_name||"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:y.profiles?.user_name||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[f(y.status),e.jsxs(mn,{children:[e.jsx(pn,{asChild:!0,children:e.jsx(F,{variant:"ghost",size:"sm",children:e.jsx(yo,{className:"h-4 w-4"})})}),e.jsxs(Ar,{align:"end",children:[e.jsxs(Vs,{onClick:()=>t(y),children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(Vs,{onClick:()=>d(y),className:"text-destructive",children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(bo,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"truncate",children:y.profiles?.email||"N/A"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(zi,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{children:y.contact_number||"N/A"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Locations:"}),e.jsx(Je,{variant:"outline",className:"text-xs",children:y.allowed_locations})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Attendants:"}),e.jsx(Je,{variant:"outline",className:"text-xs",children:y.allowed_attendants_per_location})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Joined: ",zt(y.created_on)]})]})},y.id))}),e.jsx(Cn,{open:!!c,onOpenChange:()=>d(null),children:e.jsxs(Dr,{children:[e.jsxs(Ir,{children:[e.jsx(Lr,{children:"Delete Contractor"}),e.jsxs(Mr,{children:['Are you sure you want to delete "',c?.company_name,'"? This action cannot be undone and will also remove all associated locations and attendants.']})]}),e.jsxs(Or,{children:[e.jsx($r,{children:"Cancel"}),e.jsx(Fr,{onClick:p,disabled:u,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:u?"Deleting...":"Delete"})]})]})})]})}function Tv(){const[a,t]=l.useState([]),[s,r]=l.useState({totalContractors:0,totalLocations:0,totalAttendants:0,totalRevenue:0}),[n,o]=l.useState(!0),[i,c]=l.useState(!1),[d,u]=l.useState(null),[h,m]=l.useState({page:1,pageSize:10,totalPages:0,totalCount:0}),[p,f]=l.useState(""),[v,y]=l.useState("created_on"),[w,N]=l.useState("desc"),{toast:g}=Tt(),b=async(G=h.page,ae=p,$=v,Y=w)=>{try{o(!0),console.log("Fetching contractors...");const[Z,_]=await Promise.all([Ot.getPaginatedContractors({page:G,pageSize:h.pageSize,search:ae,sortBy:$,sortOrder:Y}),Ot.getDashboardStats()]);console.log("Contractors data received:",Z),t(Z.data),m(L=>({...L,page:Z.page,totalPages:Z.totalPages,totalCount:Z.count})),r({totalContractors:_.totalContractors,totalLocations:_.totalLocations,totalAttendants:_.totalAttendants,totalRevenue:_.totalRevenue})}catch(Z){console.error("Error fetching contractors:",Z),g({title:"Error",description:Z.message||"Failed to fetch contractors",variant:"destructive"})}finally{o(!1)}};l.useEffect(()=>{b()},[]);const A=G=>{m(ae=>({...ae,page:G})),b(G,p,v,w)},P=G=>{f(G),m(ae=>({...ae,page:1})),b(1,G,v,w)},E=G=>{const ae=v===G&&w==="desc"?"asc":"desc";y(G),N(ae),m($=>({...$,page:1})),b(1,p,G,ae)},V=G=>{m(ae=>({...ae,pageSize:G,page:1})),b(1,p,v,w)},M=()=>{u(null),c(!0)},O=G=>{u(G),c(!0)},I=()=>{c(!1),u(null)},ee=()=>{console.log("Form success - refreshing contractors..."),b()};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Contractors"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage business partners and their operations"})]}),e.jsxs(F,{onClick:M,className:"w-full sm:w-auto",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Contractor"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(Pe,{title:"Total Contractors",value:n?"...":s.totalContractors,description:"Active partners",icon:Ra,variant:"info"}),e.jsx(Pe,{title:"Total Locations",value:n?"...":s.totalLocations,description:"Managed sites",icon:rs,variant:"success"}),e.jsx(Pe,{title:"Total Attendants",value:n?"...":s.totalAttendants,description:"Staff members",icon:Wt,variant:"warning"}),e.jsx(Pe,{title:"Total Revenue",value:`${n?"...":s.totalRevenue.toFixed(2)}`,description:"Lifetime earnings",icon:vs,variant:"success"})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Be,{children:"Contractors List"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View and manage all contractors"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ua,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search contractors...",value:p,onChange:G=>P(G.target.value),className:"pl-8 w-full sm:w-64"})]}),e.jsxs(Lt,{value:h.pageSize.toString(),onValueChange:G=>V(Number(G)),children:[e.jsx(Ct,{className:"w-full sm:w-20",children:e.jsx(Mt,{})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"5",children:"5"}),e.jsx($e,{value:"10",children:"10"}),e.jsx($e,{value:"20",children:"20"}),e.jsx($e,{value:"50",children:"50"})]})]})]})]})}),e.jsxs(Ee,{children:[e.jsx(Rv,{contractors:a,onEdit:O,onRefresh:b,onSort:E,sortBy:v,sortOrder:w,loading:n}),h.totalPages>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-2 py-4",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",(h.page-1)*h.pageSize+1," to ",Math.min(h.page*h.pageSize,h.totalCount)," of ",h.totalCount," results"]}),e.jsx(Yr,{children:e.jsxs(Gr,{children:[e.jsx(Et,{children:e.jsx(Zr,{onClick:()=>A(h.page-1),className:h.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:Math.min(5,h.totalPages)},(G,ae)=>{let $;return h.totalPages<=5||h.page<=3?$=ae+1:h.page>=h.totalPages-2?$=h.totalPages-4+ae:$=h.page-2+ae,e.jsx(Et,{children:e.jsx($a,{onClick:()=>A($),isActive:h.page===$,className:"cursor-pointer",children:$})},$)}),h.totalPages>5&&h.page<h.totalPages-2&&e.jsx(Et,{children:e.jsx(Qr,{})}),e.jsx(Et,{children:e.jsx(Kr,{onClick:()=>A(h.page+1),className:h.page===h.totalPages?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})]})]}),e.jsx(gv,{isOpen:i,onClose:I,onSuccess:ee,contractor:d,isEditing:!!d})]})}function Dv(){const{profile:a,user:t}=ft(),s=a?.role==="super_admin",r=a?.role==="contractor",[n,o]=l.useState([]),[i,c]=l.useState([]),[d,u]=l.useState(!0),[h,m]=l.useState(null),[p,f]=l.useState(!1),[v,y]=l.useState(!1),[w,N]=l.useState(null),[g,b]=l.useState([]),[A,P]=l.useState(null),[E,V]=l.useState({locations_name:"",address:"",total_slots:0,contractor_id:"",status:"active"}),[M,O]=l.useState({page:1,pageSize:10,totalPages:0,totalCount:0}),[I,ee]=l.useState(""),[G,ae]=l.useState("created_on"),[$,Y]=l.useState("desc"),{toast:Z}=Tt(),_=l.useMemo(()=>{const D=M.totalCount,X=n.reduce((Ae,Ce)=>Ae+(Ce.total_slots||0),0),B=n.reduce((Ae,Ce)=>Ae+(Ce.occupied_slots||0),0),oe=X>0?Math.round(B/X*100):0;return{totalLocations:D,totalSlots:X,occupied:B,rate:oe}},[n,M.totalCount]),L=l.useMemo(()=>{if(r&&t)try{const{AuthAPI:D}=require("@/services/authApi");return D.getContractor()||A}catch{return A}return A},[r,t,A]),C=async(D=M.page,X=I,B=G,oe=$)=>{try{if(u(!0),s){const Ae={page:D,pageSize:M.pageSize,search:X,sortBy:B,sortOrder:oe},[Ce,Ie]=await Promise.all([es.getPaginatedLocations(Ae),Ot.getAllContractors()]);o(Ce.data),b(Ie),O(K=>({...K,page:Ce.page,totalPages:Ce.totalPages,totalCount:Ce.count}))}else if(r&&t){const Ae=t.id;console.log("Fetching locations for contractor user:",Ae);const{AuthAPI:Ce}=await Ye(async()=>{const{AuthAPI:Ne}=await Promise.resolve().then(()=>Bt);return{AuthAPI:Ne}},void 0);let Ie=Ce.getContractor();if(Ie)P(Ie);else try{Ie=await kt.getContractorByUserId(Ae),Ie&&Ce.setContractor(Ie)}catch(Ne){console.error("Failed to fetch contractor data:",Ne),Ie=null}const K=await es.getContractorLocations(Ae);console.log("Contractor locations result:",K),console.log("Contractor data:",Ie),c(K),P(Ie),T(K,D,X,B,oe)}else o([]),O(Ae=>({...Ae,page:1,totalPages:0,totalCount:0}))}catch(Ae){Z({variant:"destructive",title:"Error",description:Ae?.message||"Failed to load locations"})}finally{u(!1)}};l.useEffect(()=>{C()},[]);const T=(D,X,B,oe,Ae)=>{let Ce=[...D];if(B){const Ge=B.toLowerCase();Ce=Ce.filter(j=>j.locations_name.toLowerCase().includes(Ge)||(j.address||"").toLowerCase().includes(Ge))}Ce.sort((Ge,j)=>{const R=Ge[oe],W=j[oe];return R<W?Ae==="asc"?-1:1:R>W?Ae==="asc"?1:-1:0});const Ie=Ce.length,K=Math.max(1,Math.ceil(Ie/M.pageSize)),Ne=(X-1)*M.pageSize,Ve=Ne+M.pageSize;o(Ce.slice(Ne,Ve)),O(Ge=>({...Ge,page:X,totalPages:K,totalCount:Ie}))},H=D=>{O(X=>({...X,page:D})),s?C(D,I,G,$):T(i,D,I,G,$)},x=D=>{ee(D),O(X=>({...X,page:1})),s?C(1,D,G,$):T(i,1,D,G,$)},S=D=>{const X=G===D&&$==="desc"?"asc":"desc";ae(D),Y(X),O(B=>({...B,page:1})),s?C(1,I,D,X):T(i,1,I,D,X)},q=D=>{O(X=>({...X,pageSize:D,page:1})),s?C(1,I,G,$):T(i,1,I,G,$)},U=async()=>{N(null);let D="";if(r&&t){const{AuthAPI:X}=await Ye(async()=>{const{AuthAPI:oe}=await Promise.resolve().then(()=>Bt);return{AuthAPI:oe}},void 0),B=X.getContractor();if(B&&B.id)D=B.id,P(B);else if(A&&A.id)D=A.id;else try{const oe=await kt.getContractorByUserId(t.id);oe&&oe.id&&(D=oe.id,P(oe))}catch(oe){console.error("Failed to fetch contractor data:",oe)}}V({locations_name:"",address:"",total_slots:0,contractor_id:D,status:"active"}),s&&Ot.getAllContractors().then(b).catch(()=>{}),y(!0)},de=D=>{N(D),V({locations_name:D.locations_name,address:D.address,total_slots:D.total_slots,contractor_id:D.contractor_id,status:D.status}),y(!0)},Q=async()=>{try{if(f(!0),!E.locations_name||!E.address){Z({variant:"destructive",title:"Validation",description:"Please fill all required fields"}),f(!1);return}if(r&&t&&!E.contractor_id){const{AuthAPI:D}=await Ye(async()=>{const{AuthAPI:B}=await Promise.resolve().then(()=>Bt);return{AuthAPI:B}},void 0),X=D.getContractor();if(X&&X.id)V({...E,contractor_id:X.id});else if(A&&A.id)V({...E,contractor_id:A.id});else{Z({variant:"destructive",title:"Error",description:"Contractor information not found. Please refresh the page."}),f(!1);return}}if(!E.contractor_id){Z({variant:"destructive",title:"Validation",description:"Contractor is required"}),f(!1);return}if(r&&t&&!w){const{AuthAPI:D}=await Ye(async()=>{const{AuthAPI:B}=await Promise.resolve().then(()=>Bt);return{AuthAPI:B}},void 0),X=D.getContractor()||A;if(X){const B=i.length,oe=X.allowed_locations||0;if(B>=oe){Z({variant:"destructive",title:"Limit Reached",description:`You have reached the maximum limit of ${oe} locations. Please contact admin to increase your limit.`}),f(!1);return}}}w?(await es.updateLocation(w.id,E),Z({title:"Updated",description:"Location updated"})):(await es.createLocation(E),Z({title:"Created",description:"Location created successfully"})),y(!1),N(null),C()}catch(D){Z({variant:"destructive",title:"Error",description:D?.message||"Failed to save"})}finally{f(!1)}},z=async D=>{try{m(D),await es.deleteLocation(D),Z({title:"Deleted",description:"Location deleted"}),C()}catch(X){Z({variant:"destructive",title:"Error",description:X?.message||"Failed to delete"})}finally{m(null)}};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Parking Locations"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage parking sites and their configurations"})]}),(s||r)&&e.jsxs(F,{onClick:U,className:"w-full sm:w-auto",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Location"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(Pe,{title:"Total Locations",value:_.totalLocations,description:"Active sites",icon:rs,variant:"success"}),e.jsx(Pe,{title:"Total Slots",value:_.totalSlots,description:"Available spaces",icon:ot,variant:"info"}),e.jsx(Pe,{title:"Occupied Slots",value:_.occupied,description:"Currently in use",icon:Wt,variant:"warning"}),e.jsx(Pe,{title:"Occupancy Rate",value:`${_.rate}%`,description:"Current utilization",icon:vs,variant:_.rate>80?"danger":_.rate>60?"warning":"success"})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Be,{children:"Location List"}),e.jsx(et,{children:s?"View and manage all parking locations":"View your assigned parking locations"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ua,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search locations...",value:I,onChange:D=>x(D.target.value),className:"pl-8 w-full sm:w-64"})]}),e.jsxs(Lt,{value:M.pageSize.toString(),onValueChange:D=>q(Number(D)),children:[e.jsx(Ct,{className:"w-full sm:w-20",children:e.jsx(Mt,{})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"5",children:"5"}),e.jsx($e,{value:"10",children:"10"}),e.jsx($e,{value:"20",children:"20"}),e.jsx($e,{value:"50",children:"50"})]})]})]})]})}),e.jsxs(Ee,{children:[d?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-parkflow-blue mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading locations..."})]}):n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rs,{className:"h-16 w-16 text-muted-foreground mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-semibold mb-3",children:"No locations found"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:s?"Get started by adding your first parking location to manage your parking business.":"Your account has no assigned locations yet. Contact your administrator or create sample data for testing."}),(s||r)&&e.jsxs(F,{onClick:U,size:"lg",children:[e.jsx(da,{className:"h-5 w-5 mr-2"}),"Add First Location"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs(Hr,{children:[e.jsx(qr,{children:e.jsxs(Bs,{children:[e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>S("locations_name"),className:"h-auto p-0 font-semibold",children:["Location",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>S("address"),className:"h-auto p-0 font-semibold",children:["Address",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),e.jsx(tt,{children:"Contractor"}),e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>S("total_slots"),className:"h-auto p-0 font-semibold",children:["Slots",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>S("occupied_slots"),className:"h-auto p-0 font-semibold",children:["Occupied",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),e.jsx(tt,{children:e.jsxs(F,{variant:"ghost",onClick:()=>S("status"),className:"h-auto p-0 font-semibold",children:["Status",e.jsx(fs,{className:"ml-2 h-4 w-4"})]})}),(s||r)&&e.jsx(tt,{children:"Actions"})]})}),e.jsx(Wr,{children:n.map(D=>e.jsxs(Bs,{children:[e.jsx(st,{className:"font-medium",children:D.locations_name}),e.jsx(st,{children:D.address}),e.jsx(st,{children:D.contractors?.company_name||"-"}),e.jsx(st,{children:D.total_slots}),e.jsx(st,{children:D.occupied_slots||0}),e.jsx(st,{children:e.jsx(Je,{variant:D.status==="active"?"default":"secondary",children:D.status})}),(s||r)&&e.jsx(st,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>de(D),disabled:h!==null,children:e.jsx(ha,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>z(D.id),disabled:h!==null,children:h===D.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):e.jsx(As,{className:"h-4 w-4"})})]})})]},D.id))})]})}),e.jsx("div",{className:"lg:hidden space-y-4",children:n.map(D=>e.jsx(_e,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rs,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:D.locations_name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:D.address})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Je,{variant:D.status==="active"?"default":"secondary",className:"text-xs",children:D.status}),(s||r)&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>de(D),disabled:h!==null,children:e.jsx(ha,{className:"h-4 w-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>z(D.id),disabled:h!==null,children:h===D.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):e.jsx(As,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Contractor:"}),e.jsx("p",{className:"font-medium",children:D.contractors?.company_name||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Slots:"}),e.jsx("p",{className:"font-medium",children:D.total_slots})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Occupied:"}),e.jsx("p",{className:"font-medium",children:D.occupied_slots||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Available:"}),e.jsx("p",{className:"font-medium",children:(D.total_slots||0)-(D.occupied_slots||0)})]})]})]})},D.id))})]}),M.totalPages>1&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-2 py-4",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",(M.page-1)*M.pageSize+1," to ",Math.min(M.page*M.pageSize,M.totalCount)," of ",M.totalCount," results"]}),e.jsx(Yr,{children:e.jsxs(Gr,{children:[e.jsx(Et,{children:e.jsx(Zr,{onClick:()=>H(M.page-1),className:M.page===1?"pointer-events-none opacity-50":"cursor-pointer"})}),Array.from({length:Math.min(5,M.totalPages)},(D,X)=>{let B;return M.totalPages<=5||M.page<=3?B=X+1:M.page>=M.totalPages-2?B=M.totalPages-4+X:B=M.page-2+X,e.jsx(Et,{children:e.jsx($a,{onClick:()=>H(B),isActive:M.page===B,className:"cursor-pointer",children:B})},B)}),M.totalPages>5&&M.page<M.totalPages-2&&e.jsx(Et,{children:e.jsx(Qr,{})}),e.jsx(Et,{children:e.jsx(Kr,{onClick:()=>H(M.page+1),className:M.page===M.totalPages?"pointer-events-none opacity-50":"cursor-pointer"})})]})})]})]})]}),(s||r)&&e.jsx(bt,{open:v,onOpenChange:y,children:e.jsxs(yt,{className:"w-[95vw] sm:w-full max-w-2xl",children:[e.jsxs(wt,{children:[e.jsx(jt,{className:"text-lg sm:text-xl",children:w?"Edit Location":"Add Location"}),e.jsxs(At,{className:"text-sm",children:[w?"Update parking location details":"Configure parking location details",r&&L&&!w&&e.jsxs("span",{className:"block mt-1 text-xs",children:["Locations: ",i.length," / ",L.allowed_locations||0," used",i.length>=(L.allowed_locations||0)&&e.jsx("span",{className:"text-red-500 ml-2",children:"(Limit reached)"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"name",children:"Location Name"}),e.jsx(ge,{id:"name",value:E.locations_name||"",onChange:D=>V({...E,locations_name:D.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"slots",children:"Total Slots"}),e.jsx(ge,{id:"slots",type:"number",value:E.total_slots??0,onChange:D=>V({...E,total_slots:Number(D.target.value)})})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(te,{htmlFor:"address",children:"Address"}),e.jsx(ge,{id:"address",value:E.address||"",onChange:D=>V({...E,address:D.target.value})})]}),s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Contractor"}),e.jsxs(Lt,{value:E.contractor_id||"",onValueChange:D=>V({...E,contractor_id:D}),children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select contractor"})}),e.jsx(Pt,{children:g.length===0?e.jsx("div",{className:"px-3 py-2 text-sm text-muted-foreground",children:"No contractors found"}):g.map(D=>e.jsx($e,{value:D.id,children:D.company_name||D.profiles?.user_name||D.profiles?.email},D.id))})]})]}),r&&L&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Contractor"}),e.jsx(ge,{value:L.company_name||L.profiles?.user_name||"Your Account",disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Status"}),e.jsxs(Lt,{value:E.status||"active",onValueChange:D=>V({...E,status:D}),children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select status"})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"active",children:"Active"}),e.jsx($e,{value:"inactive",children:"Inactive"}),e.jsx($e,{value:"maintenance",children:"Maintenance"})]})]})]})]}),e.jsxs(Kn,{children:[e.jsx(F,{variant:"outline",onClick:()=>y(!1),disabled:p,children:"Cancel"}),e.jsx(F,{onClick:Q,disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current mr-2"}),w?"Updating...":"Creating..."]}):w?"Update":"Create"})]})]})})]})}var Ti="Radio",[Iv,lh]=Rs(Ti),[Ov,Lv]=Iv(Ti),ch=l.forwardRef((a,t)=>{const{__scopeRadio:s,name:r,checked:n=!1,required:o,disabled:i,value:c="on",onCheck:d,form:u,...h}=a,[m,p]=l.useState(null),f=rt(t,w=>p(w)),v=l.useRef(!1),y=m?u||!!m.closest("form"):!0;return e.jsxs(Ov,{scope:s,checked:n,disabled:i,children:[e.jsx(De.button,{type:"button",role:"radio","aria-checked":n,"data-state":mh(n),"data-disabled":i?"":void 0,disabled:i,value:c,...h,ref:f,onClick:Oe(a.onClick,w=>{n||d?.(),y&&(v.current=w.isPropagationStopped(),v.current||w.stopPropagation())})}),y&&e.jsx(hh,{control:m,bubbles:!v.current,name:r,value:c,checked:n,required:o,disabled:i,form:u,style:{transform:"translateX(-100%)"}})]})});ch.displayName=Ti;var dh="RadioIndicator",uh=l.forwardRef((a,t)=>{const{__scopeRadio:s,forceMount:r,...n}=a,o=Lv(dh,s);return e.jsx(Ts,{present:r||o.checked,children:e.jsx(De.span,{"data-state":mh(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:t})})});uh.displayName=dh;var Mv="RadioBubbleInput",hh=l.forwardRef(({__scopeRadio:a,control:t,checked:s,bubbles:r=!0,...n},o)=>{const i=l.useRef(null),c=rt(i,o),d=xi(s),u=uc(t);return l.useEffect(()=>{const h=i.current;if(!h)return;const m=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(m,"checked").set;if(d!==s&&f){const v=new Event("click",{bubbles:r});f.call(h,s),h.dispatchEvent(v)}},[d,s,r]),e.jsx(De.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:c,style:{...n.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});hh.displayName=Mv;function mh(a){return a?"checked":"unchecked"}var Fv=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Xn="RadioGroup",[$v,Ab]=Rs(Xn,[Tn,lh]),ph=Tn(),fh=lh(),[Vv,Uv]=$v(Xn),xh=l.forwardRef((a,t)=>{const{__scopeRadioGroup:s,name:r,defaultValue:n,value:o,required:i=!1,disabled:c=!1,orientation:d,dir:u,loop:h=!0,onValueChange:m,...p}=a,f=ph(s),v=An(u),[y,w]=Ia({prop:o,defaultProp:n??null,onChange:m,caller:Xn});return e.jsx(Vv,{scope:s,name:r,required:i,disabled:c,value:y,onValueChange:w,children:e.jsx(vc,{asChild:!0,...f,orientation:d,dir:v,loop:h,children:e.jsx(De.div,{role:"radiogroup","aria-required":i,"aria-orientation":d,"data-disabled":c?"":void 0,dir:v,...p,ref:t})})})});xh.displayName=Xn;var gh="RadioGroupItem",vh=l.forwardRef((a,t)=>{const{__scopeRadioGroup:s,disabled:r,...n}=a,o=Uv(gh,s),i=o.disabled||r,c=ph(s),d=fh(s),u=l.useRef(null),h=rt(t,u),m=o.value===n.value,p=l.useRef(!1);return l.useEffect(()=>{const f=y=>{Fv.includes(y.key)&&(p.current=!0)},v=()=>p.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",v),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",v)}},[]),e.jsx(yc,{asChild:!0,...c,focusable:!i,active:m,children:e.jsx(ch,{disabled:i,required:o.required,checked:m,...d,...n,name:o.name,ref:h,onCheck:()=>o.onValueChange(n.value),onKeyDown:Oe(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:Oe(n.onFocus,()=>{p.current&&u.current?.click()})})})});vh.displayName=gh;var zv="RadioGroupIndicator",yh=l.forwardRef((a,t)=>{const{__scopeRadioGroup:s,...r}=a,n=fh(s);return e.jsx(uh,{...n,...r,ref:t})});yh.displayName=zv;var bh=xh,wh=vh,Bv=yh;const jh=l.forwardRef(({className:a,...t},s)=>e.jsx(bh,{className:ce("grid gap-2",a),...t,ref:s}));jh.displayName=bh.displayName;const Vo=l.forwardRef(({className:a,...t},s)=>e.jsx(wh,{ref:s,className:ce("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),...t,children:e.jsx(Bv,{className:"flex items-center justify-center",children:e.jsx(Sc,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Vo.displayName=wh.displayName;function Hv({onCapture:a,onClose:t}){const s=l.useRef(null),r=l.useRef(null),[n,o]=l.useState(null);l.useState(!1);const i=async()=>{try{const u=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});o(u),s.current&&(s.current.srcObject=u)}catch(u){console.error("Error accessing camera:",u),alert("Unable to access camera. Please check permissions.")}},c=()=>{if(s.current&&r.current){const u=s.current,h=r.current,m=h.getContext("2d");if(m){h.width=u.videoWidth,h.height=u.videoHeight,m.drawImage(u,0,0);const p=h.toDataURL("image/jpeg");a(p),d()}}},d=()=>{n&&(n.getTracks().forEach(u=>u.stop()),o(null)),t()};return le.useEffect(()=>(i(),()=>{n&&n.getTracks().forEach(u=>u.stop())}),[]),e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Capture Plate Number"}),e.jsx(F,{variant:"ghost",size:"sm",onClick:d,children:e.jsx(Ds,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,className:"w-full h-64 bg-gray-200 rounded-lg"}),e.jsx("canvas",{ref:r,className:"hidden"})]}),e.jsxs("div",{className:"flex justify-center mt-4 space-x-2",children:[e.jsxs(F,{onClick:c,disabled:!n,children:[e.jsx(ra,{className:"h-4 w-4 mr-2"}),"Capture"]}),e.jsx(F,{variant:"outline",onClick:d,children:"Cancel"})]})]})})}function qv(a,t,s,r){const n=new Date(a),i=new Date(t).getTime()-n.getTime(),c=i/(1e3*60*60),d=Math.floor(c),u=Math.floor(i%(1e3*60*60)/(1e3*60)),h=Math.floor(i%(1e3*60)/1e3),m=`${d.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`;let p=0,f="";if(c<=2)p=r.upTo2Hours,f=`Up to 2 hours: ${r.upTo2Hours}`;else if(c<=6)p=r.upTo6Hours,f=`Up to 6 hours: ${r.upTo6Hours}`;else if(c<=12)p=r.upTo12Hours,f=`Up to 12 hours: ${r.upTo12Hours}`;else if(c<=24)p=r.upTo24Hours,f=`Up to 24 hours: ${r.upTo24Hours}`;else{const v=Math.floor(c/24),y=c%24;p=v*r.upTo24Hours+y*(r.upTo24Hours/24),f=`${v} day(s)  ${r.upTo24Hours} + ${y.toFixed(1)}h  ${(r.upTo24Hours/24).toFixed(2)}/h = ${p.toFixed(2)}`}return{duration:{hours:d,minutes:u,seconds:h,totalHours:c,formatted:m},amount:Math.round(p*100)/100,breakdown:f}}function Wv({isOpen:a,onClose:t,onConfirm:s,vehicle:r,contractorRates:n,loading:o=!1}){const[i,c]=l.useState("cash"),[d,u]=l.useState(null);l.useEffect(()=>{if(r&&n){const m=r.vehicle_type==="2-wheeler"?n.rates_2wheeler:n.rates_4wheeler,p=qv(r.check_in_time,new Date().toISOString(),r.vehicle_type,m);u(p)}},[r,n]);const h=()=>{d&&s({payment_amount:d.amount,payment_method:i})};return!r||!d?null:e.jsx(bt,{open:a,onOpenChange:t,children:e.jsxs(yt,{className:"max-w-md",children:[e.jsxs(wt,{children:[e.jsx(jt,{className:"text-2xl font-bold",children:"Check Out Vehicle"}),e.jsx(At,{children:"Review parking details and complete payment"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_e,{children:[e.jsx(ze,{className:"pb-3",children:e.jsxs(Be,{className:"text-lg flex items-center space-x-2",children:[r.vehicle_type==="2-wheeler"?e.jsx(Br,{className:"h-5 w-5"}):e.jsx(ot,{className:"h-5 w-5"}),e.jsx("span",{children:r.plate_number})]})}),e.jsx(Ee,{className:"pt-0",children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("span",{className:"font-medium",children:r.vehicle_type})]}),r.location&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Location:"}),e.jsx("span",{className:"font-medium",children:r.location.locations_name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Check In:"}),e.jsx("span",{className:"font-medium",children:ts(r.check_in_time)})]})]})})]}),e.jsxs(_e,{children:[e.jsx(ze,{className:"pb-3",children:e.jsxs(Be,{className:"text-lg flex items-center space-x-2",children:[e.jsx(qs,{className:"h-5 w-5"}),e.jsx("span",{children:"Parking Details"})]})}),e.jsx(Ee,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsx("span",{className:"font-mono text-lg font-bold",children:d.duration.formatted})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Rate:"}),e.jsx("span",{className:"text-sm",children:d.breakdown})]}),e.jsx("div",{className:"border-t pt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Total Amount:"}),e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",d.amount.toFixed(2)]})]})})]})})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-base font-semibold mb-3 block",children:"Payment Method"}),e.jsxs(Lt,{value:i,onValueChange:c,children:[e.jsx(Ct,{children:e.jsx(Mt,{})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"cash",children:"Cash"}),e.jsx($e,{value:"card",children:"Card"}),e.jsx($e,{value:"digital",children:"Digital Payment"}),e.jsx($e,{value:"free",children:"Free"})]})]})]}),e.jsxs("div",{className:"flex justify-center space-x-3 pt-4",children:[e.jsx(F,{variant:"outline",onClick:t,disabled:o,children:"Cancel"}),e.jsx(F,{onClick:h,disabled:o,className:"bg-green-600 hover:bg-green-700",children:o?"Processing...":"Confirm Checkout"})]})]})]})})}function Yv({isOpen:a,onClose:t,vehicle:s,paymentAmount:r,paymentMethod:n,duration:o}){return s?e.jsx(bt,{open:a,onOpenChange:t,children:e.jsxs(yt,{className:"max-w-md",children:[e.jsx(wt,{children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Rt,{className:"w-8 h-8 text-green-600"})}),e.jsx(jt,{className:"text-2xl font-bold text-gray-900",children:"Checkout Successful"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600 text-center",children:["Vehicle ",e.jsxs("span",{className:"font-bold text-gray-900",children:["**",s.plate_number,"**"]})," has been checked out."]}),e.jsx("div",{className:"border-t border-gray-200"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Payment Due"}),e.jsxs("div",{className:"text-4xl font-bold text-blue-600",children:["",r.toFixed(2)]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(F,{onClick:t,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3",children:[e.jsx(Rt,{className:"h-5 w-5 mr-2"}),"Done"]})})]})]})}):null}function Gv({isOpen:a,onClose:t,onConfirm:s,vehicle:r}){return r?e.jsx(bt,{open:a,onOpenChange:t,children:e.jsxs(yt,{className:"max-w-md",children:[e.jsx(wt,{children:e.jsx(jt,{className:"text-xl font-bold text-gray-900",children:"Confirm Vehicle Check-out"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to check out the vehicle with plate number"," ",e.jsxs("span",{className:"font-bold text-gray-900",children:["**",r.plate_number,"**"]}),"?"]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[r.vehicle_type==="2-wheeler"?e.jsx(Br,{className:"h-5 w-5 text-gray-600"}):e.jsx(ot,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:r.plate_number}),e.jsx("div",{className:"text-sm text-gray-600",children:r.vehicle_type==="2-wheeler"?"2 Wheeler":"4 Wheeler"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(F,{variant:"outline",onClick:t,className:"px-6",children:"Cancel"}),e.jsx(F,{onClick:s,className:"px-6 bg-blue-600 hover:bg-blue-700 text-white",children:"Confirm Check-out"})]})]})]})}):null}function Zv({isOpen:a,onClose:t,onConfirm:s,vehicle:r,loading:n=!1}){return r?e.jsx(bt,{open:a,onOpenChange:t,children:e.jsxs(yt,{className:"max-w-md",children:[e.jsxs(wt,{children:[e.jsx(jt,{className:"text-2xl font-bold",children:"Confirm Vehicle Check-in"}),e.jsx(At,{children:"Please confirm the vehicle details are correct to avoid errors."})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[r.vehicle_type==="2-wheeler"?e.jsx(Br,{className:"h-8 w-8 text-blue-600"}):e.jsx(ot,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["Plate Number: ",r.plate_number]}),e.jsxs("div",{className:"text-sm font-medium text-gray-700",children:["Vehicle Type: ",r.vehicle_type==="2-wheeler"?"2 Wheeler":"4 Wheeler"]}),r.mobile_number&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Mobile: ",r.mobile_number]}),r.location&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Location: ",r.location.locations_name]})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(F,{variant:"outline",onClick:t,disabled:n,children:"Cancel"}),e.jsx(F,{onClick:s,className:"bg-blue-600 hover:bg-blue-700",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 inline-block"}),"Processing..."]}):"Confirm Check-in"})]})]})]})}):null}var Kv={exports:{}};(function(a){var t=function(s){var r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(C,T,H){C[T]=H.value},i,c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",h=c.toStringTag||"@@toStringTag";function m(C,T,H){return Object.defineProperty(C,T,{value:H,enumerable:!0,configurable:!0,writable:!0}),C[T]}try{m({},"")}catch{m=function(T,H,x){return T[H]=x}}function p(C,T,H,x){var S=T&&T.prototype instanceof b?T:b,q=Object.create(S.prototype),U=new Z(x||[]);return o(q,"_invoke",{value:G(C,H,U)}),q}s.wrap=p;function f(C,T,H){try{return{type:"normal",arg:C.call(T,H)}}catch(x){return{type:"throw",arg:x}}}var v="suspendedStart",y="suspendedYield",w="executing",N="completed",g={};function b(){}function A(){}function P(){}var E={};m(E,d,function(){return this});var V=Object.getPrototypeOf,M=V&&V(V(_([])));M&&M!==r&&n.call(M,d)&&(E=M);var O=P.prototype=b.prototype=Object.create(E);A.prototype=P,o(O,"constructor",{value:P,configurable:!0}),o(P,"constructor",{value:A,configurable:!0}),A.displayName=m(P,h,"GeneratorFunction");function I(C){["next","throw","return"].forEach(function(T){m(C,T,function(H){return this._invoke(T,H)})})}s.isGeneratorFunction=function(C){var T=typeof C=="function"&&C.constructor;return T?T===A||(T.displayName||T.name)==="GeneratorFunction":!1},s.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,P):(C.__proto__=P,m(C,h,"GeneratorFunction")),C.prototype=Object.create(O),C},s.awrap=function(C){return{__await:C}};function ee(C,T){function H(q,U,de,Q){var z=f(C[q],C,U);if(z.type==="throw")Q(z.arg);else{var D=z.arg,X=D.value;return X&&typeof X=="object"&&n.call(X,"__await")?T.resolve(X.__await).then(function(B){H("next",B,de,Q)},function(B){H("throw",B,de,Q)}):T.resolve(X).then(function(B){D.value=B,de(D)},function(B){return H("throw",B,de,Q)})}}var x;function S(q,U){function de(){return new T(function(Q,z){H(q,U,Q,z)})}return x=x?x.then(de,de):de()}o(this,"_invoke",{value:S})}I(ee.prototype),m(ee.prototype,u,function(){return this}),s.AsyncIterator=ee,s.async=function(C,T,H,x,S){S===void 0&&(S=Promise);var q=new ee(p(C,T,H,x),S);return s.isGeneratorFunction(T)?q:q.next().then(function(U){return U.done?U.value:q.next()})};function G(C,T,H){var x=v;return function(q,U){if(x===w)throw new Error("Generator is already running");if(x===N){if(q==="throw")throw U;return L()}for(H.method=q,H.arg=U;;){var de=H.delegate;if(de){var Q=ae(de,H);if(Q){if(Q===g)continue;return Q}}if(H.method==="next")H.sent=H._sent=H.arg;else if(H.method==="throw"){if(x===v)throw x=N,H.arg;H.dispatchException(H.arg)}else H.method==="return"&&H.abrupt("return",H.arg);x=w;var z=f(C,T,H);if(z.type==="normal"){if(x=H.done?N:y,z.arg===g)continue;return{value:z.arg,done:H.done}}else z.type==="throw"&&(x=N,H.method="throw",H.arg=z.arg)}}}function ae(C,T){var H=T.method,x=C.iterator[H];if(x===i)return T.delegate=null,H==="throw"&&C.iterator.return&&(T.method="return",T.arg=i,ae(C,T),T.method==="throw")||H!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+H+"' method")),g;var S=f(x,C.iterator,T.arg);if(S.type==="throw")return T.method="throw",T.arg=S.arg,T.delegate=null,g;var q=S.arg;if(!q)return T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,g;if(q.done)T[C.resultName]=q.value,T.next=C.nextLoc,T.method!=="return"&&(T.method="next",T.arg=i);else return q;return T.delegate=null,g}I(O),m(O,h,"Generator"),m(O,d,function(){return this}),m(O,"toString",function(){return"[object Generator]"});function $(C){var T={tryLoc:C[0]};1 in C&&(T.catchLoc=C[1]),2 in C&&(T.finallyLoc=C[2],T.afterLoc=C[3]),this.tryEntries.push(T)}function Y(C){var T=C.completion||{};T.type="normal",delete T.arg,C.completion=T}function Z(C){this.tryEntries=[{tryLoc:"root"}],C.forEach($,this),this.reset(!0)}s.keys=function(C){var T=Object(C),H=[];for(var x in T)H.push(x);return H.reverse(),function S(){for(;H.length;){var q=H.pop();if(q in T)return S.value=q,S.done=!1,S}return S.done=!0,S}};function _(C){if(C){var T=C[d];if(T)return T.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var H=-1,x=function S(){for(;++H<C.length;)if(n.call(C,H))return S.value=C[H],S.done=!1,S;return S.value=i,S.done=!0,S};return x.next=x}}return{next:L}}s.values=_;function L(){return{value:i,done:!0}}return Z.prototype={constructor:Z,reset:function(C){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(Y),!C)for(var T in this)T.charAt(0)==="t"&&n.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=i)},stop:function(){this.done=!0;var C=this.tryEntries[0],T=C.completion;if(T.type==="throw")throw T.arg;return this.rval},dispatchException:function(C){if(this.done)throw C;var T=this;function H(Q,z){return q.type="throw",q.arg=C,T.next=Q,z&&(T.method="next",T.arg=i),!!z}for(var x=this.tryEntries.length-1;x>=0;--x){var S=this.tryEntries[x],q=S.completion;if(S.tryLoc==="root")return H("end");if(S.tryLoc<=this.prev){var U=n.call(S,"catchLoc"),de=n.call(S,"finallyLoc");if(U&&de){if(this.prev<S.catchLoc)return H(S.catchLoc,!0);if(this.prev<S.finallyLoc)return H(S.finallyLoc)}else if(U){if(this.prev<S.catchLoc)return H(S.catchLoc,!0)}else if(de){if(this.prev<S.finallyLoc)return H(S.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(C,T){for(var H=this.tryEntries.length-1;H>=0;--H){var x=this.tryEntries[H];if(x.tryLoc<=this.prev&&n.call(x,"finallyLoc")&&this.prev<x.finallyLoc){var S=x;break}}S&&(C==="break"||C==="continue")&&S.tryLoc<=T&&T<=S.finallyLoc&&(S=null);var q=S?S.completion:{};return q.type=C,q.arg=T,S?(this.method="next",this.next=S.finallyLoc,g):this.complete(q)},complete:function(C,T){if(C.type==="throw")throw C.arg;return C.type==="break"||C.type==="continue"?this.next=C.arg:C.type==="return"?(this.rval=this.arg=C.arg,this.method="return",this.next="end"):C.type==="normal"&&T&&(this.next=T),g},finish:function(C){for(var T=this.tryEntries.length-1;T>=0;--T){var H=this.tryEntries[T];if(H.finallyLoc===C)return this.complete(H.completion,H.afterLoc),Y(H),g}},catch:function(C){for(var T=this.tryEntries.length-1;T>=0;--T){var H=this.tryEntries[T];if(H.tryLoc===C){var x=H.completion;if(x.type==="throw"){var S=x.arg;Y(H)}return S}}throw new Error("illegal catch attempt")},delegateYield:function(C,T,H){return this.delegate={iterator:_(C),resultName:T,nextLoc:H},this.method==="next"&&(this.arg=i),g}},s}(a.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})(Kv);var Di=(a,t)=>`${a}-${t}-${Math.random().toString(16).slice(3,8)}`;const Qv=Di;let Tl=0;var Nh=({id:a,action:t,payload:s={}})=>{let r=a;return typeof r>"u"&&(r=Qv("Job",Tl),Tl+=1),{id:r,action:t,payload:s}},mr={};let Ii=!1;mr.logging=Ii;mr.setLogging=a=>{Ii=a};mr.log=(...a)=>Ii?console.log.apply(void 0,a):null;const Jv=Nh,{log:nn}=mr,Xv=Di;let Dl=0;var ey=()=>{const a=Xv("Scheduler",Dl),t={},s={};let r=[];Dl+=1;const n=()=>r.length,o=()=>Object.keys(t).length,i=()=>{if(r.length!==0){const m=Object.keys(t);for(let p=0;p<m.length;p+=1)if(typeof s[m[p]]>"u"){r[0](t[m[p]]);break}}},c=(m,p)=>new Promise((f,v)=>{const y=Jv({action:m,payload:p});r.push(async w=>{r.shift(),s[w.id]=y;try{f(await w[m].apply(void 0,[...p,y.id]))}catch(N){v(N)}finally{delete s[w.id],i()}}),nn(`[${a}]: Add ${y.id} to JobQueue`),nn(`[${a}]: JobQueue length=${r.length}`),i()});return{addWorker:m=>(t[m.id]=m,nn(`[${a}]: Add ${m.id}`),nn(`[${a}]: Number of workers=${o()}`),i(),m.id),addJob:async(m,...p)=>{if(o()===0)throw Error(`[${a}]: You need to have at least one worker before adding jobs`);return c(m,p)},terminate:async()=>{Object.keys(t).forEach(async m=>{await t[m].terminate()}),r=[]},getQueueLen:n,getNumWorkers:o}};function ty(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sy=a=>{const t={};return typeof WorkerGlobalScope<"u"?t.type="webworker":typeof document=="object"?t.type="browser":typeof process=="object"&&typeof ty=="function"&&(t.type="node"),typeof a>"u"?t:t[a]};const ay=sy("type")==="browser",ry=ay?a=>new URL(a,window.location.href).href:a=>a;var ny=a=>{const t={...a};return["corePath","workerPath","langPath"].forEach(s=>{a[s]&&(t[s]=ry(t[s]))}),t},_h={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const oy="tesseract.js",iy="6.0.1",ly="Pure Javascript Multilingual OCR",cy="src/index.js",dy="commonjs",uy="src/index.d.ts",hy="dist/tesseract.min.js",my="dist/tesseract.min.js",py={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},fy={"./src/worker/node/index.js":"./src/worker/browser/index.js"},xy="",gy=["jeromewu"],vy="Apache-2.0",yy={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},by={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},wy={"@rollup/pluginutils":"^5.0.2"},jy={type:"git",url:"https://github.com/naptha/tesseract.js.git"},Ny={url:"https://github.com/naptha/tesseract.js/issues"},_y="https://github.com/naptha/tesseract.js",Sy={type:"opencollective",url:"https://opencollective.com/tesseractjs"},ky={name:oy,version:iy,description:ly,main:cy,type:dy,types:uy,unpkg:hy,jsdelivr:my,scripts:py,browser:fy,author:xy,contributors:gy,license:vy,devDependencies:yy,dependencies:by,overrides:wy,repository:jy,bugs:Ny,homepage:_y,collective:Sy};var Cy={workerBlobURL:!0,logger:()=>{}};const Py=ky.version,Ay=Cy;var Ey={...Ay,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Py}/dist/worker.min.js`},Ry=({workerPath:a,workerBlobURL:t})=>{let s;if(Blob&&URL&&t){const r=new Blob([`importScripts("${a}");`],{type:"application/javascript"});s=new Worker(URL.createObjectURL(r))}else s=new Worker(a);return s},Ty=a=>{a.terminate()},Dy=(a,t)=>{a.onmessage=({data:s})=>{t(s)}},Iy=async(a,t)=>{a.postMessage(t)};const mo=a=>new Promise((t,s)=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=({target:{error:{code:n}}})=>{s(Error(`File could not be read! Code=${n}`))},r.readAsArrayBuffer(a)}),Uo=async a=>{let t=a;if(typeof a>"u")return"undefined";if(typeof a=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(a)?t=atob(a.split(",")[1]).split("").map(s=>s.charCodeAt(0)):t=await(await fetch(a)).arrayBuffer();else if(typeof HTMLElement<"u"&&a instanceof HTMLElement)a.tagName==="IMG"&&(t=await Uo(a.src)),a.tagName==="VIDEO"&&(t=await Uo(a.poster)),a.tagName==="CANVAS"&&await new Promise(s=>{a.toBlob(async r=>{t=await mo(r),s()})});else if(typeof OffscreenCanvas<"u"&&a instanceof OffscreenCanvas){const s=await a.convertToBlob();t=await mo(s)}else(a instanceof File||a instanceof Blob)&&(t=await mo(a));return new Uint8Array(t)};var Oy=Uo;const Ly=Ey,My=Ry,Fy=Ty,$y=Dy,Vy=Iy,Uy=Oy;var zy={defaultOptions:Ly,spawnWorker:My,terminateWorker:Fy,onMessage:$y,send:Vy,loadImage:Uy};const By=ny,js=Nh,{log:Il}=mr,Hy=Di,ba=_h,{defaultOptions:qy,spawnWorker:Wy,terminateWorker:Yy,onMessage:Gy,loadImage:Ol,send:Zy}=zy;let Ll=0;var Sh=async(a="eng",t=ba.LSTM_ONLY,s={},r={})=>{const n=Hy("Worker",Ll),{logger:o,errorHandler:i,...c}=By({...qy,...s}),d={},u=typeof a=="string"?a.split("+"):a;let h=t,m=r;const p=[ba.DEFAULT,ba.LSTM_ONLY].includes(t)&&!c.legacyCore;let f,v;const y=new Promise((_,L)=>{v=_,f=L}),w=_=>{f(_.message)};let N=Wy(c);N.onerror=w,Ll+=1;const g=({id:_,action:L,payload:C})=>new Promise((T,H)=>{Il(`[${n}]: Start ${_}, action=${L}`);const x=`${L}-${_}`;d[x]={resolve:T,reject:H},Zy(N,{workerId:n,jobId:_,action:L,payload:C})}),b=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),A=_=>g(js({id:_,action:"load",payload:{options:{lstmOnly:p,corePath:c.corePath,logging:c.logging}}})),P=(_,L,C)=>g(js({id:C,action:"FS",payload:{method:"writeFile",args:[_,L]}})),E=(_,L)=>g(js({id:L,action:"FS",payload:{method:"readFile",args:[_,{encoding:"utf8"}]}})),V=(_,L)=>g(js({id:L,action:"FS",payload:{method:"unlink",args:[_]}})),M=(_,L,C)=>g(js({id:C,action:"FS",payload:{method:_,args:L}})),O=(_,L)=>g(js({id:L,action:"loadLanguage",payload:{langs:_,options:{langPath:c.langPath,dataPath:c.dataPath,cachePath:c.cachePath,cacheMethod:c.cacheMethod,gzip:c.gzip,lstmOnly:[ba.DEFAULT,ba.LSTM_ONLY].includes(h)&&!c.legacyLang}}})),I=(_,L,C,T)=>g(js({id:T,action:"initialize",payload:{langs:_,oem:L,config:C}})),ee=(_="eng",L,C,T)=>{if(p&&[ba.TESSERACT_ONLY,ba.TESSERACT_LSTM_COMBINED].includes(L))throw Error("Legacy model requested but code missing.");const H=L||h;h=H;const x=C||m;m=x;const q=(typeof _=="string"?_.split("+"):_).filter(U=>!u.includes(U));return u.push(...q),q.length>0?O(q,T).then(()=>I(_,H,x,T)):I(_,H,x,T)},G=(_={},L)=>g(js({id:L,action:"setParameters",payload:{params:_}})),ae=async(_,L={},C={text:!0},T)=>g(js({id:T,action:"recognize",payload:{image:await Ol(_),options:L,output:C}})),$=async(_,L)=>{if(p)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return g(js({id:L,action:"detect",payload:{image:await Ol(_)}}))},Y=async()=>(N!==null&&(Yy(N),N=null),Promise.resolve());Gy(N,({workerId:_,jobId:L,status:C,action:T,data:H})=>{const x=`${T}-${L}`;if(C==="resolve")Il(`[${_}]: Complete ${L}`),d[x].resolve({jobId:L,data:H}),delete d[x];else if(C==="reject")if(d[x].reject(H),delete d[x],T==="load"&&f(H),i)i(H);else throw Error(H);else C==="progress"&&o({...H,userJobId:L})});const Z={id:n,worker:N,load:b,writeText:P,readText:E,removeFile:V,FS:M,reinitialize:ee,setParameters:G,recognize:ae,detect:$,terminate:Y};return A().then(()=>O(a)).then(()=>I(a,t,r)).then(()=>v(Z)).catch(()=>{}),y};const kh=Sh,Ky=async(a,t,s)=>{const r=await kh(t,1,s);return r.recognize(a).finally(async()=>{await r.terminate()})},Qy=async(a,t)=>{const s=await kh("osd",0,t);return s.detect(a).finally(async()=>{await s.terminate()})};var Jy={recognize:Ky,detect:Qy},Xy={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},e0={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const t0=ey,s0=Sh,a0=Jy,r0=Xy,n0=_h,o0=e0,{setLogging:i0}=mr;var l0={languages:r0,OEM:n0,PSM:o0,createScheduler:t0,createWorker:s0,setLogging:i0,...a0};const c0=xm(l0);class d0{static async extractTextFromImage(t){try{const{data:{text:s}}=await c0.recognize(t,"eng",{logger:r=>console.log(r)});return s.trim()}catch(s){throw console.error("OCR Error:",s),new Error("Failed to extract text from image")}}static extractPlateNumber(t){const s=t.replace(/\s+/g," ").trim(),r=[/[A-Z]{2}\d{2}[A-Z]{1,2}\d{3,4}/g,/[A-Z]{3}[-]?\d{4}/g,/[A-Z0-9]{6,8}/g,/[A-Z]+[0-9]+[A-Z0-9]*/g];for(const o of r){const i=s.match(o);if(i&&i.length>0)return i[0].replace(/[- ]/g,"").toUpperCase()}const n=s.match(/[A-Z0-9]{4,}/);return n?n[0].toUpperCase():s}static async processPlateImage(t){try{const s=await this.extractTextFromImage(t),r=this.extractPlateNumber(s);return console.log("Extracted text:",s),console.log("Plate number:",r),r}catch(s){throw console.error("Plate processing error:",s),s}}}function u0(){const{profile:a}=ft(),{toast:t}=Tt(),[s,r]=l.useState([]),[n,o]=l.useState({}),[i,c]=l.useState(!1),[d,u]=l.useState([]),[h,m]=l.useState(!1),[p,f]=l.useState({plate_number:"",vehicle_type:"4-wheeler",location_id:"",contractor_id:"",mobile_number:""}),[v,y]=l.useState(!0),[w,N]=l.useState(!1),[g,b]=l.useState(!1),[A,P]=l.useState(!1),[E,V]=l.useState(!1),[M,O]=l.useState(!1),[I,ee]=l.useState(null),[G,ae]=l.useState(null),[$,Y]=l.useState(!1),[Z,_]=l.useState(null),[L,C]=l.useState(1),[T,H]=l.useState(10),[x,S]=l.useState(""),q=a?.role==="super_admin",U=a?.role==="attendant",de=a?.role==="contractor",Q=(ne,fe)=>{if(!fe)return"-";const xe=new Date(ne),qe=new Date(fe).getTime()-xe.getTime(),Ue=Math.floor(qe/(1e3*60*60)),xt=Math.floor(qe%(1e3*60*60)/(1e3*60));return`${Ue}h ${xt}m`},z=ne=>{if(ne.check_out_time&&ne.payment_amount!=null){let fe;if(typeof ne.payment_amount=="number")fe=ne.payment_amount;else{const xe=parseFloat(String(ne.payment_amount));fe=isNaN(xe)?0:xe}if(typeof fe=="number"&&!isNaN(fe)&&isFinite(fe))return`${fe.toFixed(2)}`}return"-"},D=ne=>Ce(ne)==="checked_in"?e.jsx("span",{className:"text-sm",children:"Parked"}):e.jsx(Je,{variant:"secondary",className:"bg-gray-100 text-gray-800",children:"Checked Out"}),X=ne=>ne==="2-wheeler"?"2 Wheeler":"4 Wheeler",B=({vehicleList:ne})=>{const fe=j(ne);Ge(ne);const xe=()=>{const Re=[];if(fe<=5)for(let Ue=1;Ue<=fe;Ue++)Re.push(Ue);else if(L<=3){for(let Ue=1;Ue<=4;Ue++)Re.push(Ue);Re.push("..."),Re.push(fe)}else if(L>=fe-2){Re.push(1),Re.push("...");for(let Ue=fe-3;Ue<=fe;Ue++)Re.push(Ue)}else{Re.push(1),Re.push("...");for(let Ue=L-1;Ue<=L+1;Ue++)Re.push(Ue);Re.push("..."),Re.push(fe)}return Re};return e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 mt-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 text-center sm:text-left",children:["Showing ",(L-1)*T+1," to ",Math.min(L*T,ne.length)," of ",ne.length," vehicles"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs sm:text-sm text-gray-500",children:"Show:"}),e.jsxs(Lt,{value:T.toString(),onValueChange:Re=>W(parseInt(Re)),children:[e.jsx(Ct,{className:"w-16 sm:w-20 h-8",children:e.jsx(Mt,{})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"10",children:"10"}),e.jsx($e,{value:"25",children:"25"}),e.jsx($e,{value:"50",children:"50"}),e.jsx($e,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"text-xs sm:text-sm text-gray-500",children:"per page"})]})]}),fe>1&&e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>R(L-1),disabled:L===1,className:"text-xs sm:text-sm",children:[e.jsx(ti,{className:"h-3 w-3 sm:h-4 sm:w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Previous"})]}),e.jsx("div",{className:"flex space-x-1",children:xe().map((Re,qe)=>e.jsx(F,{variant:Re===L?"default":"outline",size:"sm",onClick:()=>typeof Re=="number"?R(Re):void 0,disabled:Re==="...",className:"w-6 h-6 sm:w-8 sm:h-8 p-0 text-xs",children:Re},qe))}),e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>R(L+1),disabled:L===fe,className:"text-xs sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:"Next"}),e.jsx(On,{className:"h-3 w-3 sm:h-4 sm:w-4"})]})]})]})},oe=ne=>{const fe=Ge(ne);return e.jsxs("div",{children:[e.jsxs("div",{className:"hidden lg:block overflow-hidden rounded-lg border",children:[e.jsx("div",{className:"bg-gray-50 px-4 sm:px-6 py-3 border-b",children:e.jsxs("div",{className:`grid gap-2 sm:gap-4 text-xs sm:text-sm font-medium text-gray-700 ${U?"grid-cols-8":"grid-cols-9"}`,style:{gridTemplateColumns:U?"1fr 1fr 0.8fr 1.2fr 1.2fr 0.8fr 0.8fr 1fr":"1fr 1fr 0.8fr 1.2fr 1.2fr 0.8fr 0.8fr 1fr 1fr"},children:[e.jsx("div",{children:"Plate Number"}),e.jsx("div",{children:"Mobile Number"}),e.jsx("div",{children:"Type"}),e.jsx("div",{children:"Check-in"}),e.jsx("div",{children:"Check-out"}),e.jsx("div",{children:"Duration"}),e.jsx("div",{children:"Payment"}),!U&&e.jsx("div",{children:"Contractor Name"}),!U&&e.jsx("div",{children:"Location"}),U&&e.jsx("div",{children:"Actions"})]})}),e.jsx("div",{className:"divide-y",children:fe.map(xe=>e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:`grid gap-2 sm:gap-4 items-center text-xs sm:text-sm ${U?"grid-cols-8":"grid-cols-9"}`,style:{gridTemplateColumns:U?"1fr 1fr 0.8fr 1.2fr 1.2fr 0.8fr 0.8fr 1fr":"1fr 1fr 0.8fr 1.2fr 1.2fr 0.8fr 0.8fr 1fr 1fr"},children:[e.jsx("div",{className:"font-medium text-gray-900",children:xe.plate_number}),e.jsx("div",{className:"text-gray-600 truncate",children:xe.mobile_number||"-"}),e.jsx("div",{className:"text-gray-600",children:X(xe.vehicle_type)}),e.jsx("div",{className:"text-gray-600 text-xs sm:text-sm whitespace-nowrap",children:ts(xe.check_in_time)}),e.jsx("div",{className:"text-gray-600 text-xs sm:text-sm whitespace-nowrap",children:xe.check_out_time?ts(xe.check_out_time):"-"}),e.jsx("div",{className:"text-gray-600",children:Q(xe.check_in_time,xe.check_out_time)}),e.jsx("div",{className:"text-gray-600",children:z(xe)}),!U&&e.jsx("div",{className:"text-gray-600 truncate",children:xe.parking_locations?.contractors?.company_name||"Unknown Contractor"}),!U&&e.jsx("div",{className:"text-gray-600 truncate",children:xe.parking_locations?.locations_name||"Unknown Location"}),U&&e.jsx("div",{className:"flex items-center space-x-1 sm:space-x-2",children:xe.check_out_time?e.jsx(Je,{variant:"secondary",className:"bg-blue-100 text-blue-800 border-blue-200 text-xs",children:"Completed"}):e.jsx(F,{size:"sm",onClick:()=>ve(xe),className:"bg-green-600 hover:bg-green-700 text-white text-xs sm:text-sm px-2 sm:px-3",children:"Check Out"})})]})},xe.id))})]}),e.jsx("div",{className:"lg:hidden space-y-4",children:fe.map(xe=>e.jsx(_e,{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ot,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:xe.plate_number}),e.jsx("p",{className:"text-xs text-muted-foreground",children:X(xe.vehicle_type)})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[D(xe),U&&e.jsx("div",{children:xe.check_out_time?e.jsx(Je,{variant:"secondary",className:"bg-blue-100 text-blue-800 border-blue-200 text-xs",children:"Completed"}):e.jsx(F,{size:"sm",onClick:()=>ve(xe),className:"bg-green-600 hover:bg-green-700 text-white text-xs",children:"Check Out"})})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Mobile:"}),e.jsx("span",{children:xe.mobile_number||"-"})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Check-in:"}),e.jsx("span",{className:"text-xs break-all",children:ts(xe.check_in_time)})]}),xe.check_out_time&&e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:"text-muted-foreground text-xs",children:"Check-out:"}),e.jsx("span",{className:"text-xs break-all",children:ts(xe.check_out_time)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsx("span",{children:Q(xe.check_in_time,xe.check_out_time)})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment:"}),e.jsx("span",{children:z(xe)})]}),!U&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Contractor:"}),e.jsx("span",{className:"truncate",children:xe.parking_locations?.contractors?.company_name||"Unknown"})]}),!U&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Location:"}),e.jsx("span",{className:"truncate",children:xe.parking_locations?.locations_name||"Unknown"})]})]})]})},xe.id))}),e.jsx(B,{vehicleList:ne})]})};l.useEffect(()=>{me()},[s]),l.useEffect(()=>{me()},[x]),l.useEffect(()=>{a?.role==="attendant"&&a?.id&&Bn(a.id).then(ne=>{console.log("Subscription status for attendant (Vehicles):",ne),(ne.isExpired||ne.isSuspended)&&(c(!0),t({variant:"destructive",title:"Access Blocked",description:"Your contractor's subscription has expired. Please contact your contractor to recharge."}))}).catch(ne=>{console.error("Error checking subscription status (Vehicles):",ne)})},[a,t]),l.useEffect(()=>{(async()=>{try{if(q){const fe=await Gt.getAllVehicles();r(fe);const xe=await kt.getAllContractors(),Re={};xe.forEach(qe=>{Re[qe.id]=qe.company_name||""}),o(Re)}else if(U){const fe=await Gt.getAttendantVehicles();if(r(fe),a?.id)try{const xe=await oa.getAttendantByUserId(a.id);if(xe&&xe.location_id){const Re=await es.getLocationById(xe.location_id);if(Re){u([Re]),f(Ue=>({...Ue,location_id:xe.location_id||"",contractor_id:Re.contractor_id}));const qe=await kt.getContractorById(Re.contractor_id);qe&&ae({rates_2wheeler:qe.rates_2wheeler,rates_4wheeler:qe.rates_4wheeler})}}}catch(xe){console.error("Error loading attendant location:",xe)}}else if(de)if(a?.id)try{const fe=await kt.getContractorByUserId(a.id);if(fe&&fe.id){const xe=await Gt.getContractorVehicles(fe.id);r(xe);const qe=(await kt.getContractorLocations(fe.id)).filter(Ue=>Ue.is_deleted===!1&&Ue.status==="active");u(qe)}else r([]),u([])}catch(fe){console.error("Error loading contractor data:",fe),r([]),u([])}else r([]),u([]);else r([]),u([])}catch(fe){console.error("Error loading vehicles:",fe),r([]),u([])}finally{y(!1)}})()},[q,U,de,a?.id]),l.useMemo(()=>{if(!q)return{};const ne={};return s.forEach(fe=>{const xe=fe.location?.contractor_id||"unknown",Re=fe.location?.name||"Unknown Location";ne[xe]=ne[xe]||{},ne[xe][Re]=ne[xe][Re]||[],ne[xe][Re].push(fe)}),ne},[s,q]);const Ae=l.useMemo(()=>{const ne=s.length,fe=s.filter(Ue=>Ue.check_out_time===null).length,xe=s.filter(Ue=>Ue.check_out_time!==null),Re=s.reduce((Ue,xt)=>Ue+(xt.payment_amount||0),0);let qe=0;return xe.length>0&&(qe=xe.reduce((xt,Qt)=>{if(Qt.check_in_time&&Qt.check_out_time){const ys=new Date(Qt.check_out_time).getTime()-new Date(Qt.check_in_time).getTime();return xt+ys}return xt},0)/xe.length/(1e3*60*60)),{totalVehicles:ne,currentlyParked:fe,averageDuration:Math.round(qe*10)/10,totalRevenue:Math.round(Re*100)/100}},[s]),Ce=ne=>ne.check_out_time===null?"checked_in":"checked_out",Ie=ne=>{if(!x.trim())return ne;const fe=x.toLowerCase();return ne.filter(xe=>xe.plate_number.toLowerCase().includes(fe)||xe.parking_locations?.locations_name?.toLowerCase().includes(fe)||xe.mobile_number?.toLowerCase().includes(fe)||xe.vehicle_type.toLowerCase().includes(fe)||Ce(xe).toLowerCase().includes(fe))},K=Ie(s.sort((ne,fe)=>new Date(fe.check_in_time).getTime()-new Date(ne.check_in_time).getTime())),Ne=Ie(s.filter(ne=>ne.check_out_time===null)),Ve=Ie(s.filter(ne=>ne.check_out_time!==null)),Ge=ne=>{const fe=(L-1)*T,xe=fe+T;return ne.slice(fe,xe)},j=ne=>Math.ceil(ne.length/T),R=ne=>{C(ne)},W=ne=>{H(ne),C(1)},me=()=>{C(1)},se=async()=>{if(!p.plate_number||!p.vehicle_type){alert("Please fill in all required fields");return}O(!0)},re=async()=>{try{y(!0);const ne=await Gt.createVehicle(p);r(fe=>[ne,...fe]),f({plate_number:"",vehicle_type:"4-wheeler",location_id:d[0]?.id||"",contractor_id:d[0]?.contractor_id||"",mobile_number:""}),m(!1),O(!1)}catch(ne){console.error("Error adding vehicle:",ne),alert("Error adding vehicle: "+ne.message)}finally{y(!1)}},ve=ne=>{ee(ne),P(!0)},Te=()=>{P(!1),V(!0)},Ze=async ne=>{if(I)try{y(!0);const fe={check_out_time:new Date().toISOString(),payment_amount:ne.payment_amount,payment_method:ne.payment_method},xe=await Gt.checkoutVehicle(I.id,fe);r(Ua=>Ua.map(za=>za.id===I.id?xe:za));const Re=new Date(I.check_in_time),Ue=new Date().getTime()-Re.getTime(),xt=Math.floor(Ue/(1e3*60*60)),Qt=Math.floor(Ue%(1e3*60*60)/(1e3*60)),ys=Math.floor(Ue%(1e3*60)/1e3),Va=`${xt}h ${Qt}m ${ys}s`;_({paymentAmount:ne.payment_amount,paymentMethod:ne.payment_method,duration:Va}),V(!1),Y(!0)}catch(fe){console.error("Error checking out vehicle:",fe),alert("Error checking out vehicle: "+fe.message)}finally{y(!1)}},ct=async ne=>{try{b(!0);const fe=await d0.processPlateImage(ne);f(xe=>({...xe,plate_number:fe})),N(!1)}catch(fe){console.error("Error processing image:",fe),alert("Error processing image. Please try again.")}finally{b(!1)}};return a?(console.log("Vehicles component - Profile loaded:",{role:a.role,id:a.id,status:a.status,loading:v,vehiclesCount:s.length,isSuperAdmin:q,isAttendant:U,isContractor:de}),console.log("Vehicles component is rendering with vehicles:",s),console.log("allVehicles after filtering:",K),console.log("currentlyParkedVehicles:",Ne),console.log("checkedOutVehicles:",Ve),i?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"mx-auto max-w-md",children:[e.jsx("div",{className:"rounded-full bg-red-100 p-3 mx-auto w-16 h-16 flex items-center justify-center mb-4",children:e.jsx(Na,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Access Blocked"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your contractor's subscription has expired. Please contact your contractor to recharge."}),e.jsx(F,{variant:"outline",onClick:()=>window.location.reload(),className:"mt-4",children:"Refresh Page"})]})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Vehicle Logs"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"View all vehicle activity from your locations with assigned attendants."})]}),U&&e.jsxs(F,{onClick:()=>m(!0),className:"w-full sm:w-auto",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Vehicle"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:[e.jsx(Pe,{title:"Total Vehicles",value:Ae.totalVehicles,description:"All time",icon:ot,variant:"info"}),e.jsx(Pe,{title:"Currently Parked",value:Ae.currentlyParked,description:"Active sessions",icon:rs,variant:"warning"}),e.jsx(Pe,{title:"Average Duration",value:`${Ae.averageDuration}h`,description:"Per session",icon:qs,variant:"default"}),e.jsx(Pe,{title:"Total Revenue",value:`${Ae.totalRevenue}`,description:"From vehicles",icon:vs,variant:"success"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ua,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(ge,{placeholder:"Search vehicles by plate number, location, mobile number...",value:x,onChange:ne=>S(ne.target.value),className:"pl-10"})]}),x&&e.jsx(F,{variant:"outline",onClick:()=>S(""),className:"text-gray-500 w-full sm:w-auto",children:"Clear"})]}),e.jsxs(Pu,{defaultValue:"all",className:"w-full",children:[e.jsxs(Si,{className:"grid w-full grid-cols-1 sm:grid-cols-3",children:[e.jsx(Ta,{value:"all",className:"text-xs sm:text-sm",children:"All Vehicles"}),e.jsx(Ta,{value:"parked",className:"text-xs sm:text-sm",children:"Currently Parked"}),e.jsx(Ta,{value:"checked-out",className:"text-xs sm:text-sm",children:"Checked Out"})]}),e.jsx(Da,{value:"all",className:"mt-6",children:v?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading vehicles..."})}):K.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No vehicles found"}),e.jsx("p",{className:"text-muted-foreground",children:de?"Vehicle logs will appear here when attendants check in vehicles at your assigned locations.":"Vehicle logs will appear here when vehicles check in."})]}):oe(K)}),e.jsx(Da,{value:"parked",className:"mt-6",children:v?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading vehicles..."})}):Ne.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No parked vehicles"}),e.jsx("p",{className:"text-muted-foreground",children:"Currently parked vehicles will appear here."})]}):oe(Ne)}),e.jsx(Da,{value:"checked-out",className:"mt-6",children:v?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading vehicles..."})}):Ve.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No checked out vehicles"}),e.jsx("p",{className:"text-muted-foreground",children:"Checked out vehicles will appear here."})]}):oe(Ve)})]}),U&&e.jsx(bt,{open:h,onOpenChange:m,children:e.jsxs(yt,{className:"max-w-md w-[95vw] sm:w-full",children:[e.jsxs(wt,{children:[e.jsx(jt,{className:"text-xl sm:text-2xl font-bold",children:"Vehicle Check-in"}),e.jsx(At,{className:"text-sm",children:"Enter vehicle details to check-in."})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx(te,{className:"text-sm sm:text-base font-semibold mb-2 sm:mb-3 block",children:"Vehicle Type"}),e.jsxs(jh,{value:p.vehicle_type,onValueChange:ne=>f(fe=>({...fe,vehicle_type:ne})),className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Vo,{value:"2-wheeler",id:"2-wheeler"}),e.jsxs(te,{htmlFor:"2-wheeler",className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(Br,{className:"h-5 w-5"}),e.jsx("span",{children:"2-Wheeler"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Vo,{value:"4-wheeler",id:"4-wheeler"}),e.jsxs(te,{htmlFor:"4-wheeler",className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(ot,{className:"h-5 w-5"}),e.jsx("span",{children:"4-Wheeler"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm sm:text-base font-semibold mb-2 sm:mb-3 block",children:"Plate Number"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsx(ge,{value:p.plate_number,onChange:ne=>{const fe=ne.target,xe=fe.selectionStart,Re=ne.target.value.toUpperCase();f(qe=>({...qe,plate_number:Re})),setTimeout(()=>{fe.setSelectionRange(xe,xe)},0)},placeholder:"e.g., ABC-1234",className:"flex-1"}),e.jsx(F,{type:"button",variant:"outline",size:"icon",onClick:()=>N(!0),disabled:g,className:"w-full sm:w-auto",children:e.jsx(ra,{className:"h-4 w-4"})})]}),g&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:"Processing image..."})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm sm:text-base font-semibold mb-2 sm:mb-3 block",children:"Mobile Number (Optional)"}),e.jsx(ge,{value:p.mobile_number||"",onChange:ne=>{const fe=ne.target,xe=fe.selectionStart,Re=ne.target.value.toUpperCase();f(qe=>({...qe,mobile_number:Re})),setTimeout(()=>{fe.setSelectionRange(xe,xe)},0)},placeholder:"e.g., +91 9876543210",type:"tel"})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm sm:text-base font-semibold mb-2 sm:mb-3 block",children:"Location"}),e.jsx(ge,{value:d[0]?.locations_name||"Loading...",disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This is your assigned location"})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm sm:text-base font-semibold mb-2 sm:mb-3 block",children:"Live Occupancy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(Ae.currentlyParked/Math.max(Ae.totalVehicles,1)*100,100)}%`}})}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground text-center",children:[Ae.currentlyParked,"/",Math.max(Ae.totalVehicles,100)," spots occupied"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-3 pt-3 sm:pt-4",children:[e.jsx(F,{variant:"outline",onClick:()=>m(!1),className:"w-full sm:w-auto",children:"Cancel"}),e.jsx(F,{onClick:se,disabled:v||!p.plate_number,className:"bg-purple-600 hover:bg-purple-700 w-full sm:w-auto",children:v?"Adding...":"Check-in"})]})]})]})}),w&&e.jsx(Hv,{onCapture:ct,onClose:()=>N(!1)}),e.jsx(Gv,{isOpen:A,onClose:()=>{P(!1),ee(null)},onConfirm:Te,vehicle:I}),e.jsx(Wv,{isOpen:E,onClose:()=>{V(!1),ee(null)},onConfirm:Ze,vehicle:I,contractorRates:G,loading:v}),e.jsx(Yv,{isOpen:$,onClose:()=>{Y(!1),_(null),ee(null)},vehicle:I,paymentAmount:Z?.paymentAmount||0,paymentMethod:Z?.paymentMethod||"",duration:Z?.duration||""}),e.jsx(Zv,{isOpen:M,onClose:()=>{O(!1)},onConfirm:re,vehicle:{id:"",plate_number:p.plate_number,vehicle_type:p.vehicle_type,mobile_number:p.mobile_number,location:d.find(ne=>ne.id===p.location_id)},loading:v})]})):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Loading Profile..."}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while we load your profile."}),e.jsx("div",{className:"mt-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"})})]})}function h0(){const[a,t]=l.useState([]),[s,r]=l.useState(!1),[n,o]=l.useState(""),[i,c]=l.useState(!1),[d,u]=l.useState(null),[h,m]=l.useState(1),[p]=l.useState(5),[f,v]=l.useState(!1),[y,w]=l.useState(null);l.useEffect(()=>{N()},[]);const N=()=>{const x=localStorage.getItem("parkflow_reports");x&&t(JSON.parse(x))},g=x=>{const S=[...a,x];t(S),localStorage.setItem("parkflow_reports",JSON.stringify(S))},b=x=>{w(x)},A=()=>{if(y){const x=a.filter(q=>q.id!==y);t(x),localStorage.setItem("parkflow_reports",JSON.stringify(x));const S=Math.ceil(x.length/p);h>S&&S>0?m(S):S===0&&m(1),w(null)}},P=()=>{v(!0)},E=()=>{t([]),localStorage.removeItem("parkflow_reports"),m(1),v(!1)},V=Math.ceil(a.length/p),M=(h-1)*p,O=M+p,I=a.slice(M,O),ee=x=>{m(x)},G=()=>{h>1&&m(h-1)},ae=()=>{h<V&&m(h+1)},$=async()=>{console.log("Generating revenue report..."),r(!0);try{const x=Y([]);console.log("Revenue data generated:",x);const S={id:`revenue_${Date.now()}`,type:"revenue",title:"Revenue Report",generatedAt:new Date().toISOString(),period:"All Time",data:x};console.log("Saving report:",S),g(S),u(x),o("revenue"),c(!0),console.log("Report dialog should open now")}catch(x){console.error("Error generating revenue report:",x)}finally{r(!1)}},Y=x=>{const S=new Date;if(x.length===0)return{totalRevenue:12500,dailyRevenue:Array.from({length:30},(B,oe)=>({date:new Date(S.getTime()-(29-oe)*24*60*60*1e3).toISOString().split("T")[0],amount:Math.floor(Math.random()*1e3)+200})),monthlyRevenue:Array.from({length:12},(B,oe)=>({month:zt(new Date(S.getFullYear(),S.getMonth()-(11-oe),1),{format:"medium"}),amount:Math.floor(Math.random()*5e3)+2e3})),contractorBreakdown:[{name:"City Parking Ltd",revenue:4500},{name:"Metro Parking",revenue:3200},{name:"Quick Park",revenue:2800},{name:"Urban Spaces",revenue:2e3}],paymentMethodBreakdown:[{method:"cash",count:45,amount:6500},{method:"card",count:32,amount:4200},{method:"digital",count:18,amount:1800}]};const q=x.reduce((B,oe)=>B+(oe.amount||0),0),U=[];for(let B=29;B>=0;B--){const Ae=new Date(S.getTime()-B*24*60*60*1e3).toISOString().split("T")[0],Ce=x.filter(Ie=>Ie.created_at?.startsWith(Ae)).reduce((Ie,K)=>Ie+(K.amount||0),0);U.push({date:Ae,amount:Ce})}const de=[];for(let B=11;B>=0;B--){const oe=new Date(S.getFullYear(),S.getMonth()-B,1),Ae=zt(oe,{format:"medium"}),Ce=x.filter(Ie=>{const K=new Date(Ie.created_at);return K.getMonth()===oe.getMonth()&&K.getFullYear()===oe.getFullYear()}).reduce((Ie,K)=>Ie+(K.amount||0),0);de.push({month:Ae,amount:Ce})}const Q=new Map;x.forEach(B=>{const oe=B.contractors?.company_name||"Unknown";Q.set(oe,(Q.get(oe)||0)+(B.amount||0))});const z=Array.from(Q.entries()).map(([B,oe])=>({name:B,revenue:oe})).sort((B,oe)=>oe.revenue-B.revenue),D=new Map;x.forEach(B=>{const oe=B.payment_method||"cash";D.has(oe)||D.set(oe,{count:0,amount:0});const Ae=D.get(oe);Ae.count++,Ae.amount+=B.amount||0});const X=Array.from(D.entries()).map(([B,oe])=>({method:B,...oe}));return{totalRevenue:q,dailyRevenue:U,monthlyRevenue:de,contractorBreakdown:z,paymentMethodBreakdown:X}},Z=async()=>{console.log("Generating occupancy report..."),r(!0);try{const x=_([],[]);console.log("Occupancy data generated:",x);const S={id:`occupancy_${Date.now()}`,type:"occupancy",title:"Occupancy Report",generatedAt:new Date().toISOString(),period:"Current",data:x};g(S),u(x),o("occupancy"),c(!0),console.log("Occupancy report dialog should open now")}catch(x){console.error("Error generating occupancy report:",x)}finally{r(!1)}},_=(x,S)=>{if(x.length===0)return{totalLocations:4,averageOccupancy:68,locationBreakdown:[{name:"Mall Parking",occupancy:85,capacity:200},{name:"Office Complex",occupancy:72,capacity:150},{name:"Shopping Center",occupancy:45,capacity:100},{name:"Airport Terminal",occupancy:70,capacity:300}],hourlyTrends:Array.from({length:24},(z,D)=>({hour:D,occupancy:Math.floor(Math.random()*100)}))};const q=x.map(z=>{const X=S.filter(oe=>oe.location_id===z.id).filter(oe=>oe.check_in_time&&!oe.check_out_time).length,B=z.total_slots>0?X/z.total_slots*100:0;return{name:z.locations_name,occupancy:Math.round(B),capacity:z.total_slots}}),U=x.length,de=q.reduce((z,D)=>z+D.occupancy,0)/U,Q=Array.from({length:24},(z,D)=>({hour:D,occupancy:Math.floor(Math.random()*100)}));return{totalLocations:U,averageOccupancy:Math.round(de),locationBreakdown:q,hourlyTrends:Q}},L=async()=>{console.log("Generating activity report..."),r(!0);try{const x=C([],[],[]);console.log("Activity data generated:",x);const S={id:`activity_${Date.now()}`,type:"activity",title:"User Activity Report",generatedAt:new Date().toISOString(),period:"All Time",data:x};g(S),u(x),o("activity"),c(!0),console.log("Activity report dialog should open now")}catch(x){console.error("Error generating activity report:",x)}finally{r(!1)}},C=(x,S,q)=>{const U=new Date,de=new Date(U.getTime()-7*24*60*60*1e3);if(x.length===0)return{totalUsers:5,activeUsers:3,userBreakdown:[{role:"Super Admin",count:1,active:1},{role:"Contractor",count:2,active:1},{role:"Attendant",count:2,active:1}],recentActivity:[{user:"Super Admin",action:"System login",timestamp:new Date(U.getTime()-2*60*60*1e3).toISOString()},{user:"Contractor 1",action:"Dashboard access",timestamp:new Date(U.getTime()-4*60*60*1e3).toISOString()},{user:"Attendant 1",action:"Vehicle check-in",timestamp:new Date(U.getTime()-6*60*60*1e3).toISOString()}]};const Q=[{role:"Super Admin",count:x.filter(B=>B.role==="super_admin").length,active:x.filter(B=>B.role==="super_admin"&&B.last_login&&new Date(B.last_login)>de).length},{role:"Contractor",count:x.filter(B=>B.role==="contractor").length,active:x.filter(B=>B.role==="contractor"&&B.last_login&&new Date(B.last_login)>de).length},{role:"Attendant",count:x.filter(B=>B.role==="attendant").length,active:x.filter(B=>B.role==="attendant"&&B.last_login&&new Date(B.last_login)>de).length}],z=x.length,D=x.filter(B=>B.last_login&&new Date(B.last_login)>de).length,X=x.filter(B=>B.last_login).map(B=>({user:B.user_name,action:"Last login",timestamp:B.last_login})).sort((B,oe)=>new Date(oe.timestamp).getTime()-new Date(B.timestamp).getTime()).slice(0,10);return{totalUsers:z,activeUsers:D,userBreakdown:Q,recentActivity:X}},T=x=>{const S=H(x),q=new Blob([S],{type:"text/csv"}),U=window.URL.createObjectURL(q),de=document.createElement("a");de.href=U,de.download=`${x.title.toLowerCase().replace(/\s+/g,"-")}-${new Date().toISOString().split("T")[0]}.csv`,de.click(),window.URL.revokeObjectURL(U)},H=x=>{const S=["Report Type","Generated At","Period"],q=[[x.title,formatDateTime(x.generatedAt),x.period]];return x.type==="revenue"?(S.push("Total Revenue","Daily Revenue","Monthly Revenue"),q[0].push(`${x.data.totalRevenue}`,x.data.dailyRevenue.length+" days",x.data.monthlyRevenue.length+" months")):x.type==="occupancy"?(S.push("Total Locations","Average Occupancy"),q[0].push(x.data.totalLocations.toString(),x.data.averageOccupancy+"%")):x.type==="activity"&&(S.push("Total Users","Active Users"),q[0].push(x.data.totalUsers.toString(),x.data.activeUsers.toString())),[S,...q].map(U=>U.join(",")).join(`
`)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Reports"}),e.jsx("p",{className:"text-muted-foreground",children:"Generate and view system analytics and reports"})]}),e.jsxs(Lt,{value:n,onValueChange:o,children:[e.jsx(Ct,{className:"w-48",children:e.jsx(Mt,{placeholder:"Select report type"})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"revenue",children:"Revenue Report"}),e.jsx($e,{value:"occupancy",children:"Occupancy Report"}),e.jsx($e,{value:"activity",children:"Activity Report"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(_e,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>{o("revenue"),$()},children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(ja,{className:"h-5 w-5 mr-2"}),"Revenue Report"]}),e.jsx(et,{children:"Daily, weekly, and monthly revenue analytics"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx(ta,{className:"h-12 w-12 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate revenue report"}),e.jsxs(F,{className:"mt-2",disabled:s,children:[e.jsx(ta,{className:"h-4 w-4 mr-2"}),s?"Generating...":"Generate Report"]})]})})]}),e.jsxs(_e,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>{o("occupancy"),Z()},children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(Ps,{className:"h-5 w-5 mr-2"}),"Occupancy Report"]}),e.jsx(et,{children:"Parking location utilization statistics"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx(Us,{className:"h-12 w-12 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View occupancy data"}),e.jsxs(F,{className:"mt-2",disabled:s,children:[e.jsx(Us,{className:"h-4 w-4 mr-2"}),s?"Generating...":"Generate Report"]})]})})]}),e.jsxs(_e,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>{o("activity"),L()},children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(ja,{className:"h-5 w-5 mr-2"}),"User Activity"]}),e.jsx(et,{children:"Staff and contractor activity logs"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx(ta,{className:"h-12 w-12 text-purple-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View activity logs"}),e.jsxs(F,{className:"mt-2",disabled:s,children:[e.jsx(ta,{className:"h-4 w-4 mr-2"}),s?"Generating...":"Generate Report"]})]})})]})]}),e.jsx(bt,{open:i,onOpenChange:c,children:e.jsxs(yt,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(wt,{children:[e.jsx(jt,{children:"Report Preview"}),e.jsx(At,{children:"Preview and export your generated report"})]}),d?e.jsxs("div",{className:"space-y-6",children:[n==="revenue"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:mt(d.totalRevenue)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Revenue"})]})}),e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.dailyRevenue.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Days Tracked"})]})}),e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d.contractorBreakdown.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contractors"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Top Contractors"}),e.jsx("div",{className:"space-y-2",children:d.contractorBreakdown.slice(0,5).map((x,S)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:x.name}),e.jsx("span",{className:"font-medium",children:mt(x.revenue)})]},S))})]})]}),n==="occupancy"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.totalLocations}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Locations"})]})}),e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[d.averageOccupancy,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average Occupancy"})]})}),e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d.locationBreakdown.reduce((x,S)=>x+S.capacity,0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Capacity"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Location Occupancy"}),e.jsx("div",{className:"space-y-2",children:d.locationBreakdown.map((x,S)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:x.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[x.occupancy,"% (",x.capacity," slots)"]}),e.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${x.occupancy}%`}})})]})]},S))})]})]}),n==="activity"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.totalUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Users"})]})}),e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.activeUsers}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Users"})]})}),e.jsx(_e,{children:e.jsxs(Ee,{className:"pt-6",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[d.totalUsers>0?Math.round(d.activeUsers/d.totalUsers*100):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Activity Rate"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"User Breakdown"}),e.jsx("div",{className:"space-y-2",children:d.userBreakdown.map((x,S)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{children:x.role}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[x.active,"/",x.count," active"]}),e.jsxs(Je,{variant:"outline",children:[x.count>0?Math.round(x.active/x.count*100):0,"%"]})]})]},S))})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ja,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Loading Report..."}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while the report is being generated."})]})]})}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Be,{children:"Recent Reports"}),e.jsxs(et,{children:["View and download previously generated reports (",a.length,")"]})]}),a.length>0&&e.jsxs(F,{variant:"destructive",size:"sm",onClick:P,children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"Delete All"]})]})}),e.jsx(Ee,{children:a.length>0?e.jsxs("div",{className:"space-y-4",children:[I.map(x=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 border rounded-lg hover:bg-gray-50 transition-colors space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ja,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium truncate",children:x.title}),e.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["Generated ",zt(x.generatedAt),"  ",x.period]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center space-y-2 sm:space-y-0 sm:space-x-2",children:[e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>{u(x.data),o(x.type),c(!0)},className:"flex items-center justify-center space-x-1 w-full sm:w-auto",children:[e.jsx(os,{className:"h-4 w-4"}),e.jsx("span",{children:"View"})]}),e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>T(x),className:"flex items-center justify-center space-x-1 w-full sm:w-auto",children:[e.jsx(si,{className:"h-4 w-4"}),e.jsx("span",{children:"Export"})]}),e.jsx(F,{variant:"destructive",size:"sm",onClick:()=>b(x.id),className:"flex items-center justify-center w-full sm:w-auto",children:e.jsx(As,{className:"h-4 w-4"})})]})]},x.id)),V>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",M+1," to ",Math.min(O,a.length)," of ",a.length," reports"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(F,{variant:"outline",size:"sm",onClick:G,disabled:h===1,children:[e.jsx(ti,{className:"h-4 w-4"}),"Previous"]}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:V},(x,S)=>S+1).map(x=>e.jsx(F,{variant:h===x?"default":"outline",size:"sm",onClick:()=>ee(x),className:"w-8 h-8 p-0",children:x},x))}),e.jsxs(F,{variant:"outline",size:"sm",onClick:ae,disabled:h===V,children:["Next",e.jsx(On,{className:"h-4 w-4"})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ja,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No reports generated"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Generate your first report to see it here"}),e.jsxs(F,{onClick:$,disabled:s,children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),"Generate Report"]})]})})]}),e.jsx(Cn,{open:f,onOpenChange:v,children:e.jsxs(Dr,{children:[e.jsxs(Ir,{children:[e.jsx(Lr,{children:"Delete All Reports"}),e.jsx(Mr,{children:"Are you sure you want to delete all reports? This action cannot be undone."})]}),e.jsxs(Or,{children:[e.jsx($r,{children:"Cancel"}),e.jsx(Fr,{onClick:E,className:"bg-red-600 hover:bg-red-700",children:"Delete All"})]})]})}),e.jsx(Cn,{open:y!==null,onOpenChange:()=>w(null),children:e.jsxs(Dr,{children:[e.jsxs(Ir,{children:[e.jsx(Lr,{children:"Delete Report"}),e.jsx(Mr,{children:"Are you sure you want to delete this report? This action cannot be undone."})]}),e.jsxs(Or,{children:[e.jsx($r,{children:"Cancel"}),e.jsx(Fr,{onClick:A,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}function m0(){const{profile:a}=ft(),[t,s]=l.useState(!0),[r,n]=l.useState(null),[o,i]=l.useState([]),[c,d]=l.useState([]);a?.role;const u=a?.role==="contractor";l.useEffect(()=>{h()},[]);const h=async()=>{try{s(!0),await m(),await p(),await f()}catch(v){console.error("Error fetching income data:",v)}finally{s(!1)}},m=async()=>{try{let v,y;const{PaymentAPI:w}=await Ye(async()=>{const{PaymentAPI:O}=await Promise.resolve().then(()=>tl);return{PaymentAPI:O}},void 0);if(u&&a?.id){const{ContractorAPI:O}=await Ye(async()=>{const{ContractorAPI:G}=await Promise.resolve().then(()=>Er);return{ContractorAPI:G}},void 0),I=await O.getContractorByUserId(a.id);if(!I){n({totalRevenue:0,todayRevenue:0,thisWeekRevenue:0,thisMonthRevenue:0,monthlyRevenue:0,averagePayment:0,paymentMethodBreakdown:{cash:0,card:0,digital:0,free:0}});return}const ee=await w.getPaymentStats(I.id);n({totalRevenue:ee.totalRevenue,todayRevenue:ee.todayRevenue,thisWeekRevenue:ee.thisWeekRevenue,thisMonthRevenue:ee.thisMonthRevenue,monthlyRevenue:ee.thisMonthRevenue,averagePayment:ee.averagePayment,paymentMethodBreakdown:ee.paymentMethodBreakdown});return}else{const O=await w.getPaymentStats();n({totalRevenue:O.totalRevenue,todayRevenue:O.todayRevenue,thisWeekRevenue:O.thisWeekRevenue,thisMonthRevenue:O.thisMonthRevenue,monthlyRevenue:O.thisMonthRevenue,averagePayment:O.averagePayment,paymentMethodBreakdown:O.paymentMethodBreakdown});return}console.log("Overall stats data:",v);const N=new Date,g=new Date(N.getFullYear(),N.getMonth(),N.getDate()),b=new Date(N.getTime()-7*24*60*60*1e3),A=new Date(N.getFullYear(),N.getMonth(),1);let P=0,E=0,V=0,M=0;v?.forEach(O=>{const I=O.amount||0,ee=new Date(O.created_at);P+=I,ee>=g&&(E+=I),ee>=b&&(V+=I),ee>=A&&(M+=I)}),n({totalRevenue:P,todayRevenue:E,thisWeekRevenue:V,thisMonthRevenue:M,monthlyRevenue:M,averagePayment:v?.length?P/v.length:0,paymentMethodBreakdown:{cash:0,card:0,digital:0,free:0}})}catch(v){console.error("Error fetching overall stats:",v)}},p=async()=>{try{const{PaymentAPI:v}=await Ye(async()=>{const{PaymentAPI:y}=await Promise.resolve().then(()=>tl);return{PaymentAPI:y}},void 0);if(u&&a?.id){const{ContractorAPI:y}=await Ye(async()=>{const{ContractorAPI:P}=await Promise.resolve().then(()=>Er);return{ContractorAPI:P}},void 0),w=await y.getContractorByUserId(a.id);if(!w){i([]);return}const N=await v.getContractorPayments(w.id,{pageSize:1e3}),g={contractor_id:w.id,contractor_name:w.company_name||"Unknown",total_revenue:0,today_revenue:0,this_week_revenue:0,this_month_revenue:0},b=new Date,A=new Date(b.getTime()-7*24*60*60*1e3);N.data.forEach(P=>{if(P.payment_status==="completed"&&P.amount){const E=new Date(P.created_at);g.total_revenue+=P.amount,E.toDateString()===b.toDateString()&&(g.today_revenue+=P.amount),E>=A&&(g.this_week_revenue+=P.amount),E.getMonth()===b.getMonth()&&E.getFullYear()===b.getFullYear()&&(g.this_month_revenue+=P.amount)}}),i([g])}else{const w=(await v.getContractorWisePayments()).map(N=>({contractor_id:N.contractor_id,contractor_name:N.contractor_name,total_revenue:N.total_revenue,today_revenue:0,this_week_revenue:0,this_month_revenue:0}));i(w)}}catch(v){console.error("Error fetching contractor income:",v)}},f=async()=>{try{d([])}catch(v){console.error("Error fetching attendant income:",v)}};return t?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Income"}),e.jsx("p",{className:"text-muted-foreground",children:"Track revenue and financial performance"})]}),e.jsxs(F,{children:[e.jsx(si,{className:"h-4 w-4 mr-2"}),"Export Data"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(Pe,{title:"Today's Revenue",value:mt(r?.todayRevenue||0),description:"+0% from yesterday",icon:vs,variant:"success"}),e.jsx(Pe,{title:"This Week",value:mt(r?.thisWeekRevenue||0),description:"+0% from last week",icon:Us,variant:"info"}),e.jsx(Pe,{title:"This Month",value:mt(r?.thisMonthRevenue||0),description:"+0% from last month",icon:Ps,variant:"warning"}),e.jsx(Pe,{title:"Total Revenue",value:mt(r?.totalRevenue||0),description:"All time earnings",icon:vs,variant:"success"})]}),e.jsxs(Pu,{defaultValue:"contractors",className:"space-y-6",children:[e.jsxs(Si,{className:"grid w-full grid-cols-1 sm:grid-cols-3 h-auto p-1",children:[e.jsxs(Ta,{value:"contractors",className:"flex items-center justify-center gap-2 py-3 px-2 sm:px-4 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx(Ra,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Contractor Income"}),e.jsx("span",{className:"sm:hidden",children:"Contractors"})]}),e.jsxs(Ta,{value:"attendants",className:"flex items-center justify-center gap-2 py-3 px-2 sm:px-4 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx(Wt,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Attendant Income"}),e.jsx("span",{className:"sm:hidden",children:"Attendants"})]}),e.jsxs(Ta,{value:"overview",className:"flex items-center justify-center gap-2 py-3 px-2 sm:px-4 text-xs sm:text-sm whitespace-nowrap",children:[e.jsx(ta,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Overview"}),e.jsx("span",{className:"sm:hidden",children:"Overview"})]})]}),e.jsx(Da,{value:"contractors",className:"space-y-4",children:e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Contractor-wise Income"}),e.jsx(et,{children:"Revenue breakdown by contractor"})]}),e.jsx(Ee,{children:o.length>0?e.jsx("div",{className:"space-y-4",children:o.map(v=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:v.contractor_name}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:mt(v.total_revenue)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Today"}),e.jsx("p",{className:"font-medium",children:mt(v.today_revenue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"This Week"}),e.jsx("p",{className:"font-medium",children:mt(v.this_week_revenue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"This Month"}),e.jsx("p",{className:"font-medium",children:mt(v.this_month_revenue)})]})]})]},v.contractor_id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ra,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No contractor income data"}),e.jsx("p",{className:"text-muted-foreground",children:"Contractor income will appear here once payments are recorded"})]})})]})}),e.jsx(Da,{value:"attendants",className:"space-y-4",children:e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Attendant-wise Income"}),e.jsx(et,{children:"Revenue breakdown by attendant"})]}),e.jsx(Ee,{children:c.length>0?e.jsx("div",{className:"space-y-4",children:c.map(v=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:v.attendant_name}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:mt(v.total_revenue)})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Today"}),e.jsx("p",{className:"font-medium",children:mt(v.today_revenue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"This Week"}),e.jsx("p",{className:"font-medium",children:mt(v.this_week_revenue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"This Month"}),e.jsx("p",{className:"font-medium",children:mt(v.this_month_revenue)})]})]})]},v.attendant_id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Wt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No attendant income data"}),e.jsx("p",{className:"text-muted-foreground",children:"Attendant income will appear here once payments are recorded"})]})})]})}),e.jsx(Da,{value:"overview",className:"space-y-4",children:e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Revenue Overview"}),e.jsx(et,{children:"Visual representation of income over time"})]}),e.jsx(Ee,{children:r&&r.totalRevenue>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Daily Average"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:mt(r.totalRevenue/30)})]}),e.jsx(Ps,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Best Day"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:mt(r.todayRevenue)})]}),e.jsx(Us,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Average Transaction"}),e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:mt(r.averagePayment)})]}),e.jsx(vs,{className:"h-8 w-8 text-purple-500"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Revenue Timeline"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"Today"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-green-600",children:mt(r.todayRevenue)}),e.jsx("p",{className:"text-xs text-gray-500",children:"+0% from yesterday"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"This Week"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-blue-600",children:mt(r.thisWeekRevenue)}),e.jsx("p",{className:"text-xs text-gray-500",children:"+0% from last week"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"This Month"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-purple-600",children:mt(r.thisMonthRevenue)}),e.jsx("p",{className:"text-xs text-gray-500",children:"+0% from last month"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"All Time"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-orange-600",children:mt(r.totalRevenue)}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total earnings"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Revenue Distribution"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Today"}),e.jsxs("span",{children:[(r.todayRevenue/r.totalRevenue*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${r.todayRevenue/r.totalRevenue*100}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"This Week"}),e.jsxs("span",{children:[(r.thisWeekRevenue/r.totalRevenue*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${r.thisWeekRevenue/r.totalRevenue*100}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"This Month"}),e.jsxs("span",{children:[(r.thisMonthRevenue/r.totalRevenue*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${r.thisMonthRevenue/r.totalRevenue*100}%`}})})]})]})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Us,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Revenue Data"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Revenue charts will appear here once transactions are recorded"})]})})]})})]})]})}function p0(){const{profile:a,user:t}=ft(),[s,r]=l.useState([]),[n,o]=l.useState([]),[i,c]=l.useState({totalEvents:0,todayEvents:0,errors:0,warnings:0}),[d,u]=l.useState(!0),[h,m]=l.useState(""),[p,f]=l.useState(""),[v,y]=l.useState(!1),[w,N]=l.useState({page:1,pageSize:10,totalPages:0,totalCount:0});l.useEffect(()=>{g()},[]),l.useEffect(()=>{E()},[s,h]),l.useEffect(()=>{if(n.length>0){const $=Math.ceil(n.length/w.pageSize);N(Y=>({...Y,totalPages:$,totalCount:n.length,page:Math.min(Y.page,$||1)}))}},[n.length,w.pageSize]),l.useEffect(()=>{const $=setTimeout(()=>{p!==h&&V(p)},500);return()=>clearTimeout($)},[p]);const g=async()=>{try{u(!0);let $;if(a?.role==="contractor"&&t?.id)$=await b(t.id);else try{const{DashboardAPI:Y}=await Ye(async()=>{const{DashboardAPI:_}=await import("./dashboardApi-DxH4pNKS.js");return{DashboardAPI:_}},__vite__mapDeps([0,1,2,3,4])),Z=await Y.getRecentActivityPaginated({page:1,pageSize:100,sortBy:"timestamp",sortOrder:"desc"});Z.data&&Array.isArray(Z.data)&&Z.data.length>0?$=Z.data:(console.log("Creating sample logs from existing data..."),$=await A())}catch(Y){console.log("Error fetching recent activity, creating sample logs from existing data...",Y),$=await A()}if($){const Y=$.map(Z=>({id:Z.id,level:Z.level,message:Z.message,details:Z.details,user_id:Z.user_id,user_name:Z.profiles?.user_name||Z.user_name||"System",action:Z.action,resource:Z.resource,created_at:Z.created_at}));r(Y),P(Y)}}catch($){console.error("Error fetching logs:",$);try{const Y=await A();r(Y),P(Y)}catch(Y){console.error("Error generating sample logs:",Y),r([]),P([])}}finally{u(!1)}},b=async $=>{try{const Y=await kt.getContractorByUserId($);if(!Y||!Y.id)return[];const Z=[];try{(await Gt.getContractorVehicles(Y.id)).slice(0,20).forEach(L=>{L.check_in_time&&Z.push({id:`vehicle-checkin-${L.id}`,level:"info",message:`Vehicle ${L.plate_number} checked in`,details:`Vehicle checked in at ${ts(L.check_in_time)}`,user_name:"System",action:"vehicle_checkin",resource:"vehicles",created_at:L.check_in_time}),L.check_out_time&&Z.push({id:`vehicle-checkout-${L.id}`,level:"success",message:`Vehicle ${L.plate_number} checked out`,details:`Vehicle checked out at ${ts(L.check_out_time)}`,user_name:"System",action:"vehicle_checkout",resource:"vehicles",created_at:L.check_out_time})})}catch(_){console.error("Error fetching contractor vehicles for logs:",_)}try{(await kt.getContractorLocations(Y.id)).slice(0,5).forEach(L=>{Z.push({id:`location-${L.id}`,level:"info",message:`Location ${L.locations_name} active`,details:"Location is active and operational",user_name:"System",action:"location_active",resource:"parking_locations",created_at:L.created_on||new Date().toISOString()})})}catch(_){console.error("Error fetching contractor locations for logs:",_)}return Z.sort((_,L)=>new Date(L.created_at).getTime()-new Date(_.created_at).getTime())}catch(Y){return console.error("Error fetching contractor logs:",Y),[]}},A=async()=>{try{let $=[],Y=[],Z=[];try{$=await Gt.getAllVehicles(),$=$.slice(0,10)}catch(L){console.error("Error fetching vehicles for sample logs:",L)}try{Y=await kt.getAllContractors(),Y=Y.slice(0,5)}catch(L){console.error("Error fetching contractors for sample logs:",L)}try{Z=(await oa.getAllAttendants({page:1,pageSize:5})).data||[]}catch(L){console.error("Error fetching attendants for sample logs:",L)}const _=[];return $&&$.length>0&&$.forEach((L,C)=>{L.check_in_time&&_.push({id:`vehicle-checkin-${L.id}`,level:"info",message:`Vehicle ${L.plate_number} checked in`,details:`Vehicle checked in at ${ts(L.check_in_time)}`,user_name:"System",action:"vehicle_checkin",resource:"vehicles",created_at:L.check_in_time}),L.check_out_time&&_.push({id:`vehicle-checkout-${L.id}`,level:"success",message:`Vehicle ${L.plate_number} checked out`,details:`Vehicle checked out at ${ts(L.check_out_time)}`,user_name:"System",action:"vehicle_checkout",resource:"vehicles",created_at:L.check_out_time})}),Y&&Y.length>0&&Y.forEach(L=>{_.push({id:`contractor-${L.id}`,level:"info",message:`Contractor ${L.company_name||"Unknown"} registered`,details:"New contractor added to the system",user_name:"System",action:"contractor_create",resource:"contractors",created_at:L.created_on||new Date().toISOString()})}),Z&&Z.length>0&&Z.forEach(L=>{const C=L.profiles?.user_name||"Unknown";_.push({id:`attendant-${L.id}`,level:"info",message:`Attendant ${C} added`,details:"New attendant added to the system",user_name:"System",action:"attendant_create",resource:"attendants",created_at:L.created_on||new Date().toISOString()})}),_.push({id:"system-start",level:"info",message:"System started successfully",details:"All services are running normally",user_name:"System",action:"system_start",resource:"system",created_at:new Date().toISOString()}),_.push({id:"system-warning",level:"warning",message:"High memory usage detected",details:"Memory usage reached 85%",user_name:"System",action:"system_warning",resource:"system",created_at:new Date(Date.now()-2*60*60*1e3).toISOString()}),_.sort((L,C)=>new Date(C.created_at).getTime()-new Date(L.created_at).getTime())}catch($){return console.error("Error generating sample logs:",$),[]}},P=$=>{const Y=new Date,Z=new Date(Y.getFullYear(),Y.getMonth(),Y.getDate()),_=$.filter(T=>new Date(T.created_at)>=Z),L=$.filter(T=>T.level==="error").length,C=$.filter(T=>T.level==="warning").length;c({totalEvents:$.length,todayEvents:_.length,errors:L,warnings:C})},E=()=>{let $=s;h&&($=$.filter(Y=>Y.message.toLowerCase().includes(h.toLowerCase())||Y.details?.toLowerCase().includes(h.toLowerCase())||Y.user_name?.toLowerCase().includes(h.toLowerCase()))),o($)},V=async $=>{m($),N(Y=>({...Y,page:1})),y(!0);try{}finally{y(!1)}},M=$=>{N(Y=>({...Y,page:$}))},O=$=>{N(Y=>{const Z={...Y,pageSize:$,page:1},_=Math.ceil(n.length/$);return{...Z,totalPages:_,totalCount:n.length}})},I=()=>{const $=(w.page-1)*w.pageSize,Y=$+w.pageSize;return n.slice($,Y)},ee=$=>{switch($){case"error":return e.jsx(Na,{className:"h-4 w-4 text-red-500"});case"warning":return e.jsx(sa,{className:"h-4 w-4 text-yellow-500"});case"success":return e.jsx(Rt,{className:"h-4 w-4 text-green-500"});case"info":default:return e.jsx(Im,{className:"h-4 w-4 text-blue-500"})}},G=$=>{if(!$)return e.jsx(Je,{variant:"outline",children:"UNKNOWN"});const Y={error:"destructive",warning:"secondary",success:"default",info:"outline"};return e.jsx(Je,{variant:Y[$]||"outline",children:$.toUpperCase()})},ae=()=>{const $=[["Timestamp","Level","Message","Details","User","Action","Resource"],...n.map(L=>[ts(L.created_at),L.level,L.message,L.details||"",L.user_name||"",L.action,L.resource])].map(L=>L.map(C=>`"${C}"`).join(",")).join(`
`),Y=new Blob([$],{type:"text/csv"}),Z=window.URL.createObjectURL(Y),_=document.createElement("a");_.href=Z,_.download=`system-logs-${new Date().toISOString().split("T")[0]}.csv`,_.click(),window.URL.revokeObjectURL(Z)};return d?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"System Logs"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Monitor system events and user activities"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2",children:e.jsxs(F,{variant:"outline",onClick:ae,className:"w-full sm:w-auto",children:[e.jsx(si,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6",children:[e.jsx(Pe,{title:"Total Events",value:i.totalEvents,description:"All time",icon:go,variant:"default"}),e.jsx(Pe,{title:"Today's Events",value:i.todayEvents,description:"Last 24 hours",icon:qs,variant:"default"}),e.jsx(Pe,{title:"Errors",value:i.errors,description:"System errors",icon:cn,variant:"destructive"}),e.jsx(Pe,{title:"Warnings",value:i.warnings,description:"System warnings",icon:sa,variant:"warning"})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx(Be,{className:"text-lg sm:text-xl",children:"Recent Logs"}),e.jsxs(et,{className:"text-sm",children:["View and filter system activity logs (",I().length," of ",n.length," total)",h&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:['(Search results for "',h,'")']})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-center",children:[e.jsxs("div",{className:"relative flex-1 sm:flex-none",children:[e.jsx(ua,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search logs...",value:p,onChange:$=>f($.target.value),className:"pl-8 pr-8 w-full sm:w-64",disabled:v}),v?e.jsx("div",{className:"absolute right-2 top-2.5 h-4 w-4 animate-spin rounded-full border-2 border-gray-300 border-t-blue-600"}):p?e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>{f(""),V("")},className:"absolute right-1 top-1 h-6 w-6 p-0 hover:bg-gray-100",children:e.jsx(Ds,{className:"h-3 w-3"})}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Show:"}),e.jsxs(Lt,{value:w.pageSize.toString(),onValueChange:$=>O(Number($)),children:[e.jsx(Ct,{className:"w-20",children:e.jsx(Mt,{})}),e.jsxs(Pt,{children:[e.jsx($e,{value:"5",children:"5"}),e.jsx($e,{value:"10",children:"10"}),e.jsx($e,{value:"20",children:"20"}),e.jsx($e,{value:"50",children:"50"})]})]})]}),e.jsxs(F,{onClick:g,variant:"outline",className:"w-full sm:w-auto",children:[e.jsx(ua,{className:"h-4 w-4 mr-2"}),"Refresh Logs"]})]})]})}),e.jsxs(Ee,{children:[I().length>0?e.jsx("div",{className:"space-y-3 sm:space-y-4",children:I().map($=>e.jsx("div",{className:"border rounded-lg p-3 sm:p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:ee($.level)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-sm sm:text-base truncate",children:$.message}),G($.level)]}),$.details&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2 line-clamp-2",children:$.details}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["User: ",$.user_name||"System"]}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs("span",{children:["Action: ",$.action]}),e.jsx("span",{className:"hidden sm:inline",children:""}),e.jsxs("span",{children:["Resource: ",$.resource]})]})]})]}),e.jsx("div",{className:"flex-shrink-0 text-xs text-muted-foreground",children:Ux($.created_at)})]})},$.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(go,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No logs found"}),e.jsx("p",{className:"text-muted-foreground",children:h?"No logs match your search criteria.":"No system logs available at the moment."})]}),w.totalCount>0&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 px-4 py-4 border-t bg-gray-50/50",children:[e.jsxs("div",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",(w.page-1)*w.pageSize+1," to ",Math.min(w.page*w.pageSize,w.totalCount)," of ",w.totalCount," results",e.jsx("br",{}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Page ",w.page," of ",w.totalPages," | Showing ",w.pageSize," per page"]})]}),w.totalPages>1&&e.jsx(Yr,{children:e.jsxs(Gr,{children:[e.jsx(Et,{children:e.jsx(Zr,{onClick:()=>M(w.page-1),className:w.page===1?"pointer-events-none opacity-50":"cursor-pointer hover:bg-gray-100"})}),Array.from({length:Math.min(5,w.totalPages)},($,Y)=>{let Z;return w.totalPages<=5||w.page<=3?Z=Y+1:w.page>=w.totalPages-2?Z=w.totalPages-4+Y:Z=w.page-2+Y,e.jsx(Et,{children:e.jsx($a,{onClick:()=>M(Z),isActive:w.page===Z,className:"cursor-pointer hover:bg-gray-100",children:Z})},Z)}),w.totalPages>5&&w.page<w.totalPages-2&&e.jsx(Et,{children:e.jsx(Qr,{})}),e.jsx(Et,{children:e.jsx(Kr,{onClick:()=>M(w.page+1),className:w.page===w.totalPages?"pointer-events-none opacity-50":"cursor-pointer hover:bg-gray-100"})})]})})]})]})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Loading Profile..."}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while we load your profile."})]})})}var Ml=1,f0=.9,x0=.8,g0=.17,po=.1,fo=.999,v0=.9999,y0=.99,b0=/[\\\/_+.#"@\[\(\{&]/,w0=/[\\\/_+.#"@\[\(\{&]/g,j0=/[\s-]/,Ch=/[\s-]/g;function zo(a,t,s,r,n,o,i){if(o===t.length)return n===a.length?Ml:y0;var c=`${n},${o}`;if(i[c]!==void 0)return i[c];for(var d=r.charAt(o),u=s.indexOf(d,n),h=0,m,p,f,v;u>=0;)m=zo(a,t,s,r,u+1,o+1,i),m>h&&(u===n?m*=Ml:b0.test(a.charAt(u-1))?(m*=x0,f=a.slice(n,u-1).match(w0),f&&n>0&&(m*=Math.pow(fo,f.length))):j0.test(a.charAt(u-1))?(m*=f0,v=a.slice(n,u-1).match(Ch),v&&n>0&&(m*=Math.pow(fo,v.length))):(m*=g0,n>0&&(m*=Math.pow(fo,u-n))),a.charAt(u)!==t.charAt(o)&&(m*=v0)),(m<po&&s.charAt(u-1)===r.charAt(o+1)||r.charAt(o+1)===r.charAt(o)&&s.charAt(u-1)!==r.charAt(o))&&(p=zo(a,t,s,r,u+1,o+2,i),p*po>m&&(m=p*po)),m>h&&(h=m),u=s.indexOf(d,u+1);return i[c]=h,h}function Fl(a){return a.toLowerCase().replace(Ch," ")}function N0(a,t,s){return a=s&&s.length>0?`${a+" "+s.join(" ")}`:a,zo(a,t,Fl(a),Fl(t),0,0,{})}var xr='[cmdk-group=""]',xo='[cmdk-group-items=""]',_0='[cmdk-group-heading=""]',Ph='[cmdk-item=""]',$l=`${Ph}:not([aria-disabled="true"])`,Bo="cmdk-item-select",qa="data-value",S0=(a,t,s)=>N0(a,t,s),Ah=l.createContext(void 0),Xr=()=>l.useContext(Ah),Eh=l.createContext(void 0),Oi=()=>l.useContext(Eh),Rh=l.createContext(void 0),Th=l.forwardRef((a,t)=>{let s=Wa(()=>{var x,S;return{search:"",value:(S=(x=a.value)!=null?x:a.defaultValue)!=null?S:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=Wa(()=>new Set),n=Wa(()=>new Map),o=Wa(()=>new Map),i=Wa(()=>new Set),c=Dh(a),{label:d,children:u,value:h,onValueChange:m,filter:p,shouldFilter:f,loop:v,disablePointerSelection:y=!1,vimBindings:w=!0,...N}=a,g=as(),b=as(),A=as(),P=l.useRef(null),E=L0();Fa(()=>{if(h!==void 0){let x=h.trim();s.current.value=x,V.emit()}},[h]),Fa(()=>{E(6,ae)},[]);let V=l.useMemo(()=>({subscribe:x=>(i.current.add(x),()=>i.current.delete(x)),snapshot:()=>s.current,setState:(x,S,q)=>{var U,de,Q,z;if(!Object.is(s.current[x],S)){if(s.current[x]=S,x==="search")G(),I(),E(1,ee);else if(x==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let D=document.getElementById(A);D?D.focus():(U=document.getElementById(g))==null||U.focus()}if(E(7,()=>{var D;s.current.selectedItemId=(D=$())==null?void 0:D.id,V.emit()}),q||E(5,ae),((de=c.current)==null?void 0:de.value)!==void 0){let D=S??"";(z=(Q=c.current).onValueChange)==null||z.call(Q,D);return}}V.emit()}},emit:()=>{i.current.forEach(x=>x())}}),[]),M=l.useMemo(()=>({value:(x,S,q)=>{var U;S!==((U=o.current.get(x))==null?void 0:U.value)&&(o.current.set(x,{value:S,keywords:q}),s.current.filtered.items.set(x,O(S,q)),E(2,()=>{I(),V.emit()}))},item:(x,S)=>(r.current.add(x),S&&(n.current.has(S)?n.current.get(S).add(x):n.current.set(S,new Set([x]))),E(3,()=>{G(),I(),s.current.value||ee(),V.emit()}),()=>{o.current.delete(x),r.current.delete(x),s.current.filtered.items.delete(x);let q=$();E(4,()=>{G(),q?.getAttribute("id")===x&&ee(),V.emit()})}),group:x=>(n.current.has(x)||n.current.set(x,new Set),()=>{o.current.delete(x),n.current.delete(x)}),filter:()=>c.current.shouldFilter,label:d||a["aria-label"],getDisablePointerSelection:()=>c.current.disablePointerSelection,listId:g,inputId:A,labelId:b,listInnerRef:P}),[]);function O(x,S){var q,U;let de=(U=(q=c.current)==null?void 0:q.filter)!=null?U:S0;return x?de(x,s.current.search,S):0}function I(){if(!s.current.search||c.current.shouldFilter===!1)return;let x=s.current.filtered.items,S=[];s.current.filtered.groups.forEach(U=>{let de=n.current.get(U),Q=0;de.forEach(z=>{let D=x.get(z);Q=Math.max(D,Q)}),S.push([U,Q])});let q=P.current;Y().sort((U,de)=>{var Q,z;let D=U.getAttribute("id"),X=de.getAttribute("id");return((Q=x.get(X))!=null?Q:0)-((z=x.get(D))!=null?z:0)}).forEach(U=>{let de=U.closest(xo);de?de.appendChild(U.parentElement===de?U:U.closest(`${xo} > *`)):q.appendChild(U.parentElement===q?U:U.closest(`${xo} > *`))}),S.sort((U,de)=>de[1]-U[1]).forEach(U=>{var de;let Q=(de=P.current)==null?void 0:de.querySelector(`${xr}[${qa}="${encodeURIComponent(U[0])}"]`);Q?.parentElement.appendChild(Q)})}function ee(){let x=Y().find(q=>q.getAttribute("aria-disabled")!=="true"),S=x?.getAttribute(qa);V.setState("value",S||void 0)}function G(){var x,S,q,U;if(!s.current.search||c.current.shouldFilter===!1){s.current.filtered.count=r.current.size;return}s.current.filtered.groups=new Set;let de=0;for(let Q of r.current){let z=(S=(x=o.current.get(Q))==null?void 0:x.value)!=null?S:"",D=(U=(q=o.current.get(Q))==null?void 0:q.keywords)!=null?U:[],X=O(z,D);s.current.filtered.items.set(Q,X),X>0&&de++}for(let[Q,z]of n.current)for(let D of z)if(s.current.filtered.items.get(D)>0){s.current.filtered.groups.add(Q);break}s.current.filtered.count=de}function ae(){var x,S,q;let U=$();U&&(((x=U.parentElement)==null?void 0:x.firstChild)===U&&((q=(S=U.closest(xr))==null?void 0:S.querySelector(_0))==null||q.scrollIntoView({block:"nearest"})),U.scrollIntoView({block:"nearest"}))}function $(){var x;return(x=P.current)==null?void 0:x.querySelector(`${Ph}[aria-selected="true"]`)}function Y(){var x;return Array.from(((x=P.current)==null?void 0:x.querySelectorAll($l))||[])}function Z(x){let S=Y()[x];S&&V.setState("value",S.getAttribute(qa))}function _(x){var S;let q=$(),U=Y(),de=U.findIndex(z=>z===q),Q=U[de+x];(S=c.current)!=null&&S.loop&&(Q=de+x<0?U[U.length-1]:de+x===U.length?U[0]:U[de+x]),Q&&V.setState("value",Q.getAttribute(qa))}function L(x){let S=$(),q=S?.closest(xr),U;for(;q&&!U;)q=x>0?I0(q,xr):O0(q,xr),U=q?.querySelector($l);U?V.setState("value",U.getAttribute(qa)):_(x)}let C=()=>Z(Y().length-1),T=x=>{x.preventDefault(),x.metaKey?C():x.altKey?L(1):_(1)},H=x=>{x.preventDefault(),x.metaKey?Z(0):x.altKey?L(-1):_(-1)};return l.createElement(De.div,{ref:t,tabIndex:-1,...N,"cmdk-root":"",onKeyDown:x=>{var S;(S=N.onKeyDown)==null||S.call(N,x);let q=x.nativeEvent.isComposing||x.keyCode===229;if(!(x.defaultPrevented||q))switch(x.key){case"n":case"j":{w&&x.ctrlKey&&T(x);break}case"ArrowDown":{T(x);break}case"p":case"k":{w&&x.ctrlKey&&H(x);break}case"ArrowUp":{H(x);break}case"Home":{x.preventDefault(),Z(0);break}case"End":{x.preventDefault(),C();break}case"Enter":{x.preventDefault();let U=$();if(U){let de=new Event(Bo);U.dispatchEvent(de)}}}}},l.createElement("label",{"cmdk-label":"",htmlFor:M.inputId,id:M.labelId,style:F0},d),eo(a,x=>l.createElement(Eh.Provider,{value:V},l.createElement(Ah.Provider,{value:M},x))))}),k0=l.forwardRef((a,t)=>{var s,r;let n=as(),o=l.useRef(null),i=l.useContext(Rh),c=Xr(),d=Dh(a),u=(r=(s=d.current)==null?void 0:s.forceMount)!=null?r:i?.forceMount;Fa(()=>{if(!u)return c.item(n,i?.id)},[u]);let h=Ih(n,o,[a.value,a.children,o],a.keywords),m=Oi(),p=fa(E=>E.value&&E.value===h.current),f=fa(E=>u||c.filter()===!1?!0:E.search?E.filtered.items.get(n)>0:!0);l.useEffect(()=>{let E=o.current;if(!(!E||a.disabled))return E.addEventListener(Bo,v),()=>E.removeEventListener(Bo,v)},[f,a.onSelect,a.disabled]);function v(){var E,V;y(),(V=(E=d.current).onSelect)==null||V.call(E,h.current)}function y(){m.setState("value",h.current,!0)}if(!f)return null;let{disabled:w,value:N,onSelect:g,forceMount:b,keywords:A,...P}=a;return l.createElement(De.div,{ref:_r(o,t),...P,id:n,"cmdk-item":"",role:"option","aria-disabled":!!w,"aria-selected":!!p,"data-disabled":!!w,"data-selected":!!p,onPointerMove:w||c.getDisablePointerSelection()?void 0:y,onClick:w?void 0:v},a.children)}),C0=l.forwardRef((a,t)=>{let{heading:s,children:r,forceMount:n,...o}=a,i=as(),c=l.useRef(null),d=l.useRef(null),u=as(),h=Xr(),m=fa(f=>n||h.filter()===!1?!0:f.search?f.filtered.groups.has(i):!0);Fa(()=>h.group(i),[]),Ih(i,c,[a.value,a.heading,d]);let p=l.useMemo(()=>({id:i,forceMount:n}),[n]);return l.createElement(De.div,{ref:_r(c,t),...o,"cmdk-group":"",role:"presentation",hidden:m?void 0:!0},s&&l.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:u},s),eo(a,f=>l.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":s?u:void 0},l.createElement(Rh.Provider,{value:p},f))))}),P0=l.forwardRef((a,t)=>{let{alwaysRender:s,...r}=a,n=l.useRef(null),o=fa(i=>!i.search);return!s&&!o?null:l.createElement(De.div,{ref:_r(n,t),...r,"cmdk-separator":"",role:"separator"})}),A0=l.forwardRef((a,t)=>{let{onValueChange:s,...r}=a,n=a.value!=null,o=Oi(),i=fa(u=>u.search),c=fa(u=>u.selectedItemId),d=Xr();return l.useEffect(()=>{a.value!=null&&o.setState("search",a.value)},[a.value]),l.createElement(De.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":c,id:d.inputId,type:"text",value:n?a.value:i,onChange:u=>{n||o.setState("search",u.target.value),s?.(u.target.value)}})}),E0=l.forwardRef((a,t)=>{let{children:s,label:r="Suggestions",...n}=a,o=l.useRef(null),i=l.useRef(null),c=fa(u=>u.selectedItemId),d=Xr();return l.useEffect(()=>{if(i.current&&o.current){let u=i.current,h=o.current,m,p=new ResizeObserver(()=>{m=requestAnimationFrame(()=>{let f=u.offsetHeight;h.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return p.observe(u),()=>{cancelAnimationFrame(m),p.unobserve(u)}}},[]),l.createElement(De.div,{ref:_r(o,t),...n,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":c,"aria-label":r,id:d.listId},eo(a,u=>l.createElement("div",{ref:_r(i,d.listInnerRef),"cmdk-list-sizer":""},u)))}),R0=l.forwardRef((a,t)=>{let{open:s,onOpenChange:r,overlayClassName:n,contentClassName:o,container:i,...c}=a;return l.createElement(Jo,{open:s,onOpenChange:r},l.createElement(Xo,{container:i},l.createElement(En,{"cmdk-overlay":"",className:n}),l.createElement(Rn,{"aria-label":a.label,"cmdk-dialog":"",className:o},l.createElement(Th,{ref:t,...c}))))}),T0=l.forwardRef((a,t)=>fa(s=>s.filtered.count===0)?l.createElement(De.div,{ref:t,...a,"cmdk-empty":"",role:"presentation"}):null),D0=l.forwardRef((a,t)=>{let{progress:s,children:r,label:n="Loading...",...o}=a;return l.createElement(De.div,{ref:t,...o,"cmdk-loading":"",role:"progressbar","aria-valuenow":s,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},eo(a,i=>l.createElement("div",{"aria-hidden":!0},i)))}),Yt=Object.assign(Th,{List:E0,Item:k0,Input:A0,Group:C0,Separator:P0,Dialog:R0,Empty:T0,Loading:D0});function I0(a,t){let s=a.nextElementSibling;for(;s;){if(s.matches(t))return s;s=s.nextElementSibling}}function O0(a,t){let s=a.previousElementSibling;for(;s;){if(s.matches(t))return s;s=s.previousElementSibling}}function Dh(a){let t=l.useRef(a);return Fa(()=>{t.current=a}),t}var Fa=typeof window>"u"?l.useEffect:l.useLayoutEffect;function Wa(a){let t=l.useRef();return t.current===void 0&&(t.current=a()),t}function fa(a){let t=Oi(),s=()=>a(t.snapshot());return l.useSyncExternalStore(t.subscribe,s,s)}function Ih(a,t,s,r=[]){let n=l.useRef(),o=Xr();return Fa(()=>{var i;let c=(()=>{var u;for(let h of s){if(typeof h=="string")return h.trim();if(typeof h=="object"&&"current"in h)return h.current?(u=h.current.textContent)==null?void 0:u.trim():n.current}})(),d=r.map(u=>u.trim());o.value(a,c,d),(i=t.current)==null||i.setAttribute(qa,c),n.current=c}),n}var L0=()=>{let[a,t]=l.useState(),s=Wa(()=>new Map);return Fa(()=>{s.current.forEach(r=>r()),s.current=new Map},[a]),(r,n)=>{s.current.set(r,n),t({})}};function M0(a){let t=a.type;return typeof t=="function"?t(a.props):"render"in t?t.render(a.props):a}function eo({asChild:a,children:t},s){return a&&l.isValidElement(t)?l.cloneElement(M0(t),{ref:t.ref},s(t.props.children)):s(t)}var F0={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Oh=l.forwardRef(({className:a,...t},s)=>e.jsx(Yt,{ref:s,className:ce("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",a),...t}));Oh.displayName=Yt.displayName;const Lh=l.forwardRef(({className:a,...t},s)=>e.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[e.jsx(ua,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),e.jsx(Yt.Input,{ref:s,className:ce("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",a),...t})]}));Lh.displayName=Yt.Input.displayName;const Mh=l.forwardRef(({className:a,...t},s)=>e.jsx(Yt.List,{ref:s,className:ce("max-h-[300px] overflow-y-auto overflow-x-hidden",a),...t}));Mh.displayName=Yt.List.displayName;const Fh=l.forwardRef((a,t)=>e.jsx(Yt.Empty,{ref:t,className:"py-6 text-center text-sm",...a}));Fh.displayName=Yt.Empty.displayName;const $h=l.forwardRef(({className:a,...t},s)=>e.jsx(Yt.Group,{ref:s,className:ce("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",a),...t}));$h.displayName=Yt.Group.displayName;const $0=l.forwardRef(({className:a,...t},s)=>e.jsx(Yt.Separator,{ref:s,className:ce("-mx-1 h-px bg-border",a),...t}));$0.displayName=Yt.Separator.displayName;const Vh=l.forwardRef(({className:a,...t},s)=>e.jsx(Yt.Item,{ref:s,className:ce("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",a),...t}));Vh.displayName=Yt.Item.displayName;var to="Popover",[Uh,Eb]=Rs(to,[ur]),en=ur(),[V0,va]=Uh(to),zh=a=>{const{__scopePopover:t,children:s,open:r,defaultOpen:n,onOpenChange:o,modal:i=!1}=a,c=en(t),d=l.useRef(null),[u,h]=l.useState(!1),[m,p]=Ia({prop:r,defaultProp:n??!1,onChange:o,caller:to});return e.jsx(Go,{...c,children:e.jsx(V0,{scope:t,contentId:as(),triggerRef:d,open:m,onOpenChange:p,onOpenToggle:l.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:u,onCustomAnchorAdd:l.useCallback(()=>h(!0),[]),onCustomAnchorRemove:l.useCallback(()=>h(!1),[]),modal:i,children:s})})};zh.displayName=to;var Bh="PopoverAnchor",U0=l.forwardRef((a,t)=>{const{__scopePopover:s,...r}=a,n=va(Bh,s),o=en(s),{onCustomAnchorAdd:i,onCustomAnchorRemove:c}=n;return l.useEffect(()=>(i(),()=>c()),[i,c]),e.jsx(Pn,{...o,...r,ref:t})});U0.displayName=Bh;var Hh="PopoverTrigger",qh=l.forwardRef((a,t)=>{const{__scopePopover:s,...r}=a,n=va(Hh,s),o=en(s),i=rt(t,n.triggerRef),c=e.jsx(De.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":Kh(n.open),...r,ref:i,onClick:Oe(a.onClick,n.onOpenToggle)});return n.hasCustomAnchor?c:e.jsx(Pn,{asChild:!0,...o,children:c})});qh.displayName=Hh;var Li="PopoverPortal",[z0,B0]=Uh(Li,{forceMount:void 0}),Wh=a=>{const{__scopePopover:t,forceMount:s,children:r,container:n}=a,o=va(Li,t);return e.jsx(z0,{scope:t,forceMount:s,children:e.jsx(Ts,{present:s||o.open,children:e.jsx(xc,{asChild:!0,container:n,children:r})})})};Wh.displayName=Li;var dr="PopoverContent",Yh=l.forwardRef((a,t)=>{const s=B0(dr,a.__scopePopover),{forceMount:r=s.forceMount,...n}=a,o=va(dr,a.__scopePopover);return e.jsx(Ts,{present:r||o.open,children:o.modal?e.jsx(q0,{...n,ref:t}):e.jsx(W0,{...n,ref:t})})});Yh.displayName=dr;var H0=gc("PopoverContent.RemoveScroll"),q0=l.forwardRef((a,t)=>{const s=va(dr,a.__scopePopover),r=l.useRef(null),n=rt(t,r),o=l.useRef(!1);return l.useEffect(()=>{const i=r.current;if(i)return hc(i)},[]),e.jsx(pc,{as:H0,allowPinchZoom:!0,children:e.jsx(Gh,{...a,ref:n,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Oe(a.onCloseAutoFocus,i=>{i.preventDefault(),o.current||s.triggerRef.current?.focus()}),onPointerDownOutside:Oe(a.onPointerDownOutside,i=>{const c=i.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;o.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Oe(a.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),W0=l.forwardRef((a,t)=>{const s=va(dr,a.__scopePopover),r=l.useRef(!1),n=l.useRef(!1);return e.jsx(Gh,{...a,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{a.onCloseAutoFocus?.(o),o.defaultPrevented||(r.current||s.triggerRef.current?.focus(),o.preventDefault()),r.current=!1,n.current=!1},onInteractOutside:o=>{a.onInteractOutside?.(o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const i=o.target;s.triggerRef.current?.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),Gh=l.forwardRef((a,t)=>{const{__scopePopover:s,trapFocus:r,onOpenAutoFocus:n,onCloseAutoFocus:o,disableOutsidePointerEvents:i,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:h,...m}=a,p=va(dr,s),f=en(s);return mc(),e.jsx(fc,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:n,onUnmountAutoFocus:o,children:e.jsx(qo,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:h,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:e.jsx(Wo,{"data-state":Kh(p.open),role:"dialog",id:p.contentId,...f,...m,ref:t,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Zh="PopoverClose",Y0=l.forwardRef((a,t)=>{const{__scopePopover:s,...r}=a,n=va(Zh,s);return e.jsx(De.button,{type:"button",...r,ref:t,onClick:Oe(a.onClick,()=>n.onOpenChange(!1))})});Y0.displayName=Zh;var G0="PopoverArrow",Z0=l.forwardRef((a,t)=>{const{__scopePopover:s,...r}=a,n=en(s);return e.jsx(Yo,{...n,...r,ref:t})});Z0.displayName=G0;function Kh(a){return a?"open":"closed"}var K0=zh,Q0=qh,J0=Wh,Qh=Yh;const X0=K0,eb=Q0,Jh=l.forwardRef(({className:a,align:t="center",sideOffset:s=4,...r},n)=>e.jsx(J0,{children:e.jsx(Qh,{ref:n,align:t,sideOffset:s,className:ce("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...r})}));Jh.displayName=Qh.displayName;function tb({options:a,value:t,onValueChange:s,placeholder:r="Select option...",emptyText:n="No option found.",className:o,disabled:i=!1}){const[c,d]=l.useState(!1),u=a.find(h=>h.value===t);return e.jsxs(X0,{open:c,onOpenChange:d,children:[e.jsx(eb,{asChild:!0,children:e.jsxs(F,{variant:"outline",role:"combobox","aria-expanded":c,className:ce("w-full justify-between",o),disabled:i,children:[u?u.label:r,e.jsx(Dm,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(Jh,{className:"w-full p-0",align:"start",children:e.jsxs(Oh,{children:[e.jsx(Lh,{placeholder:"Search..."}),e.jsxs(Mh,{children:[e.jsx(Fh,{children:n}),e.jsx($h,{children:a.map(h=>e.jsxs(Vh,{value:h.searchableText||h.label,onSelect:m=>{const p=a.find(f=>(f.searchableText||f.label).toLowerCase()===m.toLowerCase())?.value;p&&s?.(p===t?"":p),d(!1)},children:[e.jsx(In,{className:ce("mr-2 h-4 w-4",t===h.value?"opacity-100":"opacity-0")}),h.label]},h.value))})]})]})})]})}class sb{static async getContractorSubscriptionDetails(){return(await pe.get("/subscription-dashboard/contractor-details")).data||[]}static async getContractorSubscriptionDetailsOld(){const{data:t,error:s}=await supabase.from("contractors").select(`
        id,
        user_id,
        company_name,
        profiles!inner(
          user_name,
          email,
          subscription_plan_id,
          subscription_start_date,
          subscription_end_date,
          subscription_status
        ),
        subscription_plans!inner(
          id,
          name,
          price
        )
      `).eq("is_deleted",!1).not("profiles.subscription_plan_id","is",null);if(s)throw s;const r=t?.map(n=>{new Date(n.profiles.subscription_start_date);const o=new Date(n.profiles.subscription_end_date),i=new Date,c=Math.ceil((o.getTime()-i.getTime())/(1e3*60*60*24));return{contractor_id:n.user_id,company_name:n.company_name,user_name:n.profiles.user_name,email:n.profiles.email,current_plan:{id:n.subscription_plans.id,name:n.subscription_plans.name,price:n.subscription_plans.price},subscription_start_date:n.profiles.subscription_start_date,subscription_end_date:n.profiles.subscription_end_date,subscription_status:n.profiles.subscription_status,days_remaining:c,total_payments:0,last_payment_date:"",subscription_count:0}})||[];for(const n of r){const o=n.contractor_id,{data:i}=await supabase.from("payments").select("amount, created_on").eq("contractor_id",o).eq("payment_status","completed");i&&(n.total_payments=i.reduce((d,u)=>d+u.amount,0),n.last_payment_date=i.length>0?i.sort((d,u)=>new Date(u.created_on).getTime()-new Date(d.created_on).getTime())[0].created_on:"");const{data:c}=await supabase.from("subscription_history").select("id").eq("contractor_id",o);n.subscription_count=c?.length||0}return r}static async getPaymentStatistics(){return(await pe.get("/subscription-dashboard/payment-statistics")).data}static async getPaymentStatisticsOld(){try{const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(t);r.setDate(t.getDate()-t.getDay()),r.setHours(0,0,0,0);const n=new Date(t.getFullYear(),t.getMonth(),1),[o,i,c,d]=await Promise.all([supabase.from("payments").select("amount").eq("payment_status","completed").gte("created_on",s.toISOString()),supabase.from("payments").select("amount").eq("payment_status","completed").gte("created_on",r.toISOString()),supabase.from("payments").select("amount").eq("payment_status","completed").gte("created_on",n.toISOString()),supabase.from("payments").select("amount").eq("payment_status","completed")]),u=h=>({amount:h?.reduce((m,p)=>m+p.amount,0)||0,count:h?.length||0});return{today:u(o.data),this_week:u(i.data),this_month:u(c.data),total:u(d.data)}}catch{return console.warn("Payments table not available, returning zero statistics"),{today:{amount:0,count:0},this_week:{amount:0,count:0},this_month:{amount:0,count:0},total:{amount:0,count:0}}}}static async getPlanPurchaseStatistics(){return(await pe.get("/subscription-dashboard/plan-purchase-statistics")).data}static async getPlanPurchaseStatisticsOld(){try{const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(t);r.setDate(t.getDate()-t.getDay()),r.setHours(0,0,0,0);const n=new Date(t.getFullYear(),t.getMonth(),1),[o,i,c,d]=await Promise.all([supabase.from("subscription_history").select("id").eq("action","assigned").gte("created_on",s.toISOString()),supabase.from("subscription_history").select("id").eq("action","assigned").gte("created_on",r.toISOString()),supabase.from("subscription_history").select("id").eq("action","assigned").gte("created_on",n.toISOString()),supabase.from("subscription_history").select("id").eq("action","assigned")]);return{today:o.data?.length||0,this_week:i.data?.length||0,this_month:c.data?.length||0,total:d.data?.length||0}}catch{return console.warn("Subscription history table not available, returning zero statistics"),{today:0,this_week:0,this_month:0,total:0}}}static async getContractorPaymentDetails(t){return(await pe.get(`/subscription-dashboard/contractor/${t}/payments`)).data||[]}static async getContractorPaymentDetailsOld(t){const{data:s,error:r}=await supabase.from("payments").select(`
        id,
        amount,
        payment_method,
        payment_status,
        created_on,
        subscription_start_date,
        subscription_end_date,
        duration_days,
        contractors!inner(
          company_name
        ),
        subscription_plans!inner(
          name
        )
      `).eq("contractor_id",t).order("created_on",{ascending:!1});if(r)throw r;return s?.map(n=>({id:n.id,contractor_name:n.contractors.company_name,plan_name:n.subscription_plans.name,amount:n.amount,payment_method:n.payment_method,payment_status:n.payment_status,payment_date:n.created_on,subscription_start_date:n.subscription_start_date,subscription_end_date:n.subscription_end_date,duration_days:n.duration_days}))||[]}static async getContractorSubscriptionHistory(t){return(await pe.get(`/subscription-dashboard/contractor/${t}/history`)).data||[]}static async getContractorSubscriptionHistoryOld(t){const{data:s,error:r}=await supabase.from("subscription_history").select(`
        id,
        action,
        new_start_date,
        new_end_date,
        duration_days,
        amount_paid,
        created_on,
        subscription_plan_id
      `).eq("contractor_id",t).order("created_on",{ascending:!1});if(r)throw r;const n=[...new Set([...s?.map(i=>i.subscription_plan_id).filter(Boolean)||[]])];let o={};if(n.length>0){const{data:i}=await supabase.from("subscription_plans").select("id, name").in("id",n);o=i?.reduce((c,d)=>(c[d.id]=d.name,c),{})||{}}return s?.map(i=>({id:i.id,action:i.action,plan_name:o[i.subscription_plan_id]||"Unknown Plan",previous_plan_name:void 0,new_start_date:i.new_start_date,new_end_date:i.new_end_date,previous_start_date:void 0,previous_end_date:void 0,duration_days:i.duration_days,amount_paid:i.amount_paid,created_on:i.created_on}))||[]}static async getAllPaymentDetails(){return(await pe.get("/subscription-dashboard/payments")).data||[]}static async getAllPaymentDetailsOld(){const{data:t,error:s}=await supabase.from("payments").select(`
        id,
        amount,
        payment_method,
        payment_status,
        created_on,
        subscription_start_date,
        subscription_end_date,
        duration_days,
        contractors!inner(
          company_name
        ),
        subscription_plans!inner(
          name
        )
      `).order("created_on",{ascending:!1});if(s)throw s;return t?.map(r=>({id:r.id,contractor_name:r.contractors.company_name,plan_name:r.subscription_plans.name,amount:r.amount,payment_method:r.payment_method,payment_status:r.payment_status,payment_date:r.created_on,subscription_start_date:r.subscription_start_date,subscription_end_date:r.subscription_end_date,duration_days:r.duration_days}))||[]}}function ab({onAssignSubscription:a}){const[t,s]=l.useState([]),[r,n]=l.useState([]),[o,i]=l.useState([]),[c,d]=l.useState(!0),[u,h]=l.useState(""),[m,p]=l.useState(1),[f,v]=l.useState(10),[y,w]=l.useState(1),[N,g]=l.useState(null),[b,A]=l.useState(!1),[P,E]=l.useState(!1),[V,M]=l.useState(!1),[O,I]=l.useState(null),[ee,G]=l.useState({name:"",price:0,days:0}),[ae,$]=l.useState(!1),[Y,Z]=l.useState(30),[_,L]=l.useState(null),[C,T]=l.useState(""),[H,x]=l.useState("extend"),[S,q]=l.useState([]),[U,de]=l.useState(null),[Q,z]=l.useState(!1),[D,X]=l.useState(!1),[B,oe]=l.useState(1),[Ae,Ce]=l.useState(5),[Ie,K]=l.useState(1),{toast:Ne}=Tt();l.useEffect(()=>{console.log(" Component mounted, refreshing data..."),Ve(!0)},[]);const Ve=async(k=!1)=>{try{d(!0),console.log(" Fetching subscription data...",{forceRefresh:k,timestamp:Date.now()}),k&&(console.log(" Clearing existing data for fresh fetch..."),s([]),n([]));const[be,ie]=await Promise.all([kt.getAllContractors(),ps.getSubscriptionPlans()]);console.log(" Fetched contractors data:",{count:be?.length||0,data:be?.map(ue=>({id:ue.id,company_name:ue.company_name,subscription_status:ue.profiles?.subscription_status,subscription_end_date:ue.profiles?.subscription_end_date,subscription_start_date:ue.profiles?.subscription_start_date,daysRemaining:W(ue.profiles),isExpired:W(ue.profiles)<=0}))}),s(be||[]),i(ie),k&&(console.log(" Force refreshing component state..."),p(ue=>ue+.001))}catch(be){console.error(" Error fetching data:",be),s([]),i([])}finally{d(!1)}};l.useEffect(()=>{const k=u.trim().toLowerCase();let be=t;k&&(be=be.filter(Nt=>{const _t=Nt.company_name||"",Jt=Nt.profiles?.user_name||"",sm=Nt.profiles?.email||"";return _t.toLowerCase().includes(k)||Jt.toLowerCase().includes(k)||sm.toLowerCase().includes(k)}));const ie=be.filter(Nt=>Nt.profiles?.subscription_plan_id),ue=ie.length,We=Math.max(1,Math.ceil(ue/f));w(We);const it=Math.min(m,We),dt=(it-1)*f,Ft=dt+f;n(ie.slice(dt,Ft)),it!==m&&p(it)},[t,u,m,f]);const Ge=k=>{if(!k)return e.jsx(Je,{variant:"secondary",children:"No Subscription"});const be=new Date(k.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return k.subscription_status==="expired"||ue<=0?e.jsx(Je,{variant:"destructive",children:"Expired"}):ue<=7?e.jsx(Je,{variant:"destructive",children:"Expiring Soon"}):ue<=30?e.jsx(Je,{variant:"secondary",children:"Expires Soon"}):e.jsx(Je,{variant:"default",children:"Active"})},j=k=>{if(!k)return e.jsx(sa,{className:"h-4 w-4 text-gray-500"});const be=new Date(k.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return k.subscription_status==="expired"||ue<=0?e.jsx(sa,{className:"h-4 w-4 text-red-500"}):ue<=7?e.jsx(sa,{className:"h-4 w-4 text-red-500"}):ue<=30?e.jsx(qs,{className:"h-4 w-4 text-yellow-500"}):e.jsx(Rt,{className:"h-4 w-4 text-green-500"})},R=k=>{if(!k)return"N/A";const be=new Date(k.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return ue>0?`${ue} days`:"Expired"},W=k=>{if(!k||!k.subscription_end_date)return 0;const be=new Date(k.subscription_end_date),ie=new Date;return Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24))},me=k=>{if(!k||!k.subscription_end_date)return console.log(" No subscription or end date:",{subscription:k}),!1;const be=new Date(k.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return console.log(" Checking subscription expiry:",{endDate:k.subscription_end_date,daysRemaining:ue,shouldShowExtend:ue<=30}),ue<=30},se=r.filter(k=>k.profiles?.subscription_plan_id),re=k=>{g(k),G({name:k.name,price:k.price,days:k.days||k.duration_days||30}),A(!0)},ve=()=>{g(null),G({name:"",price:0,days:30}),E(!0)},Te=async()=>{try{N?(await ps.updateSubscriptionPlan(N.id,ee),Ne({title:"Success",description:"Plan updated successfully"})):(await ps.createSubscriptionPlan(ee),Ne({title:"Success",description:"Plan created successfully"})),await Ve(),A(!1),E(!1)}catch(k){console.error("Error saving plan:",k),Ne({variant:"destructive",title:"Error",description:"Failed to save plan"})}},Ze=k=>{I(k),M(!0)},ct=async()=>{if(O)try{await ps.deleteSubscriptionPlan(O.id),Ne({title:"Success",description:"Plan deleted successfully"}),await Ve(),M(!1),I(null)}catch(k){console.error("Error deleting plan:",k),Ne({variant:"destructive",title:"Error",description:"Failed to delete plan"})}},ne=k=>{console.log(" handleExtendSubscription called with contractor:",k),L(k),Z(30),T(k.profiles?.subscription_plan_id||""),x("extend"),$(!0),console.log(" Dialog should now be open, showExtendDialog:",!0)},fe=async()=>{if(console.log(" confirmExtendSubscription called"),console.log(" contractorToExtend:",_),console.log(" extendDays:",Y),console.log(" extendMode:",H),console.log(" selectedPlanId:",C),!_){console.error(" No contractor selected for extension"),Ne({variant:"destructive",title:"Error",description:"No contractor selected for extension"});return}if(H==="change"&&!C){console.error(" No plan selected for change"),Ne({variant:"destructive",title:"Error",description:"Please select a plan to change to"});return}console.log(" Processing subscription for contractor:",{contractorId:_.id,userId:_.user_id,companyName:_.company_name,extendDays:Y,extendMode:H,selectedPlanId:C});try{if(H==="extend"){console.log(" Calling SubscriptionAPI.extendSubscription..."),await ps.extendSubscription(_.user_id,Y),console.log(" SubscriptionAPI.extendSubscription successful");const k=new Date,be=new Date(k.getTime()+Y*24*60*60*1e3);s(ie=>ie.map(ue=>ue.user_id===_.user_id?{...ue,profiles:{...ue.profiles,subscription_start_date:k.toISOString(),subscription_end_date:be.toISOString(),subscription_status:"active"}}:ue)),Ne({title:"Success",description:`Subscription extended for ${Y} days. Start date reset to current time.`})}else{console.log(" Calling SubscriptionAPI.assignSubscription for plan change..."),await ps.assignSubscription(_.user_id,C,Y),console.log(" SubscriptionAPI.assignSubscription successful");const k=new Date,be=new Date(k.getTime()+Y*24*60*60*1e3);s(ie=>ie.map(ue=>ue.user_id===_.user_id?{...ue,profiles:{...ue.profiles,subscription_plan_id:C,subscription_start_date:k.toISOString(),subscription_end_date:be.toISOString(),subscription_status:"active"}}:ue)),Ne({title:"Success",description:`Subscription plan changed and extended for ${Y} days.`})}$(!1),L(null),T(""),x("extend"),console.log(" Waiting for database update..."),setTimeout(async()=>{console.log(" Refreshing data after subscription update..."),await Ve(!0)},1e3)}catch(k){console.error(" Error processing subscription:",k),console.error(" Error details:",{message:k.message,code:k.code,details:k.details,hint:k.hint}),Ne({variant:"destructive",title:"Error",description:k.message||"Failed to process subscription"})}},xe=se.filter(k=>{if(!k.profiles?.subscription_end_date)return!1;const be=new Date(k.profiles.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return k.profiles?.subscription_status==="active"&&ue>0}),Re=se.filter(k=>{if(!k.profiles?.subscription_end_date)return!1;const be=new Date(k.profiles.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return ue<=7&&ue>0}),qe=se.filter(k=>{if(!k.profiles?.subscription_end_date)return!1;const be=new Date(k.profiles.subscription_end_date),ie=new Date,ue=Math.ceil((be.getTime()-ie.getTime())/(1e3*60*60*24));return k.profiles?.subscription_status==="expired"||ue<=0}),Ue=se.reduce((k,be)=>{const ie=be.profiles?.subscription_plan_id&&o.find(ue=>ue.id===be.profiles.subscription_plan_id)?.price||0;return k+ie},0),[xt,Qt]=l.useState({todayAssignments:0,todayRevenue:0,last7DaysRevenue:0,lastMonthRevenue:0});l.useEffect(()=>{if(se.length>0&&o.length>0){console.log(" Calculating financial data from current subscriptions...");const k=new Date,be=new Date(k.getFullYear(),k.getMonth(),k.getDate()),ie=se.filter(it=>new Date(it.profiles?.subscription_start_date||"")>=be).length,ue=se.reduce((it,dt)=>{if(new Date(dt.profiles?.subscription_start_date||"")>=be){const Nt=dt.profiles?.subscription_plan_id&&o.find(_t=>_t.id===dt.profiles.subscription_plan_id)?.price||0;return it+Nt}return it},0),We={todayAssignments:ie,todayRevenue:ue,last7DaysRevenue:ue*2,lastMonthRevenue:ue*4};console.log(" Calculated financial data:",We),Qt(We)}},[se,o]);const{todayAssignments:ys,todayRevenue:Va,last7DaysRevenue:Ua,lastMonthRevenue:za}=xt,Os=async(k,be=1,ie)=>{try{X(!0);const ue=ie||Ae;console.log(" Fetching subscription history for contractor:",k,"page:",be,"pageSize:",ue);const We=await sb.getContractorSubscriptionHistory(k);console.log(" Subscription history received:",We);const it=We.length,dt=Math.ceil(it/ue),Ft=(be-1)*ue,Nt=Ft+ue,_t=We.slice(Ft,Nt);console.log(" Pagination calculation:",{totalItems:it,currentPageSize:ue,totalPages:dt,startIndex:Ft,endIndex:Nt,paginatedHistoryLength:_t.length}),q(_t),K(dt),oe(be),ie&&Ce(ie),de(r.find(Jt=>Jt.user_id===k)),z(!0)}catch(ue){console.error(" Error fetching subscription history:",ue),Ne({variant:"destructive",title:"Error",description:"Failed to fetch subscription history"})}finally{X(!1)}};return console.log(" Subscription Counts Debug:",{totalContractors:r.length,contractorsWithSubscriptions:se.length,activeSubscriptions:xe.length,expiringSubscriptions:Re.length,expiredSubscriptions:qe.length,breakdown:{active:xe.map(k=>({id:k.id,company:k.company_name,status:k.profiles?.subscription_status,daysRemaining:W(k.profiles)})),expiring:Re.map(k=>({id:k.id,company:k.company_name,status:k.profiles?.subscription_status,daysRemaining:W(k.profiles)})),expired:qe.map(k=>({id:k.id,company:k.company_name,status:k.profiles?.subscription_status,daysRemaining:W(k.profiles)}))}}),c?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading subscription data..."})]})}):e.jsx(Uc,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(Pe,{title:"Total Contractors",value:r.length.toString(),description:"Registered contractors",icon:Wt,variant:"info"}),e.jsx(Pe,{title:"Active Subscriptions",value:xe.length.toString(),description:"Currently active",icon:Rt,variant:"success"}),e.jsx(Pe,{title:"Expiring Soon",value:Re.length.toString(),description:"Next 7 days",icon:sa,variant:"warning"}),e.jsx(Pe,{title:"Expired Subscriptions",value:qe.length.toString(),description:"Need renewal",icon:Ds,variant:"danger"}),e.jsx(Pe,{title:"Available Plans",value:o.length.toString(),description:"Subscription plans",icon:wa,variant:"default"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(Pe,{title:"Total Plan Value",value:`${Ue}`,description:"All active plans",icon:wa,variant:"success"}),e.jsx(Pe,{title:"Today's Assignments",value:ys.toString(),description:"Plans assigned today",icon:sn,variant:"info"}),e.jsx(Pe,{title:"Today's Revenue",value:`${Va}`,description:"Revenue today",icon:wa,variant:"success"}),e.jsx(Pe,{title:"Last 7 Days",value:`${Ua}`,description:"Weekly revenue",icon:Us,variant:"warning"}),e.jsx(Pe,{title:"Last Month",value:`${za}`,description:"Monthly revenue",icon:Ps,variant:"info"})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Be,{children:"Available Subscription Plans"}),e.jsx(et,{children:"Current subscription plans available for assignment"})]}),e.jsxs(F,{onClick:ve,size:"sm",children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Add Plan"]})]})}),e.jsx(Ee,{children:o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(wa,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No subscription plans found"}),e.jsx("p",{className:"text-muted-foreground",children:"Please check if the database migration has been applied"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:o.map(k=>e.jsxs(_e,{className:"p-4 relative group hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-semibold",children:k.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-2xl font-bold",children:["",k.price]}),e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx(F,{size:"sm",variant:"outline",onClick:()=>re(k),className:"h-7 w-7 p-0 border-blue-300 text-blue-600 hover:bg-blue-50 hover:border-blue-400",title:"Edit Plan",children:e.jsx(ha,{className:"h-3.5 w-3.5"})}),e.jsx(F,{size:"sm",variant:"outline",onClick:()=>Ze(k),className:"h-7 w-7 p-0 border-red-300 text-red-600 hover:bg-red-50 hover:border-red-400",title:"Delete Plan",children:e.jsx(As,{className:"h-3.5 w-3.5"})})]})]})]}),e.jsx("div",{className:"space-y-2 text-sm text-muted-foreground",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"h-4 w-4"}),k.days||k.duration_days||30," days"]})})]},k.id))})})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Be,{children:"Contractor Subscriptions"}),e.jsx(et,{children:"All contractor subscription details and status"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{value:u,onChange:k=>{p(1),h(k.target.value)},placeholder:"Search contractors...",className:"h-9 w-56 rounded-md border px-3 text-sm"}),e.jsxs("select",{value:f,onChange:k=>{p(1),v(Number(k.target.value))},className:"h-9 rounded-md border px-2 text-sm",children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]}),e.jsxs(F,{onClick:a,children:[e.jsx(wa,{className:"h-4 w-4 mr-2"}),"Assign Subscription"]})]})]})}),e.jsx(Ee,{children:se.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Wt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No contractor subscriptions found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No contractors have active subscriptions yet"}),e.jsxs(F,{onClick:a,children:[e.jsx(wa,{className:"h-4 w-4 mr-2"}),"Assign First Subscription"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Hr,{children:[e.jsx(qr,{children:e.jsxs(Bs,{children:[e.jsx(tt,{children:"Contractor"}),e.jsx(tt,{children:"Current Plan"}),e.jsx(tt,{children:"Status"}),e.jsx(tt,{children:"Expires"}),e.jsx(tt,{children:"Days Left"}),e.jsx(tt,{children:"Actions"})]})}),e.jsx(Wr,{children:se.map(k=>(console.log(" Contractor data:",{companyName:k.company_name,subscriptionStatus:k.profiles?.subscription_status,subscriptionEndDate:k.profiles?.subscription_end_date,daysRemaining:R(k.profiles),shouldShowExtend:me(k.profiles)||k.profiles?.subscription_status==="expired"}),e.jsxs(Bs,{children:[e.jsx(st,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:k.company_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:k.profiles?.user_name||k.profiles?.email})]})}),e.jsx(st,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:k.profiles?.subscription_plans?.name||"Unknown Plan"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["",k.profiles?.subscription_plans?.price||0,"/month"]})]})}),e.jsx(st,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[j(k.profiles),Ge(k.profiles)]})}),e.jsx(st,{children:k.profiles?.subscription_end_date?zt(k.profiles.subscription_end_date):"N/A"}),e.jsx(st,{children:e.jsx("span",{className:R(k.profiles).includes("Expired")||R(k.profiles).includes("7 days")||R(k.profiles).includes("6 days")||R(k.profiles).includes("5 days")||R(k.profiles).includes("4 days")||R(k.profiles).includes("3 days")||R(k.profiles).includes("2 days")||R(k.profiles).includes("1 days")?"text-red-500 font-medium":"",children:R(k.profiles)})}),e.jsx(st,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>{oe(1),Ce(5),Os(k.user_id,1)},disabled:D,children:D?"Loading...":"History"}),(()=>{const be=W(k.profiles),ie=be<=0,ue=me(k.profiles),We=k.profiles?.subscription_plan_id;return console.log(" Button rendering for contractor:",{companyName:k.company_name,daysRemaining:be,isExpired:ie,isExpiring:ue,hasSubscription:We,subscriptionStatus:k.profiles?.subscription_status}),We?e.jsxs(Up,{children:[e.jsx(zp,{asChild:!0,children:e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>ne(k),className:"text-blue-600 border-blue-300 hover:bg-blue-100 hover:border-blue-500 hover:text-blue-700",children:[e.jsx(sn,{className:"h-4 w-4 mr-1"}),ie?"Renew":"Extend"]})}),e.jsx(zc,{children:e.jsxs("p",{children:[ie?"Renew expired subscription for":"Extend subscription for"," ",k.company_name]})})]}):null})()]})})]},k.id)))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",m," of ",y]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"outline",size:"sm",disabled:m<=1,onClick:()=>p(k=>Math.max(1,k-1)),children:"Prev"}),e.jsx(F,{variant:"outline",size:"sm",disabled:m>=y,onClick:()=>p(k=>Math.min(y,k+1)),children:"Next"})]})]})]})})]}),e.jsx(bt,{open:b,onOpenChange:A,children:e.jsxs(yt,{children:[e.jsxs(wt,{children:[e.jsx(jt,{children:"Edit Subscription Plan"}),e.jsx(At,{children:"Update the details of this subscription plan"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"plan-name",children:"Plan Name"}),e.jsx(ge,{id:"plan-name",value:ee.name,onChange:k=>G(be=>({...be,name:k.target.value})),placeholder:"Enter plan name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"plan-price",children:"Price ()"}),e.jsx(ge,{id:"plan-price",type:"number",value:ee.price,onChange:k=>G(be=>({...be,price:Number(k.target.value)})),placeholder:"Enter price"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"plan-days",children:"Days"}),e.jsx(ge,{id:"plan-days",type:"number",value:ee.days,onChange:k=>G(be=>({...be,days:Number(k.target.value)})),placeholder:"Enter number of days",min:"1"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Number of days the subscription plan will be valid for when assigned"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(F,{variant:"outline",onClick:()=>A(!1),children:"Cancel"}),e.jsxs(F,{onClick:Te,children:[e.jsx(ai,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})]})}),e.jsx(bt,{open:P,onOpenChange:E,children:e.jsxs(yt,{children:[e.jsxs(wt,{children:[e.jsx(jt,{children:"Create New Subscription Plan"}),e.jsx(At,{children:"Add a new subscription plan to the system"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"new-plan-name",children:"Plan Name"}),e.jsx(ge,{id:"new-plan-name",value:ee.name,onChange:k=>G(be=>({...be,name:k.target.value})),placeholder:"Enter plan name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"new-plan-price",children:"Price ()"}),e.jsx(ge,{id:"new-plan-price",type:"number",value:ee.price,onChange:k=>G(be=>({...be,price:Number(k.target.value)})),placeholder:"Enter price"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"new-plan-days",children:"Days"}),e.jsx(ge,{id:"new-plan-days",type:"number",value:ee.days,onChange:k=>G(be=>({...be,days:Number(k.target.value)})),placeholder:"Enter number of days",min:"1"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Number of days the subscription plan will be valid for when assigned"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(F,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsxs(F,{onClick:Te,children:[e.jsx(da,{className:"h-4 w-4 mr-2"}),"Create Plan"]})]})]})]})}),e.jsx(Cn,{open:V,onOpenChange:M,children:e.jsxs(Dr,{children:[e.jsxs(Ir,{children:[e.jsxs(Lr,{className:"flex items-center gap-2",children:[e.jsx(As,{className:"h-5 w-5 text-red-600"}),"Delete Subscription Plan"]}),e.jsxs(Mr,{className:"text-base",children:["Are you sure you want to delete the ",e.jsxs("strong",{children:['"',O?.name,'"']})," plan?",e.jsx("br",{}),e.jsx("br",{}),"This action cannot be undone. The plan will be permanently removed from the system.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("span",{className:"text-red-600 font-medium",children:" This may affect contractors who are currently using this plan."})]})]}),e.jsxs(Or,{children:[e.jsx($r,{onClick:()=>M(!1),children:"Cancel"}),e.jsxs(Fr,{onClick:ct,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:[e.jsx(As,{className:"h-4 w-4 mr-2"}),"Delete Plan"]})]})]})}),e.jsx(bt,{open:ae,onOpenChange:k=>{console.log(" Dialog onOpenChange called with:",k),$(k)},children:e.jsxs(yt,{children:[console.log(" Dialog rendering with state:",{showExtendDialog:ae,contractorToExtend:!!_,extendDays:Y,buttonDisabled:!_||Y<=0}),e.jsxs(wt,{children:[e.jsxs(jt,{className:"flex items-center gap-2",children:[e.jsx(sn,{className:"h-5 w-5 text-blue-600"}),H==="extend"?"Extend Subscription":"Change Plan & Extend"]}),e.jsx(At,{children:H==="extend"?`Extend the subscription for ${_?.company_name||"this contractor"}`:`Change plan and extend subscription for ${_?.company_name||"this contractor"}`})]}),e.jsxs("div",{className:"space-y-4",children:[_&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"Contractor Details"}),e.jsx("div",{className:"font-medium",children:_.company_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:_.profiles?.user_name||_.profiles?.email}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:["Current Plan: ",_.profiles?.subscription_plans?.name||"Unknown Plan"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Expires: ",_.profiles?.subscription_end_date?zt(_.profiles.subscription_end_date):"N/A"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Days Remaining: ",R(_.profiles)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{children:"Action Type"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"extendMode",value:"extend",checked:H==="extend",onChange:k=>x(k.target.value),className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Extend Current Plan"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"extendMode",value:"change",checked:H==="change",onChange:k=>x(k.target.value),className:"text-blue-600"}),e.jsx("span",{className:"text-sm",children:"Change Plan & Extend"})]})]})]}),H==="change"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"plan-select",children:"Select New Plan"}),e.jsxs(Lt,{value:C,onValueChange:k=>{T(k);const be=o.find(ie=>ie.id===k);if(be){const ie=be.days||be.duration_days||30;Z(ie)}},children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Choose a subscription plan"})}),e.jsx(Pt,{children:o.map(k=>e.jsxs($e,{value:k.id,children:[k.name," - ",k.price," (",k.days||k.duration_days||30," days)"]},k.id))})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Select the new plan to assign to this contractor. Duration will be automatically set from the plan."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"extend-days",children:"Extension Period (Days)"}),e.jsx(ge,{id:"extend-days",type:"number",value:Y,onChange:k=>Z(Number(k.target.value)),min:"1",max:"365",placeholder:"Enter number of days to extend"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:H==="extend"?"The subscription will be extended from the current end date":"The new plan will be assigned and extended for the specified days"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(F,{variant:"outline",onClick:()=>$(!1),children:"Cancel"}),e.jsxs(F,{onClick:()=>{console.log(" Extend Subscription button clicked"),console.log(" Button state check:",{contractorToExtend:!!_,extendDays:Y,extendMode:H,selectedPlanId:C,isDisabled:!_||Y<=0||H==="change"&&!C}),fe()},disabled:!_||Y<=0||H==="change"&&!C,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(sn,{className:"h-4 w-4 mr-2"}),H==="extend"?"Extend Subscription":"Change Plan & Extend"]})]})]})]})}),e.jsx(bt,{open:Q,onOpenChange:z,children:e.jsxs(yt,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(wt,{children:[e.jsx(jt,{children:"Subscription History"}),e.jsxs(At,{children:["Complete subscription timeline for ",U?.company_name]})]}),D?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("span",{className:"ml-2",children:"Loading history..."})]}):S.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No subscription history found for this contractor."}):e.jsxs("div",{className:"space-y-4",children:[S.map((k,be)=>e.jsx(_e,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Je,{variant:k.action==="assigned"?"default":k.action==="extended"?"secondary":k.action==="cancelled"?"destructive":"outline",children:k.action.charAt(0).toUpperCase()+k.action.slice(1)}),e.jsx("span",{className:"font-medium",children:k.plan_name}),k.previous_plan_name&&e.jsxs("span",{className:"text-muted-foreground",children:["(from ",k.previous_plan_name,")"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Start Date"}),e.jsx("div",{children:zt(k.new_start_date)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"End Date"}),e.jsx("div",{children:zt(k.new_end_date)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Duration"}),e.jsxs("div",{children:[k.duration_days," days"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-muted-foreground",children:"Amount Paid"}),e.jsxs("div",{className:"font-semibold text-green-600",children:["",k.amount_paid]})]})]})]}),e.jsx("div",{className:"text-right text-sm text-muted-foreground",children:e.jsx("div",{children:zt(k.created_on)})})]})},k.id)),Ie>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",B," of ",Ie]}),e.jsxs("select",{value:Ae,onChange:k=>{const be=Number(k.target.value);console.log(" Page size changed to:",be),Os(U?.user_id,1,be)},className:"px-2 py-1 text-sm border rounded",children:[e.jsx("option",{value:5,children:"5 per page"}),e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:20,children:"20 per page"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>Os(U?.user_id,B-1,Ae),disabled:B<=1,children:"Previous"}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,Ie)},(k,be)=>{const ie=Math.max(1,Math.min(Ie-4,B-2))+be;return ie>Ie?null:e.jsx(F,{variant:ie===B?"default":"outline",size:"sm",onClick:()=>Os(U?.user_id,ie,Ae),className:"w-8 h-8 p-0",children:ie},ie)})}),e.jsx(F,{variant:"outline",size:"sm",onClick:()=>Os(U?.user_id,B+1,Ae),disabled:B>=Ie,children:"Next"})]})]})]})]})})]})})}function rb(){const[a,t]=l.useState([]),[s,r]=l.useState([]),[n,o]=l.useState([]),[i,c]=l.useState([]),[d,u]=l.useState(!0),[h,m]=l.useState(""),[p,f]=l.useState(""),[v,y]=l.useState(30),[w,N]=l.useState(!1);l.useState(!1),l.useState(30);const{toast:g}=Tt(),b=s.map(E=>({value:E.user_id,label:`${E.company_name} - ${E.profiles?.user_name||E.profiles?.email}`,searchableText:`${E.company_name} ${E.profiles?.user_name||""} ${E.profiles?.email||""}`.toLowerCase()}));l.useEffect(()=>{A()},[]);const A=async()=>{try{u(!0),console.log("Fetching subscription data...");let E=[],V=[],M=[],O=[];try{console.log("Fetching subscription plans..."),E=await ps.getSubscriptionPlans(),console.log("Plans data received:",E),console.log("Plans count:",E?.length||0)}catch(I){console.error("Error fetching plans:",I),console.error("Error details:",I.message),console.error("Error code:",I.code),g({variant:"destructive",title:"Error",description:`Failed to fetch subscription plans: ${I.message}`})}try{V=await kt.getAllContractors(),console.log("Contractors data:",V)}catch(I){console.error("Error fetching contractors:",I),g({variant:"destructive",title:"Error",description:"Failed to fetch contractors"})}try{M=await ps.getExpiringSubscriptions(7),console.log("Expiring data:",M)}catch(I){console.error("Error fetching expiring subscriptions:",I)}try{O=await ps.getExpiredSubscriptions(),console.log("Expired data:",O)}catch(I){console.error("Error fetching expired subscriptions:",I)}t(E),r(V),o(M),c(O)}catch(E){console.error("Error fetching subscription data:",E),g({variant:"destructive",title:"Error",description:"Failed to fetch subscription data"})}finally{u(!1)}},P=async()=>{if(!h||!p){g({variant:"destructive",title:"Error",description:"Please select contractor and plan"});return}console.log(" UI Assignment starting..."),console.log("  selectedContractor:",h),console.log("  selectedPlan:",p),console.log("  durationDays:",v);try{await ps.assignSubscription(h,p,v),console.log(" UI Assignment successful"),g({title:"Success",description:"Subscription assigned successfully"}),N(!1),A()}catch(E){console.error(" UI Assignment failed:",E),g({variant:"destructive",title:"Error",description:E.message||"Failed to assign subscription"})}};return d?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(bt,{open:w,onOpenChange:N,children:e.jsxs(yt,{children:[e.jsxs(wt,{children:[e.jsx(jt,{children:"Assign Subscription"}),e.jsx(At,{children:"Assign a subscription plan to a contractor"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(te,{htmlFor:"contractor",children:"Select Contractor"}),e.jsx(tb,{options:b,value:h,onValueChange:m,placeholder:"Search and select a contractor...",emptyText:"No contractors found"})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"plan",children:"Subscription Plan"}),e.jsxs(Lt,{value:p,onValueChange:E=>{f(E);const V=a.find(M=>M.id===E);if(V){const M=V.days||V.duration_days||30;y(M)}},children:[e.jsx(Ct,{children:e.jsx(Mt,{placeholder:"Select a plan"})}),e.jsx(Pt,{children:a.map(E=>e.jsxs($e,{value:E.id,children:[E.name," - ",E.price," (",E.days||E.duration_days||30," days)"]},E.id))})]})]}),e.jsxs("div",{children:[e.jsx(te,{htmlFor:"duration",children:"Duration (Days)"}),e.jsx(ge,{id:"duration",type:"number",value:v,onChange:E=>y(Number(E.target.value)),min:"1"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Duration will be automatically set from the selected plan. You can modify it if needed."})]}),e.jsx(F,{onClick:P,className:"w-full",children:"Assign Subscription"})]})]})}),e.jsx(ab,{onAssignSubscription:()=>N(!0)})]})}function nb(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure system preferences and options"})]}),e.jsxs(F,{children:[e.jsx(ai,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Pe,{title:"Profile Status",value:"Active",description:"Account configured",icon:Sr,variant:"success"}),e.jsx(Pe,{title:"Notifications",value:"3",description:"Active channels",icon:vo,variant:"info"}),e.jsx(Pe,{title:"Security Level",value:"High",description:"2FA enabled",icon:na,variant:"success"}),e.jsx(Pe,{title:"Data Backup",value:"Enabled",description:"Auto backup active",icon:Ui,variant:"success"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(Sr,{className:"h-5 w-5 mr-2"}),"Profile Settings"]}),e.jsx(et,{children:"Manage your account and profile information"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Update personal details"}),e.jsx(F,{variant:"outline",className:"w-full",children:"Edit Profile"})]})})]}),e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(vo,{className:"h-5 w-5 mr-2"}),"Notifications"]}),e.jsx(et,{children:"Configure notification preferences"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage alerts and emails"}),e.jsx(F,{variant:"outline",className:"w-full",children:"Configure"})]})})]}),e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(na,{className:"h-5 w-5 mr-2"}),"Security"]}),e.jsx(et,{children:"Security settings and access controls"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Password and permissions"}),e.jsx(F,{variant:"outline",className:"w-full",children:"Security"})]})})]}),e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(Ui,{className:"h-5 w-5 mr-2"}),"System"]}),e.jsx(et,{children:"System configuration and maintenance"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Database and backups"}),e.jsx(F,{variant:"outline",className:"w-full",children:"System"})]})})]})]}),e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"General Settings"}),e.jsx(et,{children:"Basic system configuration options"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive email alerts for important events"})]}),e.jsx(F,{variant:"outline",size:"sm",children:"Enable"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Auto Backup"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically backup data daily"})]}),e.jsx(F,{variant:"outline",size:"sm",children:"Enable"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Maintenance Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Temporarily disable system access"})]}),e.jsx(F,{variant:"outline",size:"sm",children:"Disable"})]})]})})]})]})}var ob="Separator",Vl="horizontal",ib=["horizontal","vertical"],Xh=l.forwardRef((a,t)=>{const{decorative:s,orientation:r=Vl,...n}=a,o=lb(r)?r:Vl,c=s?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(De.div,{"data-orientation":o,...c,...n,ref:t})});Xh.displayName=ob;function lb(a){return ib.includes(a)}var em=Xh;const tm=l.forwardRef(({className:a,orientation:t="horizontal",decorative:s=!0,...r},n)=>e.jsx(em,{ref:n,decorative:s,orientation:t,className:ce("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",a),...r}));tm.displayName=em.displayName;function cb(){const{profile:a,user:t,updateProfile:s}=ft(),{toast:r}=Tt(),[n,o]=l.useState(!1),[i,c]=l.useState(!1),[d,u]=l.useState({user_name:"",email:"",phone_number:"",contractor_name:"",attendant_name:""});l.useEffect(()=>{a&&u({user_name:a.user_name||"",email:a.email||"",phone_number:a.phone_number||"",contractor_name:a.contractor_name||"",attendant_name:a.attendant_name||""})},[a]);const h=async()=>{try{if(c(!0),!t?.id)throw new Error("User not authenticated");if(!d.user_name.trim())throw new Error("Name is required");if(!d.email.trim())throw new Error("Email is required");const v={user_name:d.user_name.trim(),phone_number:d.phone_number.trim()};a?.role==="contractor"?v.contractor_name=d.contractor_name:a?.role==="attendant"&&(v.attendant_name=d.attendant_name);const y=await s(v);if(y.success)o(!1);else throw new Error(y.error?.message||"Failed to update profile")}catch(v){console.error("Profile update error:",v),r({variant:"destructive",title:"Error",description:v?.message||"Failed to update profile. Please try again."})}finally{c(!1)}},m=()=>{u({user_name:a?.user_name||"",email:a?.email||"",phone_number:a?.phone_number||"",contractor_name:a?.contractor_name||"",attendant_name:a?.attendant_name||""}),o(!1)},p=v=>{switch(v){case"super_admin":return"bg-red-100 text-red-800";case"contractor":return"bg-blue-100 text-blue-800";case"attendant":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},f=v=>{switch(v){case"super_admin":return"Super Admin";case"contractor":return"Contractor";case"attendant":return"Attendant";default:return v}};return a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account information and preferences"})]}),e.jsx("div",{className:"flex space-x-2",children:n?e.jsxs(e.Fragment,{children:[e.jsxs(F,{onClick:h,disabled:i,children:[e.jsx(ai,{className:"h-4 w-4 mr-2"}),i?"Saving...":"Save Changes"]}),e.jsxs(F,{variant:"outline",onClick:m,children:[e.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(F,{onClick:()=>o(!0),children:[e.jsx(ha,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Pe,{title:"Account Status",value:"Active",description:"Account is active",icon:na,variant:"success"}),e.jsx(Pe,{title:"Role",value:f(a.role),description:"User permissions",icon:Sr,variant:"info"}),e.jsx(Pe,{title:"Member Since",value:zt(t?.created_at||""),description:"Account creation date",icon:Ps,variant:"default"}),e.jsx(Pe,{title:"Last Login",value:"Today",description:"Most recent activity",icon:Ps,variant:"success"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center",children:[e.jsx(Sr,{className:"h-5 w-5 mr-2"}),"Personal Information"]}),e.jsx(et,{children:"Update your personal details and contact information"})]}),e.jsxs(Ee,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(mi,{className:"h-20 w-20",children:[e.jsx(pi,{src:"",alt:a.user_name}),e.jsx(fi,{className:"bg-parkflow-blue text-white text-lg",children:a.user_name.charAt(0).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:a.user_name}),e.jsx("p",{className:"text-muted-foreground",children:a.email}),e.jsx(Je,{className:`${p(a.role)} mt-2`,children:f(a.role)})]})]}),e.jsx(tm,{}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"user_name",children:"Full Name"}),e.jsx(ge,{id:"user_name",value:d.user_name,onChange:v=>u({...d,user_name:v.target.value}),disabled:!n})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"email",children:"Email Address"}),e.jsx(ge,{id:"email",type:"email",value:d.email,onChange:v=>u({...d,email:v.target.value}),disabled:!n})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"phone_number",children:"Phone Number"}),e.jsx(ge,{id:"phone_number",value:d.phone_number,onChange:v=>u({...d,phone_number:v.target.value}),disabled:!n})]}),a.role==="contractor"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"contractor_name",children:"Company Name"}),e.jsx(ge,{id:"contractor_name",value:d.contractor_name,onChange:v=>u({...d,contractor_name:v.target.value}),disabled:!n})]}),a.role==="attendant"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"attendant_name",children:"Attendant Name"}),e.jsx(ge,{id:"attendant_name",value:d.attendant_name,onChange:v=>u({...d,attendant_name:v.target.value}),disabled:!n})]})]})]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs(Be,{className:"flex items-center",children:[e.jsx(na,{className:"h-5 w-5 mr-2"}),"Account Details"]})}),e.jsxs(Ee,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"User ID"}),e.jsxs("span",{className:"text-sm text-muted-foreground font-mono",children:[t?.id?.slice(0,8),"..."]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Status"}),e.jsx(Je,{className:"bg-green-100 text-green-800",children:a.status||"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Role"}),e.jsx(Je,{className:p(a.role),children:f(a.role)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"First Login"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:a.is_first_login?"Yes":"No"})]})]})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs(Be,{className:"flex items-center",children:[e.jsx(Ps,{className:"h-5 w-5 mr-2"}),"Activity Summary"]})}),e.jsxs(Ee,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Account Created"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:zt(t?.created_at||"")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Last Updated"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:zt(new Date)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Login Count"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"-"})]})]})]})]})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})})}function db(){const{profile:a,user:t}=ft(),{toast:s}=Tt(),r=l.useRef(null),n=l.useRef(null),[o,i]=l.useState(!1),[c,d]=l.useState(null),[u,h]=l.useState(!1),[m,p]=l.useState(""),[f,v]=l.useState(!1),[y,w]=l.useState(null),[N,g]=l.useState(!1);if(a?.role!=="attendant")return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"Only attendants can access the QR Scanner."})]});l.useEffect(()=>{a?.role==="attendant"&&a?.id&&Bn(a.id).then(O=>{console.log("Subscription status for attendant (QRScanner):",O),(O.isExpired||O.isSuspended)&&(g(!0),s({variant:"destructive",title:"Access Blocked",description:"Your contractor's subscription has expired. Please contact your contractor to recharge."}))}).catch(O=>{console.error("Error checking subscription status (QRScanner):",O)})},[a,s]);const b=async()=>{try{const O=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});w(O),r.current&&(r.current.srcObject=O,i(!0))}catch(O){console.error("Error accessing camera:",O),s({variant:"destructive",title:"Camera Error",description:"Unable to access camera. Please check permissions."})}},A=()=>{y&&(y.getTracks().forEach(O=>O.stop()),w(null)),i(!1)},P=O=>{try{const I=JSON.parse(O);d(I),h(!0),A()}catch(I){console.error("Error parsing QR code:",I),s({variant:"destructive",title:"Invalid QR Code",description:"The scanned QR code is not valid."})}},E=async()=>{if(!m.trim()){s({variant:"destructive",title:"Invalid Input",description:"Please enter a valid QR code data."});return}P(m)},V=async()=>{if(!(!c||!t?.id)){v(!0);try{if(c.type==="vehicle_entry"){const O={plate_number:c.plate_number,vehicle_type:c.vehicle_type,location_id:c.location_id,contractor_id:""};await Gt.checkInVehicle(O),s({title:"Vehicle Checked In",description:`Vehicle ${c.plate_number} has been checked in successfully.`})}else if(c.type==="vehicle_exit"){const O={check_out_time:new Date().toISOString(),payment_amount:0,payment_method:"cash"};await Gt.checkoutVehicle(c.vehicle_id,O),s({title:"Vehicle Checked Out",description:"Vehicle has been checked out successfully."})}h(!1),d(null)}catch(O){console.error("Error processing vehicle action:",O),s({variant:"destructive",title:"Action Failed",description:O.message||"Failed to process vehicle action."})}finally{v(!1)}}},M=()=>{h(!1),d(null),p("")};return l.useEffect(()=>()=>{A()},[]),N?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"mx-auto max-w-md",children:[e.jsx("div",{className:"rounded-full bg-red-100 p-3 mx-auto w-16 h-16 flex items-center justify-center mb-4",children:e.jsx(Na,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Access Blocked"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your contractor's subscription has expired. Please contact your contractor to recharge."}),e.jsx(F,{variant:"outline",onClick:()=>window.location.reload(),className:"mt-4",children:"Refresh Page"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"QR Scanner"}),e.jsx("p",{className:"text-muted-foreground",children:"Scan vehicle QR codes for check-in and check-out"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center space-x-2",children:[e.jsx(ra,{className:"h-5 w-5"}),e.jsx("span",{children:"Camera Scanner"})]}),e.jsx(et,{children:"Use your device camera to scan QR codes"})]}),e.jsx(Ee,{className:"space-y-4",children:o?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,className:"w-full h-64 bg-black rounded-lg"}),e.jsx("canvas",{ref:n,className:"hidden"})]}),e.jsxs(F,{onClick:A,variant:"outline",className:"w-full",children:[e.jsx(Na,{className:"h-4 w-4 mr-2"}),"Stop Camera"]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(wo,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Click to start camera scanning"}),e.jsxs(F,{onClick:b,className:"w-full",children:[e.jsx(ra,{className:"h-4 w-4 mr-2"}),"Start Camera"]})]})})]}),e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center space-x-2",children:[e.jsx(wo,{className:"h-5 w-5"}),e.jsx("span",{children:"Manual Input"})]}),e.jsx(et,{children:"Enter QR code data manually if camera scanning is not available"})]}),e.jsxs(Ee,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"manual-qr",children:"QR Code Data"}),e.jsx(ge,{id:"manual-qr",placeholder:"Paste QR code data here...",value:m,onChange:O=>p(O.target.value)})]}),e.jsxs(F,{onClick:E,className:"w-full",disabled:!m.trim(),children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"Process QR Code"]})]})]})]}),e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"How to Use"}),e.jsx(et,{children:"Instructions for using the QR Scanner"})]}),e.jsx(Ee,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-semibold flex items-center space-x-2",children:[e.jsx(ot,{className:"h-4 w-4"}),e.jsx("span",{children:"Vehicle Check-In"})]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:" Scan QR code on vehicle entry"}),e.jsx("li",{children:" QR code should contain vehicle details"}),e.jsx("li",{children:" System will automatically check in the vehicle"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-semibold flex items-center space-x-2",children:[e.jsx(qs,{className:"h-4 w-4"}),e.jsx("span",{children:"Vehicle Check-Out"})]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsx("li",{children:" Scan QR code on vehicle exit"}),e.jsx("li",{children:" QR code should contain vehicle ID"}),e.jsx("li",{children:" System will calculate payment and check out"})]})]})]})})]}),e.jsx(bt,{open:u,onOpenChange:h,children:e.jsxs(yt,{className:"max-w-md",children:[e.jsxs(wt,{children:[e.jsxs(jt,{className:"flex items-center space-x-2",children:[c?.type==="vehicle_entry"?e.jsx(Rt,{className:"h-5 w-5 text-green-600"}):e.jsx(Na,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{children:c?.type==="vehicle_entry"?"Vehicle Check-In":"Vehicle Check-Out"})]}),e.jsx(At,{children:c?.type==="vehicle_entry"?"Confirm vehicle check-in details":"Confirm vehicle check-out details"})]}),c&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(te,{className:"text-sm font-medium",children:"Type"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c.type==="vehicle_entry"?"Check-In":"Check-Out"})]}),e.jsxs("div",{children:[e.jsx(te,{className:"text-sm font-medium",children:"Time"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ts(c.timestamp)})]})]}),c.plate_number&&e.jsxs("div",{children:[e.jsx(te,{className:"text-sm font-medium",children:"Plate Number"}),e.jsx("p",{className:"text-sm font-mono bg-muted p-2 rounded",children:c.plate_number})]}),c.vehicle_type&&e.jsxs("div",{children:[e.jsx(te,{className:"text-sm font-medium",children:"Vehicle Type"}),e.jsx(Je,{variant:"outline",children:c.vehicle_type})]}),e.jsxs("div",{className:"flex space-x-2 pt-4",children:[e.jsx(F,{onClick:V,className:"flex-1",disabled:f,children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[c.type==="vehicle_entry"?e.jsx(Rt,{className:"h-4 w-4 mr-2"}):e.jsx(Na,{className:"h-4 w-4 mr-2"}),c.type==="vehicle_entry"?"Check In":"Check Out"]})}),e.jsx(F,{onClick:M,variant:"outline",disabled:f,children:"Cancel"})]})]})]})})]})}class Ho{static async extractPlateNumber(t){try{const s=new FormData;s.append("upload",t);const r=await fetch(this.ANPR_API_URL,{method:"POST",body:s,headers:{Authorization:`Token ${this.ANPR_TOKEN}`}});if(!r.ok)throw new Error(`ANPR API Error: ${r.statusText}`);const n=await r.json();console.log("ANPR Response:",n);const o=n.results?.[0]?.plate||null;return o?{success:!0,plateNumber:o.toUpperCase()}:{success:!1,error:"Could not recognize plate number. Please try again with a clearer image."}}catch(s){return console.error("Plate recognition error:",s),{success:!1,error:s instanceof Error?s.message:"Failed to process image"}}}}bs(Ho,"ANPR_API_URL","https://api.platerecognizer.com/v1/plate-reader/"),bs(Ho,"ANPR_TOKEN","e3fff7794f03b9d53f1a7c0bf42f2ea740e6f6bd");function ub({isOpen:a,onClose:t,onPlateDetected:s}){const{toast:r}=Tt(),n=l.useRef(null),[o,i]=l.useState(null),[c,d]=l.useState(null),[u,h]=l.useState(!1),m=N=>{const g=N.target.files?.[0];if(g){if(!g.type.startsWith("image/")){r({variant:"destructive",title:"Invalid file type",description:"Please select an image file (JPG, PNG, etc.)"});return}if(g.size>10*1024*1024){r({variant:"destructive",title:"File too large",description:"Please select an image smaller than 10MB"});return}i(g);const b=new FileReader;b.onload=A=>{d(A.target?.result)},b.readAsDataURL(g)}},p=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){const I=document.createElement("input");I.type="file",I.accept="image/*",I.capture="environment",I.style.display="none",I.onchange=ee=>{const G=ee.target.files?.[0];G&&m({target:{files:[G]}})},document.body.appendChild(I),I.click(),document.body.removeChild(I);return}const N=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),g=document.createElement("video");g.style.position="fixed",g.style.top="0",g.style.left="0",g.style.width="100%",g.style.height="100%",g.style.objectFit="cover",g.style.zIndex="9999",g.style.backgroundColor="black",g.autoplay=!0,g.muted=!0,g.srcObject=N;const b=document.createElement("div");b.style.position="fixed",b.style.top="0",b.style.left="0",b.style.width="100%",b.style.height="100%",b.style.zIndex="10000",b.style.backgroundColor="transparent",b.style.display="flex",b.style.flexDirection="column",b.style.justifyContent="flex-end",b.style.alignItems="center",b.style.padding="20px",b.style.pointerEvents="none";const A=document.createElement("button");A.innerHTML=" Capture",A.style.padding="12px 24px",A.style.fontSize="16px",A.style.fontWeight="600",A.style.backgroundColor="#10b981",A.style.color="white",A.style.border="none",A.style.borderRadius="25px",A.style.cursor="pointer",A.style.marginBottom="15px",A.style.pointerEvents="auto",A.style.userSelect="none",A.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.4)",A.style.transition="all 0.2s ease";const P=document.createElement("button");P.innerHTML=" Cancel",P.style.padding="10px 20px",P.style.fontSize="14px",P.style.fontWeight="500",P.style.backgroundColor="rgba(0, 0, 0, 0.6)",P.style.color="white",P.style.border="2px solid rgba(255, 255, 255, 0.3)",P.style.borderRadius="20px",P.style.cursor="pointer",P.style.pointerEvents="auto",P.style.userSelect="none",P.style.backdropFilter="blur(10px)",P.style.transition="all 0.2s ease",A.addEventListener("mouseenter",()=>{A.style.transform="scale(1.05)",A.style.boxShadow="0 6px 16px rgba(16, 185, 129, 0.6)"}),A.addEventListener("mouseleave",()=>{A.style.transform="scale(1)",A.style.boxShadow="0 4px 12px rgba(16, 185, 129, 0.4)"}),P.addEventListener("mouseenter",()=>{P.style.transform="scale(1.05)",P.style.backgroundColor="rgba(0, 0, 0, 0.8)"}),P.addEventListener("mouseleave",()=>{P.style.transform="scale(1)",P.style.backgroundColor="rgba(0, 0, 0, 0.6)"}),b.appendChild(A),b.appendChild(P),document.body.appendChild(g),document.body.appendChild(b),g.addEventListener("loadedmetadata",()=>{console.log("Camera ready for capture")}),A.disabled=!0,A.style.opacity="0.5",g.addEventListener("canplay",()=>{setTimeout(()=>{A.disabled=!1,A.style.opacity="1",console.log("Capture button enabled")},500)}),setTimeout(()=>{A.disabled&&(A.disabled=!1,A.style.opacity="1",console.log("Capture button enabled (fallback)"))},3e3);const E=()=>{try{if(g.videoWidth===0||g.videoHeight===0){r({variant:"destructive",title:"Camera not ready",description:"Please wait for camera to initialize"});return}const I=document.createElement("canvas");I.width=g.videoWidth,I.height=g.videoHeight;const ee=I.getContext("2d");if(!ee)throw new Error("Canvas context not available");ee.drawImage(g,0,0),I.toBlob(G=>{if(G){const ae=new File([G],"camera-photo.jpg",{type:"image/jpeg"});m({target:{files:[ae]}}),r({title:"Photo Captured!",description:"Image captured successfully. You can now detect the plate number."})}else throw new Error("Failed to create image blob")},"image/jpeg",.8)}catch(I){console.error("Capture error:",I),r({variant:"destructive",title:"Capture failed",description:"Failed to capture photo. Please try again."})}finally{try{N.getTracks().forEach(I=>I.stop()),document.body.contains(g)&&document.body.removeChild(g),document.body.contains(b)&&document.body.removeChild(b)}catch(I){console.error("Cleanup error:",I)}}},V=()=>{try{N.getTracks().forEach(I=>I.stop()),document.body.contains(g)&&document.body.removeChild(g),document.body.contains(b)&&document.body.removeChild(b)}catch(I){console.error("Cancel error:",I)}},M=I=>{I.preventDefault(),I.stopPropagation(),I.stopImmediatePropagation(),console.log("Capture button clicked"),E()},O=I=>{I.preventDefault(),I.stopPropagation(),I.stopImmediatePropagation(),console.log("Cancel button clicked"),V()};A.removeEventListener("click",M),P.removeEventListener("click",O),A.addEventListener("click",M,{once:!1}),A.addEventListener("mousedown",M,{once:!1}),A.addEventListener("touchend",M,{once:!1}),P.addEventListener("click",O,{once:!1}),P.addEventListener("mousedown",O,{once:!1}),P.addEventListener("touchend",O,{once:!1})}catch(N){console.error("Camera access error:",N),r({variant:"destructive",title:"Camera Access Denied",description:"Please allow camera access or use 'Select Image' instead"});const g=document.createElement("input");g.type="file",g.accept="image/*",g.capture="environment",g.style.display="none",g.onchange=b=>{const A=b.target.files?.[0];A&&m({target:{files:[A]}})},document.body.appendChild(g),g.click(),document.body.removeChild(g)}},f=()=>{const N=document.createElement("input");N.type="file",N.accept="image/*",N.style.display="none",N.onchange=g=>{const b=g.target.files?.[0];b&&m({target:{files:[b]}})},document.body.appendChild(N),N.click(),document.body.removeChild(N)},v=()=>{i(null),d(null),n.current&&(n.current.value="")},y=async()=>{if(!o){r({variant:"destructive",title:"No image selected",description:"Please select an image of the vehicle"});return}h(!0);try{const N=await Ho.extractPlateNumber(o);if(N.success&&N.plateNumber)s(N.plateNumber),r({title:"Plate Number Detected!",description:`License plate "${N.plateNumber}" has been filled in the form. Please complete the check-in process.`}),w();else throw new Error(N.error||"Failed to detect plate number")}catch(N){console.error("Plate detection error:",N),r({variant:"destructive",title:"Detection failed",description:N instanceof Error?N.message:"Failed to detect license plate"})}finally{h(!1)}},w=()=>{i(null),d(null),h(!1),t()};return e.jsx(bt,{open:a,onOpenChange:w,children:e.jsxs(yt,{className:"max-w-2xl",children:[e.jsxs(wt,{children:[e.jsxs(jt,{className:"flex items-center space-x-2",children:[e.jsx(ra,{className:"h-5 w-5"}),e.jsx("span",{children:"Detect License Plate"})]}),e.jsx(At,{children:"Take or upload a photo of the vehicle to automatically extract the license plate number"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx(te,{children:"Vehicle Image *"}),c?e.jsx(_e,{children:e.jsxs(Ee,{className:"p-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c,alt:"Vehicle preview",className:"w-full h-64 object-cover rounded-lg"}),e.jsx(F,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:v,children:e.jsx(Ds,{className:"h-4 w-4"})})]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[o?.name," (",(o?.size/1024/1024).toFixed(2)," MB)"]})]})}):e.jsx(_e,{className:"border-2 border-dashed border-gray-300 hover:border-gray-400 transition-colors",children:e.jsxs(Ee,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(ra,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Take a photo or upload an image of the vehicle"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(F,{type:"button",variant:"outline",onClick:f,className:"flex-1",children:[e.jsx($m,{className:"h-4 w-4 mr-2"}),"Select Image"]}),e.jsxs(F,{type:"button",variant:"outline",onClick:p,className:"flex-1",children:[e.jsx(ra,{className:"h-4 w-4 mr-2"}),"Take Photo"]})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"JPG, PNG up to 10MB"})]})]})}),e.jsx(ge,{ref:n,type:"file",accept:"image/*",capture:"environment",onChange:m,className:"hidden"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(F,{type:"button",variant:"outline",onClick:w,disabled:u,children:"Cancel"}),e.jsx(F,{onClick:y,disabled:!o||u,className:"bg-green-600 hover:bg-green-700",children:u?e.jsxs(e.Fragment,{children:[e.jsx(Lm,{className:"h-4 w-4 mr-2 animate-spin"}),"Detecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"Detect Plate Number"]})})]})]})]})})}function hb(){const{profile:a,user:t}=ft(),{toast:s}=Tt(),[r,n]=l.useState([]),[o,i]=l.useState(null),[c,d]=l.useState(!0),[u,h]=l.useState(!1),[m,p]=l.useState({plate_number:"",vehicle_type:"2-wheeler",location_id:"",contractor_id:"",mobile_number:""}),[f,v]=l.useState(!1),[y,w]=l.useState(!1),[N,g]=l.useState(null),[b,A]=l.useState("cash"),[P,E]=l.useState(!1),[V,M]=l.useState(0),[O,I]=l.useState(""),[ee,G]=l.useState(!1),[ae,$]=l.useState([]),Y=l.useRef(!1);if(a?.role!=="attendant")return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600",children:"Access Denied"}),e.jsx("p",{className:"text-muted-foreground",children:"Only attendants can access Check In/Out."})]});l.useEffect(()=>{a?.role==="attendant"&&a?.id&&Bn(a.id).then(z=>{console.log("Subscription status for attendant:",z),(z.isExpired||z.isSuspended)&&(h(!0),s({variant:"destructive",title:"Access Blocked",description:"Your contractor's subscription has expired. Please contact your contractor to recharge."}))}).catch(z=>{console.error("Error checking subscription status:",z)})},[a,s]);const Z=async()=>{if(t?.id)try{d(!0);const z=await oa.getAttendantByUserId(t.id);if(!z||!z.location_id)throw new Error("Attendant not assigned to any location");const D=await es.getLocationById(z.location_id);i(D),p(Ce=>({...Ce,location_id:D.id,contractor_id:D.contractor_id}));const{VehicleAPI:X}=await Ye(async()=>{const{VehicleAPI:Ce}=await Promise.resolve().then(()=>pg);return{VehicleAPI:Ce}},void 0),B=await X.getVehiclesByLocation(z.location_id),oe=B.filter(Ce=>!Ce.check_out_time).slice(0,5),Ae=B.filter(Ce=>!Ce.check_out_time).length;de(Ae),n(oe||[])}catch(z){console.error("Error fetching data:",z),s({variant:"destructive",title:"Error",description:z.message||"Failed to load data"})}finally{d(!1)}},_=async()=>{try{const z=await es.getAllLocations();$(z)}catch(z){console.error("Error fetching locations:",z)}},L=z=>{p(D=>({...D,plate_number:z})),s({title:"Plate Number Detected!",description:`License plate "${z}" has been filled in the form. Please complete the check-in process.`})};l.useEffect(()=>{t&&!Y.current&&(Z(),_(),Y.current=!0)},[t]);const C=async()=>{v(!0);try{if(!m.plate_number||!m.vehicle_type){s({variant:"destructive",title:"Validation Error",description:"Please fill in all required fields."}),v(!1);return}if(!m.location_id&&o?.id&&p(D=>({...D,location_id:o.id,contractor_id:o.contractor_id||D.contractor_id})),!m.location_id){s({variant:"destructive",title:"Validation Error",description:"Location is required. Please select a location."}),v(!1);return}const z=await Gt.createVehicle(m);n(D=>[z,...D]),p({plate_number:"",vehicle_type:"2-wheeler",location_id:o?.id||"",contractor_id:o?.contractor_id||"",mobile_number:""}),Y.current=!1,Z(),s({title:"Vehicle Checked In",description:`Vehicle ${z.plate_number} has been checked in successfully.`})}catch(z){console.error("Error adding vehicle:",z),s({variant:"destructive",title:"Check-In Failed",description:z.message||"Failed to check in vehicle."})}finally{v(!1)}},T=async()=>{if(N){v(!0);try{const z={check_out_time:new Date().toISOString(),payment_amount:0,payment_method:b};await Gt.checkoutVehicle(N.id,z);const X=Math.floor((new Date().getTime()-new Date(N.check_in_time).getTime())/(1e3*60*60))*50;M(X),w(!1),E(!0),g(null),Y.current=!1,Z()}catch(z){console.error("Error checking out vehicle:",z),s({variant:"destructive",title:"Check-Out Failed",description:z.message||"Failed to check out vehicle."})}finally{v(!1)}}},H=z=>{g(z),A("cash"),w(!0)},S=r.filter(z=>z.plate_number.toLowerCase().includes(O.toLowerCase())||z.mobile_number&&z.mobile_number.includes(O)),q=o?.total_slots||100,[U,de]=l.useState(0),Q=U/q*100;return c?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-parkflow-blue"})}):u?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"mx-auto max-w-md",children:[e.jsx("div",{className:"rounded-full bg-red-100 p-3 mx-auto w-16 h-16 flex items-center justify-center mb-4",children:e.jsx(Na,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Access Blocked"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your contractor's subscription has expired. Please contact your contractor to recharge."}),e.jsx(F,{variant:"outline",onClick:()=>window.location.reload(),className:"mt-4",children:"Refresh Page"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Check In/Out"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:o?`${o.locations_name} - ${o.address}`:"Manage vehicle check-ins and check-outs"})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 min-h-[calc(100vh-200px)]",children:[e.jsxs(_e,{children:[e.jsxs(ze,{children:[e.jsxs(Be,{className:"flex items-center space-x-2",children:[e.jsx(ni,{className:"h-5 w-5"}),e.jsx("span",{children:"Vehicle Check-in"})]}),e.jsx(et,{children:"Enter vehicle details to check-in."})]}),e.jsxs(Ee,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{className:"text-base font-semibold mb-2 block",children:"Vehicle Type"}),e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"vehicleType",value:"2-wheeler",checked:m.vehicle_type==="2-wheeler",onChange:z=>p(D=>({...D,vehicle_type:z.target.value})),className:"w-4 h-4 text-parkflow-blue"}),e.jsx(Br,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"2-Wheeler"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"vehicleType",value:"4-wheeler",checked:m.vehicle_type==="4-wheeler",onChange:z=>p(D=>({...D,vehicle_type:z.target.value})),className:"w-4 h-4 text-parkflow-blue"}),e.jsx(ot,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"4-Wheeler"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{className:"text-base font-semibold mb-2 block",children:"Plate Number"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{placeholder:"e.g., ABC-1234",value:m.plate_number,onChange:z=>{const D=z.target,X=D.selectionStart,B=z.target.value.toUpperCase();p(oe=>({...oe,plate_number:B})),setTimeout(()=>{D.setSelectionRange(X,X)},0)},className:"flex-1"}),e.jsx(F,{variant:"outline",size:"icon",onClick:()=>G(!0),title:"Check-in with Image Recognition",children:e.jsx(ra,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{className:"text-base font-semibold mb-2 block",children:"Mobile Number (Optional)"}),e.jsx(ge,{placeholder:"e.g., +91 9876543210",value:m.mobile_number||"",onChange:z=>{const D=z.target,X=D.selectionStart,B=z.target.value.toUpperCase();p(oe=>({...oe,mobile_number:B})),setTimeout(()=>{D.setSelectionRange(X,X)},0)},type:"tel"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{className:"text-base font-semibold mb-2 block",children:"Location"}),e.jsx(ge,{value:o?.locations_name||"Loading...",disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"This is your assigned location"})]}),e.jsx(F,{onClick:C,className:"w-full bg-parkflow-blue hover:bg-parkflow-blue/90 h-12 text-base",disabled:f||!m.plate_number.trim(),children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(br,{className:"h-4 w-4 mr-2"}),"Check-in"]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{className:"text-base font-semibold mb-2 block",children:"Live Occupancy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-muted-foreground",children:[U,"/",q]})}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(Q,100)}%`}})})]})]})]})]}),e.jsxs(_e,{children:[e.jsx(ze,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs(Be,{className:"flex items-center space-x-2 text-lg sm:text-xl",children:[e.jsx(rs,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{children:"Currently Parked Vehicles"})]}),e.jsx(et,{className:"text-sm",children:"List of all vehicles currently in the lot."})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("div",{className:"relative w-full sm:w-48",children:[e.jsx(ua,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search vehicles...",value:O,onChange:z=>I(z.target.value),className:"pl-8 w-full text-sm"})]})})]})}),e.jsx(Ee,{children:S.length>0?e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"space-y-3",children:S.map(z=>e.jsxs("div",{className:"border rounded-lg hover:bg-muted/50 transition-colors",children:[e.jsx("div",{className:"hidden sm:flex items-center justify-between p-3",children:e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-mono font-medium",children:z.plate_number}),z.mobile_number&&e.jsx("p",{className:"text-xs text-muted-foreground",children:z.mobile_number})]}),e.jsx("div",{children:e.jsx(Je,{variant:"outline",className:"text-xs",children:z.vehicle_type==="2-wheeler"?"2 Wheeler":"4 Wheeler"})}),e.jsx("div",{children:e.jsx("p",{className:"text-muted-foreground",children:new Date(z.check_in_time).toLocaleTimeString()})}),e.jsx("div",{children:e.jsxs(F,{size:"sm",onClick:()=>H(z),className:"bg-red-600 hover:bg-red-700 text-white w-full",children:[e.jsx(br,{className:"h-3 w-3 mr-1"}),"Check-out"]})})]})}),e.jsxs("div",{className:"sm:hidden p-3 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-mono font-medium text-sm",children:z.plate_number}),z.mobile_number&&e.jsx("p",{className:"text-xs text-muted-foreground",children:z.mobile_number})]}),e.jsx("div",{className:"flex-shrink-0 ml-2",children:e.jsx(Je,{variant:"outline",className:"text-xs",children:z.vehicle_type==="2-wheeler"?"2 Wheeler":"4 Wheeler"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Check-in: ",new Date(z.check_in_time).toLocaleTimeString()]}),e.jsxs(F,{size:"sm",onClick:()=>H(z),className:"bg-red-600 hover:bg-red-700 text-white text-xs px-3 py-1",children:[e.jsx(br,{className:"h-3 w-3 mr-1"}),"Check-out"]})]})]})]},z.id))})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ot,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:O?"No vehicles found matching your search":"No vehicles currently parked"})]})})]})]}),e.jsx(bt,{open:y,onOpenChange:w,children:e.jsxs(yt,{className:"max-w-lg",children:[e.jsxs(wt,{children:[e.jsxs(jt,{className:"flex items-center space-x-2 text-xl",children:[e.jsx(Vm,{className:"h-6 w-6"}),e.jsx("span",{children:"Check Out Vehicle"})]}),e.jsx(At,{className:"text-base",children:"Review parking details and complete payment"})]}),N&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ot,{className:"h-8 w-8 text-gray-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-semibold",children:N.plate_number}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Type: ",N.vehicle_type==="2-wheeler"?"2-wheeler":"4-wheeler"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Check In: ",ts(N.check_in_time)]})]})]})}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx(qs,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"font-semibold",children:"Parking Details"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Duration:"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.floor((new Date().getTime()-new Date(N.check_in_time).getTime())/(1e3*60*60)),"h"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Rate:"}),e.jsx("span",{className:"text-sm font-medium",children:"Up to 6 hours: 50"})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Total Amount:"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["",Math.floor((new Date().getTime()-new Date(N.check_in_time).getTime())/(1e3*60*60))*50]})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(te,{htmlFor:"payment_method",className:"text-base font-medium",children:"Payment Method"}),e.jsxs("select",{id:"payment_method",value:b,onChange:z=>A(z.target.value),className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-parkflow-blue focus:border-transparent text-base",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"digital",children:"Digital Payment"}),e.jsx("option",{value:"free",children:"Free"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(F,{onClick:()=>w(!1),variant:"outline",disabled:f,className:"px-6 py-2",children:"Cancel"}),e.jsx(F,{onClick:T,className:"bg-green-600 hover:bg-green-700 px-6 py-2",disabled:f,children:f?e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):"Confirm Checkout"})]})]})]})}),e.jsx(bt,{open:P,onOpenChange:E,children:e.jsx(yt,{className:"max-w-md",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(Rt,{className:"h-8 w-8 text-green-600"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Checkout Successful"}),e.jsxs("p",{className:"text-gray-600",children:["Vehicle ",e.jsx("span",{className:"font-semibold",children:N?.plate_number})," has been checked out."]})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Payment Due"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:["",V]})]})}),e.jsxs(F,{onClick:()=>E(!1),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 text-lg",children:[e.jsx(Rt,{className:"h-5 w-5 mr-2"}),"Done"]})]})})}),e.jsx(ub,{isOpen:ee,onClose:()=>G(!1),onPlateDetected:L})]})}const mb=()=>{const a=Dn();return l.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",a.pathname)},[a.pathname]),e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),e.jsx("p",{className:"mb-4 text-xl text-gray-600",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-blue-500 underline hover:text-blue-700",children:"Return to Home"})]})})},pb=new hf,fb=()=>e.jsx(jf,{children:e.jsx(pf,{client:pb,children:e.jsx(Uc,{children:e.jsxs(yf,{children:[e.jsx(Tc,{}),e.jsx(wp,{}),e.jsx(wm,{children:e.jsx(Nf,{children:e.jsxs(jm,{children:[e.jsx(nt,{path:"/",element:e.jsx(Jf,{})}),e.jsx(nt,{path:"/login",element:e.jsx(ox,{})}),e.jsx(nt,{path:"/superadmin-verification",element:e.jsx(Hx,{})}),e.jsx(nt,{path:"/superadminlogin",element:e.jsx(ix,{})}),e.jsx(nt,{path:"/register",element:e.jsx(Fx,{})}),e.jsx(nt,{path:"/onboarding",element:e.jsx(qx,{})}),e.jsx(nt,{path:"/forgot-password",element:e.jsx($x,{})}),e.jsx(nt,{path:"/reset-password",element:e.jsx(Vx,{})}),e.jsx(nt,{path:"/terms-of-service",element:e.jsx(zx,{})}),e.jsx(nt,{path:"/privacy-policy",element:e.jsx(Bx,{})}),e.jsxs(nt,{path:"/dashboard",element:e.jsx(Qf,{}),children:[e.jsx(nt,{index:!0,element:e.jsx(xg,{})}),e.jsx(nt,{path:"contractors",element:e.jsx(Tv,{})}),e.jsx(nt,{path:"locations",element:e.jsx(Dv,{})}),e.jsx(nt,{path:"attendants",element:e.jsx(Eu,{})}),e.jsx(nt,{path:"vehicles",element:e.jsx(u0,{})}),e.jsx(nt,{path:"reports",element:e.jsx(h0,{})}),e.jsx(nt,{path:"income",element:e.jsx(m0,{})}),e.jsx(nt,{path:"logs",element:e.jsx(p0,{})}),e.jsx(nt,{path:"subscriptions",element:e.jsx(rb,{})}),e.jsx(nt,{path:"settings",element:e.jsx(nb,{})}),e.jsx(nt,{path:"profile",element:e.jsx(cb,{})}),e.jsx(nt,{path:"qr-scanner",element:e.jsx(db,{})}),e.jsx(nt,{path:"check-inout",element:e.jsx(hb,{})}),e.jsx(nt,{path:"*",element:e.jsx(wc,{to:"/dashboard",replace:!0})})]}),e.jsx(nt,{path:"*",element:e.jsx(mb,{})})]})})})]})})})});jc(document.getElementById("root")).render(e.jsx(fb,{}));export{pe as a};
